(()=>{"use strict";var e={498:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e){this.visible=!1,this.playing=!1,this.speed=1,this.GUI=null,this.MENU=null,this.play_pause_button=null,this.step_button=null,this.stop_button=null,this.speed_slider=null,this.info_algorithm=null,this.info_time=null,this.info_is_done=null,this.info_in_queue=null,this.info_finished=null,this.info_total_page_faults=null,this.info_total_page_hits=null,this.frame_rows=[],this.see_code_button=null,this.storedSetInterval=null,this.menu=e}init(){this.GUI=document.getElementById("animation_gui"),this.MENU=document.getElementById("settings"),this.play_pause_button=document.getElementById("animation_play_pause"),this.step_button=document.getElementById("animation_step"),this.stop_button=document.getElementById("animation_stop"),this.speed_slider=document.getElementById("animation_speed_slider"),this.info_algorithm=document.getElementById("animation_info_algorithm_value"),this.info_time=document.getElementById("animation_info_time_value"),this.info_is_done=document.getElementById("animation_is_done"),this.info_in_queue=document.getElementById("calls_in_queue_value"),this.info_finished=document.getElementById("calls_finished_value"),this.info_total_page_faults=document.getElementById("total_page_faults_value"),this.info_total_page_hits=document.getElementById("total_page_hits_value"),this.see_code_button=document.getElementById("code_button"),this.info_is_done.style.display="none",this.play_pause_button.addEventListener("click",(()=>{this.togglePlaying()})),this.step_button.addEventListener("click",(()=>{this.step()})),this.stop_button.addEventListener("click",(()=>{this.toggleVisible(!1)})),this.speed_slider.addEventListener("input",(()=>{this.speed=parseInt(this.speed_slider.value),this.refreshSpeed()})),this.see_code_button.addEventListener("click",(()=>{if(null==this.menu.memory.algorithm)return;const e=this.menu.memory.algorithm.name;window.open(`https://github.com/brun0ne/scheduling-sim/blob/main/page_replacement_src/classes/algorithms/${e}.ts`,"_blank").focus()})),this.refreshSpeed(),this.initStateTable()}togglePlaying(e){this.playing=null==e?!this.playing:e,this.refreshSpeed(),this.play_pause_button.innerHTML=this.playing?"Pause":"Play"}toggleVisible(e){this.visible=null==e?!this.visible:e,this.visible?(this.GUI.style.display="block",this.MENU.style.display="none",this.menu.display.resizeCallback=()=>{this.drawCurrentState()},this.drawCurrentState()):(this.GUI.style.display="none",this.MENU.style.display="flex",null!=this.storedSetInterval&&clearInterval(this.storedSetInterval),this.menu.display.resizeCallback=()=>{this.menu.refreshCalls()},this.menu.refreshCalls())}reset(){if(null==this.play_pause_button||null==this.info_is_done||null==this.step_button)throw new Error("call init() first!");this.menu.memory.init(),this.play_pause_button.innerHTML="Play",this.playing=!1,this.info_is_done.style.display="none",this.play_pause_button.disabled=!1,this.step_button.disabled=!1,this.initStateTable()}startAnimation(){this.reset(),this.toggleVisible(!0)}drawCurrentState(){this.refreshInfo(),this.drawCalls()}initStateTable(){const e=document.getElementById("animation_table_time"),t=document.getElementById("animation_table_page_calls"),l=document.getElementById("animation_table_body");e.innerHTML="",t.innerHTML="";{const t=document.createElement("th");t.innerHTML="Time",t.classList.add("header"),e.appendChild(t)}{const e=document.createElement("th");e.innerHTML="Page calls",e.classList.add("header"),t.appendChild(e)}{for(;null!=l.lastChild&&"animation_table_page_calls"!=l.lastChild.id;)l.removeChild(l.lastChild);const e=[];for(let t=0;t<this.menu.memory.number_of_frames;t++){const s=document.createElement("tr"),i=document.createElement("th");i.innerHTML=`Frame ${t}`,s.appendChild(i),e.push(s),l.appendChild(s)}this.frame_rows=e}}drawCalls(e,t,l,s,i){const a=document.getElementById("animation_table_time"),n=document.getElementById("animation_table_page_calls"),r=this.menu.memory.previous_page_calls.at(-1);if(null==r)return;{const e=document.createElement("th");e.innerHTML=`${this.menu.memory.time}`,a.appendChild(e)}{const e=document.createElement("th");e.innerHTML=`${r.id}`,n.appendChild(e)}for(let e=0;e<this.menu.memory.number_of_frames;e++){const t=this.frame_rows[e],l=this.menu.memory.frames[e].page,s=document.createElement("th");s.innerHTML=`${null!=l?l.id:""}`,null!=l&&l.id==r.id&&this.menu.memory.last_call_caused_fault&&(s.style.backgroundColor="red"),t.appendChild(s)}const o=document.getElementById("animation_call_table");o.scrollLeft=o.scrollWidth}refreshInfo(){const e=this.menu.memory;if(null==e.algorithm)throw new Error("call startAnimation() first!");this.info_algorithm.innerHTML=e.algorithm.name,this.info_time.innerHTML=e.time.toString(),e.isFinished()?this.info_is_done.style.display="block":this.info_is_done.style.display="none",this.info_total_page_hits.innerHTML=(e.previous_page_calls.length-e.total_page_faults).toString(),this.info_total_page_faults.innerHTML=e.total_page_faults.toString(),this.info_in_queue.innerHTML=e.page_call_queue.length.toString(),this.info_finished.innerHTML=e.previous_page_calls.length.toString()}refreshSpeed(){null!=this.storedSetInterval&&clearInterval(this.storedSetInterval),this.storedSetInterval=setInterval((()=>{this.playing&&this.step()}).bind(this),1e3/this.speed)}step(){this.menu.memory.isFinished()||(this.menu.memory.nextTick(),this.drawCurrentState(),this.menu.memory.isFinished()&&(this.togglePlaying(!1),this.menu.memory.displayResults(this.menu.memory.getResults()),this.afterDone()))}afterDone(){if(null==this.info_is_done||null==this.play_pause_button||null==this.step_button)throw new Error("call init() first!");this.info_is_done.style.display="block",this.play_pause_button.disabled=!0,this.step_button.disabled=!0}}},752:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.page=null}}},495:function(e,t,l){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=s(l(920)),a=s(l(752));t.default=class{constructor(){this.number_of_pages=0,this.number_of_frames=0,this.page_call_pool=[],this.page_call_queue=[],this.previous_page_calls=[],this.frames=[],this.algorithm=null,this.last_replaced_index=-1,this.last_call_caused_fault=!1,this.time=0,this.total_page_faults=0}init(e,t){this.number_of_pages=null!=e?e:this.number_of_pages,this.number_of_frames=null!=t?t:this.number_of_frames,this.page_call_queue=[...this.page_call_pool],this.frames=[],this.previous_page_calls=[],this.time=0,this.total_page_faults=0;for(let e=0;e<this.number_of_frames;e++)this.frames.push(new a.default)}addPageCallToPool(e){this.page_call_pool.push(e)}addPageCallsToPool(e){for(let t=0;t<e.length;t++)this.page_call_pool.push(new i.default(e[t]))}clearPageCallPool(){this.page_call_pool=[]}setAlgorithm(e){this.algorithm=e}nextTick(){var e,t,l,s;if(null==this.algorithm)throw new Error("No algorithm selected");const i=this.page_call_queue.shift();if(null==i)return console.warn("Empty page call queue but not finished"),void this.time++;if(this.previous_page_calls.push(i),console.log("Page call: "+i.id),i){null===(t=(e=this.algorithm).onPageCall)||void 0===t||t.call(e,this.getCurrentStateData(i));let a=!0;for(let e=0;e<this.frames.length;e++){if(null==this.frames[e])throw new Error("Frame is null");if(null==this.frames[e].page){this.frames[e].page=i,this.last_replaced_index=e,this.total_page_faults++,this.last_call_caused_fault=!0,a=!1;break}if(this.frames[e].page.id==i.id){null===(s=(l=this.algorithm).onPageAlreadyInMemory)||void 0===s||s.call(l,this.getCurrentStateData(i)),this.last_call_caused_fault=!1,a=!1;break}}if(a){if(console.log("Page fault: "+i.id),null!=this.frames.find((e=>null==e.page)))throw new Error("Initial page fill not handled properly");this.total_page_faults++,this.last_call_caused_fault=!0;const e=this.algorithm.handlePageFault(this.getCurrentStateData(i));this.frames[e].page=i,this.last_replaced_index=e}let n=!1;for(const e of this.frames)if(null!=e.page&&e.page.id==i.id){n=!0;break}if(!n)throw new Error("Page fault not handled properly - page not in memory");i.call(this.time)}this.time++}getCurrentStateData(e){return{page_call:e,last_replaced_index:this.last_replaced_index,current_frames:this.frames,future_page_calls:this.page_call_queue,previous_page_calls:this.previous_page_calls}}isFinished(){return 0==this.page_call_queue.length}simulate(){for(this.init();!this.isFinished();)this.nextTick();return this.getResults()}getResults(){return{total_page_faults:this.total_page_faults,total_page_hits:this.previous_page_calls.length-this.total_page_faults,total_page_calls:this.previous_page_calls.length}}printFrames(){console.log("Frames:");for(const e of this.frames)console.log(e.page?e.page.id:"null")}displayResults(e,t=this.algorithm.name){document.getElementById("results_wrapper").style.display="flex",document.getElementById("results").innerHTML=`\n        Algorithm: ${t.toUpperCase()}\n\n        Total page faults: <b style='color: red'>${e.total_page_faults.toFixed(0)}</b>\n        Total page hits: <b style='color: lime'>${e.total_page_hits.toFixed(0)}</b>\n        Total page calls: <b>${e.total_page_calls.toFixed(0)}</b>\n        `.replace(RegExp("\n","g"),"<br />")}compareAllAndDisplayResults(e){document.getElementById("results_wrapper").style.display="flex";const t=document.getElementById("results");t.innerHTML="";for(let l=0;l<e.length;l++){this.setAlgorithm(e[l]);const s=this.simulate();t.innerHTML+=`\n            Algorithm: ${e[l].name.toUpperCase()}\n            Total page faults: <b style='color: red'>${s.total_page_faults.toFixed(0)}</b>\n            Total page hits: <b style='color: lime'>${s.total_page_hits.toFixed(0)}</b>\n            Total page calls: <b>${s.total_page_calls.toFixed(0)}</b>\n            `.replace(RegExp("\n","g"),"<br />"),t.innerHTML+="<br />"}}}},268:function(e,t,l){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=s(l(617)),a=s(l(498)),n=s(l(495)),r=s(l(238)),o=s(l(789)),u=s(l(93)),h=s(l(429)),d=s(l(436));t.default=class{constructor(){this.display=new i.default,this.memory=new n.default,this.animationGUI=new a.default(this)}init(){document.getElementById("run_button").addEventListener("click",(()=>{this.run()})),document.getElementById("run_with_animation_button").addEventListener("click",(()=>{this.run(!0)})),document.getElementById("add_button").addEventListener("click",(()=>{this.addCalls()})),document.getElementById("clear_button").addEventListener("click",(()=>{this.clearCalls()})),this.memory.init(5,3),this.display.init("main_canvas"),this.animationGUI.init(),this.display.setResizeCallback((()=>{this.refreshCalls()})),document.getElementById("s_page_count").addEventListener("change",(e=>{const t=parseInt(e.target.value);isNaN(t)||t<1?alert("Invalid number of pages"):(this.memory.init(t,this.memory.number_of_frames),this.clearCalls(),this.refreshCalls())})),document.getElementById("s_frame_count").addEventListener("change",(e=>{const t=parseInt(e.target.value);isNaN(t)||t<1?alert("Invalid number of frames"):(this.memory.init(this.memory.number_of_pages,t),this.refreshCalls())})),document.getElementById("c_distribution").addEventListener("change",(e=>{const t=e.target.value.toLowerCase(),l=document.getElementById("c_window_size_all"),s=document.getElementById("c_window_delta_all");switch(t){case"uniform":l.style.display="none",s.style.display="none";break;case"locality":l.style.display="block",s.style.display="block";break;default:alert("Invalid distribution")}})),document.getElementById("a_type").addEventListener("change",(e=>{"compare_all"===e.target.value.toLowerCase()?document.getElementById("run_with_animation_button").setAttribute("disabled","true"):document.getElementById("run_with_animation_button").removeAttribute("disabled")})),document.getElementById("results_close").addEventListener("click",(()=>{document.getElementById("results_wrapper").style.display="none"})),this.refreshCalls()}addCalls(){const e=document.getElementById("c_distribution").value,t=parseInt(document.getElementById("c_count").value);switch(e){case"uniform":for(let e=0;e<t;e++)this.memory.addPageCallsToPool([Math.floor(Math.random()*this.memory.number_of_pages)]);break;case"locality":{const e=parseInt(document.getElementById("c_window_size").value),l=parseInt(document.getElementById("c_window_delta").value);if(isNaN(e)||isNaN(l))return void alert("Invalid input");if(e>this.memory.number_of_pages)return void alert("Window size is bigger than number of pages");if(l>this.memory.number_of_pages)return void alert("Window delta is bigger than number of pages");let s=Math.floor(Math.random()*(this.memory.number_of_pages-e));for(let i=0;i<t;i++){const t=Math.floor(Math.random()*e)+s;this.memory.addPageCallsToPool([t]),s=(s+(Math.floor(Math.random()*(2*l+1))-l))%(this.memory.number_of_pages-e),this.memory.number_of_pages-e==0&&(s=0),s<0&&(s+=this.memory.number_of_pages)}break}default:return void alert("Invalid distribution")}this.refreshCalls()}clearCalls(){this.memory.clearPageCallPool(),this.refreshCalls()}refreshCalls(){console.log("Calls in pool: "+this.memory.page_call_pool.length),document.getElementById("p_current_count").innerHTML=`(${this.memory.page_call_pool.length.toString()})`;const e=document.getElementById("current_page_calls_val");e.innerHTML=this.memory.page_call_pool.reduce(((e,t)=>e+t.id.toString()+", "),"").slice(0,-2),0==this.memory.page_call_pool.length&&(e.innerHTML="<span style='color: yellow'>empty</span>")}run(e){let t=!1;switch(document.getElementById("a_type").value.toLowerCase()){case"fifo":this.memory.setAlgorithm(new r.default);break;case"opt":this.memory.setAlgorithm(new o.default);break;case"lru":this.memory.setAlgorithm(new u.default);break;case"alru":this.memory.setAlgorithm(new h.default);break;case"rand":this.memory.setAlgorithm(new d.default);break;case"compare_all":t=!0;break;default:alert("Invalid algorithm")}if(t){const e=[new r.default,new o.default,new u.default,new h.default,new d.default];this.memory.compareAllAndDisplayResults(e)}else if(e)this.animationGUI.startAnimation();else{const e=this.memory.simulate();this.memory.displayResults(e)}}}},920:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e){this.id=e,this.last_call_time=0}call(e){this.last_call_time=e}}},429:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.name="ALRU",this.bit_array=[],this.pointer=0}onPageAlreadyInMemory(e){const t=e.current_frames.findIndex((t=>{var l;return(null===(l=t.page)||void 0===l?void 0:l.id)==e.page_call.id}));if(-1==t)throw new Error("ALRU: fatal error (index -1)");this.bit_array[t]=!0}handlePageFault(e){for(let t=0;t<e.current_frames.length;t++)null==this.bit_array[t]&&(this.bit_array[t]=!1);for(this.pointer=this.pointer%e.current_frames.length;;){if(null==e.current_frames[this.pointer].page)return console.warn("Frame is empty - this should be ensured not to happen by the caller"),this.bit_array[this.pointer]=!0,this.pointer++;if(0==this.bit_array[this.pointer])return this.bit_array[this.pointer]=!0,this.pointer++;this.bit_array[this.pointer]=!1,this.pointer=(this.pointer+1)%e.current_frames.length}}}},238:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.name="FIFO"}handlePageFault(e){return(e.last_replaced_index+1)%e.current_frames.length}}},93:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.name="LRU"}handlePageFault(e){let t=-1,l=-1;for(let s=0;s<e.current_frames.length;s++){const i=e.current_frames[s];if(null==i.page)return console.warn("Frame is empty - this should be ensured not to happen by the caller"),s;let a=-1;for(let t=e.previous_page_calls.length-1;t>=0;t--)if(e.previous_page_calls[t].id==i.page.id){a=t;break}if(-1==a)return s;(a<l||-1==l)&&(t=s,l=a)}return t}}},789:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.name="OPT"}handlePageFault(e){let t=-1,l=-1;for(let s=0;s<e.current_frames.length;s++){const i=e.current_frames[s];if(null==i.page)return console.warn("Frame is empty - this should be ensured not to happen by the caller"),s;let a=-1;for(let t=0;t<e.future_page_calls.length;t++)if(e.future_page_calls[t].id==i.page.id){a=t;break}if(-1==a)return s;a>l&&(t=s,l=a)}return t}}},436:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.name="RAND"}handlePageFault(e){return Math.floor(Math.random()*e.current_frames.length)}}},965:function(e,t,l){var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=s(l(268)),a=s(l(495)),n=s(l(429));!function(){if("undefined"!=typeof document)(new i.default).init();else{const e=new a.default;for(e.init(5,3),e.addPageCallsToPool([1,2,3,4,1,2,5,1,2,3,4,5]),e.setAlgorithm(new n.default);e.page_call_queue.length>0;)e.nextTick(),e.printFrames();console.log("Total page faults: "+e.total_page_faults)}}()},617:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.ctx=null,this.resizeCallback=null}init(e){const t=document.getElementById(e);this.ctx=t.getContext("2d"),window.addEventListener("resize",this.resizeToFit.bind(this)),this.resizeToFit()}resizeToFit(){null!=this.ctx&&(this.ctx.canvas.width=window.innerWidth,this.ctx.canvas.height=window.innerHeight,null!=this.resizeCallback&&this.resizeCallback())}setResizeCallback(e){this.resizeCallback=e}}}},t={};!function l(s){var i=t[s];if(void 0!==i)return i.exports;var a=t[s]={exports:{}};return e[s].call(a.exports,a,a.exports,l),a.exports}(965)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUVqQjFFLEVBQU8yRCxnQkFBZ0JGLE9BQVMsR0FDbkN6RCxFQUFPOEQsV0FDUDlELEVBQU84RixjQUdYbEIsUUFBUUUsSUFBSSxzQkFBd0I5RSxFQUFPMEQsa0IsQ0FFbkQsQ0FFQXdGLEUsK0RDbkNBLGdCQUlJcEwsY0FIQSxLQUFBcUwsSUFBdUMsS0FJbkNoSyxLQUFLc0IsZUFBaUIsSUFDMUIsQ0FFQXJCLEtBQUtnSyxHQUNELE1BQU1DLEVBQVNoSyxTQUFTQyxlQUFlOEosR0FDdkNqSyxLQUFLZ0ssSUFBTUUsRUFBT0MsV0FBVyxNQUU3QmxKLE9BQU9YLGlCQUFpQixTQUFVTixLQUFLb0ssWUFBWTFGLEtBQUsxRSxPQUV4REEsS0FBS29LLGFBQ1QsQ0FFQUEsY0FDb0IsTUFBWnBLLEtBQUtnSyxNQUlUaEssS0FBS2dLLElBQUlFLE9BQU9HLE1BQVFwSixPQUFPcUosV0FDL0J0SyxLQUFLZ0ssSUFBSUUsT0FBT0ssT0FBU3RKLE9BQU91SixZQUVMLE1BQXZCeEssS0FBS3NCLGdCQUNMdEIsS0FBS3NCLGlCQUViLENBRUFtRyxrQkFBa0JnRCxHQUNkekssS0FBS3NCLGVBQWlCbUosQ0FDMUIsRSxHQy9CQUMsRUFBMkIsQ0FBQyxHQUdoQyxTQUFTQyxFQUFvQkMsR0FFNUIsSUFBSUMsRUFBZUgsRUFBeUJFLEdBQzVDLFFBQXFCRSxJQUFqQkQsRUFDSCxPQUFPQSxFQUFhRSxRQUdyQixJQUFJQyxFQUFTTixFQUF5QkUsR0FBWSxDQUdqREcsUUFBUyxDQUFDLEdBT1gsT0FIQUUsRUFBb0JMLEdBQVV2RSxLQUFLMkUsRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0osR0FHcEVLLEVBQU9ELE9BQ2YsQ0NuQjBCSixDQUFvQixJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vY2xhc3Nlcy9BbmltYXRpb25HVUkudHMiLCJ3ZWJwYWNrOi8vLy4vY2xhc3Nlcy9GcmFtZS50cyIsIndlYnBhY2s6Ly8vLi9jbGFzc2VzL01NVS50cyIsIndlYnBhY2s6Ly8vLi9jbGFzc2VzL01lbnUudHMiLCJ3ZWJwYWNrOi8vLy4vY2xhc3Nlcy9QYWdlLnRzIiwid2VicGFjazovLy8uL2NsYXNzZXMvYWxnb3JpdGhtcy9BTFJVLnRzIiwid2VicGFjazovLy8uL2NsYXNzZXMvYWxnb3JpdGhtcy9GSUZPLnRzIiwid2VicGFjazovLy8uL2NsYXNzZXMvYWxnb3JpdGhtcy9MUlUudHMiLCJ3ZWJwYWNrOi8vLy4vY2xhc3Nlcy9hbGdvcml0aG1zL09QVC50cyIsIndlYnBhY2s6Ly8vLi9jbGFzc2VzL2FsZ29yaXRobXMvUkFORC50cyIsIndlYnBhY2s6Ly8vLi9tYWluLnRzIiwid2VicGFjazovLy8uLi9zaGFyZWQvY2xhc3Nlcy9EaXNwbGF5LnRzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly8vd2VicGFjay9zdGFydHVwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBJQW5pbWF0aW9uR1VJIGZyb20gXCIuLi8uLi9zaGFyZWQvaW50ZXJmYWNlcy9JQW5pbWF0aW9uR1VJXCI7XHJcbmltcG9ydCBNZW51IGZyb20gXCIuL01lbnVcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFuaW1hdGlvbkdVSSBpbXBsZW1lbnRzIElBbmltYXRpb25HVUkge1xyXG4gICAgbWVudTogTWVudVxyXG5cclxuICAgIHZpc2libGU6IGJvb2xlYW4gPSBmYWxzZVxyXG4gICAgcGxheWluZzogYm9vbGVhbiA9IGZhbHNlXHJcbiAgICBzcGVlZDogbnVtYmVyID0gMVxyXG5cclxuICAgIEdVSTogSFRNTERpdkVsZW1lbnQgfCBudWxsID0gbnVsbFxyXG4gICAgTUVOVTogSFRNTERpdkVsZW1lbnQgfCBudWxsID0gbnVsbFxyXG5cclxuICAgIHBsYXlfcGF1c2VfYnV0dG9uOiBIVE1MQnV0dG9uRWxlbWVudCB8IG51bGwgPSBudWxsXHJcbiAgICBzdGVwX2J1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQgfCBudWxsID0gbnVsbFxyXG4gICAgc3RvcF9idXR0b246IEhUTUxCdXR0b25FbGVtZW50IHwgbnVsbCA9IG51bGxcclxuICAgIHNwZWVkX3NsaWRlcjogSFRNTElucHV0RWxlbWVudCB8IG51bGwgPSBudWxsXHJcblxyXG4gICAgaW5mb19hbGdvcml0aG06IEhUTUxQYXJhZ3JhcGhFbGVtZW50IHwgbnVsbCA9IG51bGxcclxuICAgIGluZm9fdGltZTogSFRNTFBhcmFncmFwaEVsZW1lbnQgfCBudWxsID0gbnVsbFxyXG4gICAgaW5mb19pc19kb25lOiBIVE1MRGl2RWxlbWVudCB8IG51bGwgPSBudWxsXHJcblxyXG4gICAgaW5mb19pbl9xdWV1ZTogSFRNTFBhcmFncmFwaEVsZW1lbnQgfCBudWxsID0gbnVsbFxyXG4gICAgaW5mb19maW5pc2hlZDogSFRNTFBhcmFncmFwaEVsZW1lbnQgfCBudWxsID0gbnVsbFxyXG4gICAgaW5mb190b3RhbF9wYWdlX2ZhdWx0czogSFRNTFBhcmFncmFwaEVsZW1lbnQgfCBudWxsID0gbnVsbFxyXG4gICAgaW5mb190b3RhbF9wYWdlX2hpdHM6IEhUTUxQYXJhZ3JhcGhFbGVtZW50IHwgbnVsbCA9IG51bGxcclxuXHJcbiAgICBmcmFtZV9yb3dzOiBBcnJheTxIVE1MVGFibGVSb3dFbGVtZW50PiA9IFtdXHJcbiAgICBcclxuICAgIHNlZV9jb2RlX2J1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQgfCBudWxsID0gbnVsbFxyXG5cclxuICAgIC8qIHNldEludGVydmFsICovXHJcbiAgICBzdG9yZWRTZXRJbnRlcnZhbDogTm9kZUpTLlRpbWVyIHwgbnVsbCA9IG51bGxcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihtZW51OiBNZW51KSB7XHJcbiAgICAgICAgdGhpcy5tZW51ID0gbWVudTtcclxuICAgIH1cclxuXHJcbiAgICBpbml0KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuR1VJID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbmltYXRpb25fZ3VpXCIpIGFzIEhUTUxEaXZFbGVtZW50O1xyXG4gICAgICAgIHRoaXMuTUVOVSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2V0dGluZ3NcIikgYXMgSFRNTERpdkVsZW1lbnQ7XHJcblxyXG4gICAgICAgIHRoaXMucGxheV9wYXVzZV9idXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFuaW1hdGlvbl9wbGF5X3BhdXNlXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xyXG4gICAgICAgIHRoaXMuc3RlcF9idXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFuaW1hdGlvbl9zdGVwXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xyXG4gICAgICAgIHRoaXMuc3RvcF9idXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFuaW1hdGlvbl9zdG9wXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xyXG4gICAgICAgIHRoaXMuc3BlZWRfc2xpZGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbmltYXRpb25fc3BlZWRfc2xpZGVyXCIpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcblxyXG4gICAgICAgIHRoaXMuaW5mb19hbGdvcml0aG0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFuaW1hdGlvbl9pbmZvX2FsZ29yaXRobV92YWx1ZVwiKSBhcyBIVE1MUGFyYWdyYXBoRWxlbWVudDtcclxuICAgICAgICB0aGlzLmluZm9fdGltZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYW5pbWF0aW9uX2luZm9fdGltZV92YWx1ZVwiKSBhcyBIVE1MUGFyYWdyYXBoRWxlbWVudDtcclxuICAgICAgICB0aGlzLmluZm9faXNfZG9uZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYW5pbWF0aW9uX2lzX2RvbmVcIikgYXMgSFRNTERpdkVsZW1lbnQ7XHJcblxyXG4gICAgICAgIHRoaXMuaW5mb19pbl9xdWV1ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2FsbHNfaW5fcXVldWVfdmFsdWVcIikgYXMgSFRNTFBhcmFncmFwaEVsZW1lbnQ7XHJcbiAgICAgICAgdGhpcy5pbmZvX2ZpbmlzaGVkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjYWxsc19maW5pc2hlZF92YWx1ZVwiKSBhcyBIVE1MUGFyYWdyYXBoRWxlbWVudDtcclxuICAgICAgICB0aGlzLmluZm9fdG90YWxfcGFnZV9mYXVsdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRvdGFsX3BhZ2VfZmF1bHRzX3ZhbHVlXCIpIGFzIEhUTUxQYXJhZ3JhcGhFbGVtZW50O1xyXG4gICAgICAgIHRoaXMuaW5mb190b3RhbF9wYWdlX2hpdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRvdGFsX3BhZ2VfaGl0c192YWx1ZVwiKSBhcyBIVE1MUGFyYWdyYXBoRWxlbWVudDtcclxuXHJcbiAgICAgICAgdGhpcy5zZWVfY29kZV9idXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvZGVfYnV0dG9uXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBoaWRlIGVsZW1lbnRzXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5pbmZvX2lzX2RvbmUuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG5cclxuICAgICAgICAvKlxyXG4gICAgICAgICAqIEJpbmQgZXZlbnQgbGlzdGVuZXJzXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5wbGF5X3BhdXNlX2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnRvZ2dsZVBsYXlpbmcoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5zdGVwX2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnN0ZXAoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5zdG9wX2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnRvZ2dsZVZpc2libGUoZmFsc2UpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLnNwZWVkX3NsaWRlci5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnNwZWVkID0gcGFyc2VJbnQodGhpcy5zcGVlZF9zbGlkZXIhLnZhbHVlKTtcclxuICAgICAgICAgICAgdGhpcy5yZWZyZXNoU3BlZWQoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5zZWVfY29kZV9idXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMubWVudS5tZW1vcnkuYWxnb3JpdGhtID09IG51bGwpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICAgICAgICBjb25zdCBhbGdvcml0aG1OYW1lID0gdGhpcy5tZW51Lm1lbW9yeS5hbGdvcml0aG0ubmFtZTtcclxuICAgICAgICAgICAgd2luZG93Lm9wZW4oYGh0dHBzOi8vZ2l0aHViLmNvbS9icnVuMG5lL3NjaGVkdWxpbmctc2ltL2Jsb2IvbWFpbi9wYWdlX3JlcGxhY2VtZW50X3NyYy9jbGFzc2VzL2FsZ29yaXRobXMvJHthbGdvcml0aG1OYW1lfS50c2AsIFwiX2JsYW5rXCIpIS5mb2N1cygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBTZXRJbnRlcnZhbFxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMucmVmcmVzaFNwZWVkKCk7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIHByZXBhcmUgSFRNTCB0YWJsZSBvZiBzdGF0ZXNcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmluaXRTdGF0ZVRhYmxlKCk7XHJcbiAgICB9XHJcbiAgICB0b2dnbGVQbGF5aW5nKHBsYXlpbmc/OiBib29sZWFuKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHBsYXlpbmcgPT0gbnVsbClcclxuICAgICAgICAgICAgdGhpcy5wbGF5aW5nID0gIXRoaXMucGxheWluZztcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHRoaXMucGxheWluZyA9IHBsYXlpbmc7XHJcblxyXG4gICAgICAgIHRoaXMucmVmcmVzaFNwZWVkKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIHRoaXMucGxheV9wYXVzZV9idXR0b24hLmlubmVySFRNTCA9IHRoaXMucGxheWluZyA/IFwiUGF1c2VcIiA6IFwiUGxheVwiO1xyXG4gICAgfVxyXG5cclxuICAgIHRvZ2dsZVZpc2libGUodmlzaWJsZT86IGJvb2xlYW4pOiB2b2lkIHtcclxuICAgICAgICBpZiAodmlzaWJsZSA9PSBudWxsKVxyXG4gICAgICAgICAgICB0aGlzLnZpc2libGUgPSAhdGhpcy52aXNpYmxlO1xyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgdGhpcy52aXNpYmxlID0gdmlzaWJsZTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgaWYgKHRoaXMudmlzaWJsZSl7XHJcbiAgICAgICAgICAgIHRoaXMuR1VJIS5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gICAgICAgICAgICB0aGlzLk1FTlUhLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuXHJcbiAgICAgICAgICAgIHRoaXMubWVudS5kaXNwbGF5LnJlc2l6ZUNhbGxiYWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kcmF3Q3VycmVudFN0YXRlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5kcmF3Q3VycmVudFN0YXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLkdVSSEuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgICAgICAgICB0aGlzLk1FTlUhLnN0eWxlLmRpc3BsYXkgPSBcImZsZXhcIjtcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnN0b3JlZFNldEludGVydmFsICE9IG51bGwpXHJcbiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMuc3RvcmVkU2V0SW50ZXJ2YWwpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5tZW51LmRpc3BsYXkucmVzaXplQ2FsbGJhY2sgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1lbnUucmVmcmVzaENhbGxzKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5tZW51LnJlZnJlc2hDYWxscygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXNldCgpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5wbGF5X3BhdXNlX2J1dHRvbiA9PSBudWxsIHx8IHRoaXMuaW5mb19pc19kb25lID09IG51bGwgfHwgdGhpcy5zdGVwX2J1dHRvbiA9PSBudWxsKVxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJjYWxsIGluaXQoKSBmaXJzdCFcIik7XHJcblxyXG4gICAgICAgIHRoaXMubWVudS5tZW1vcnkuaW5pdCgpO1xyXG5cclxuICAgICAgICB0aGlzLnBsYXlfcGF1c2VfYnV0dG9uLmlubmVySFRNTCA9IFwiUGxheVwiO1xyXG4gICAgICAgIHRoaXMucGxheWluZyA9IGZhbHNlO1xyXG4gICAgXHJcbiAgICAgICAgdGhpcy5pbmZvX2lzX2RvbmUuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG5cclxuICAgICAgICB0aGlzLnBsYXlfcGF1c2VfYnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5zdGVwX2J1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLmluaXRTdGF0ZVRhYmxlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhcnRBbmltYXRpb24oKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5yZXNldCgpO1xyXG4gICAgICAgIHRoaXMudG9nZ2xlVmlzaWJsZSh0cnVlKTtcclxuICAgIH1cclxuXHJcbiAgICBkcmF3Q3VycmVudFN0YXRlKCk6IHZvaWQge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIHJlZnJlc2ggaW5mb1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMucmVmcmVzaEluZm8oKTtcclxuXHJcbiAgICAgICAgdGhpcy5kcmF3Q2FsbHMoKTtcclxuICAgIH1cclxuXHJcbiAgICBpbml0U3RhdGVUYWJsZSgpOiB2b2lkIHtcclxuICAgICAgICAvKiBncmFiIGVsZW1lbnRzICovXHJcbiAgICAgICAgY29uc3QgdGltZV9yb3cgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFuaW1hdGlvbl90YWJsZV90aW1lXCIpIGFzIEhUTUxUYWJsZVJvd0VsZW1lbnQ7XHJcbiAgICAgICAgY29uc3QgY2FsbHNfcm93ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbmltYXRpb25fdGFibGVfcGFnZV9jYWxsc1wiKSBhcyBIVE1MVGFibGVSb3dFbGVtZW50O1xyXG4gICAgICAgIGNvbnN0IHRib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbmltYXRpb25fdGFibGVfYm9keVwiKSBhcyBIVE1MVGFibGVTZWN0aW9uRWxlbWVudDtcclxuXHJcbiAgICAgICAgLyogY2xlYXIgdGFibGUgKi9cclxuICAgICAgICB0aW1lX3Jvdy5pbm5lckhUTUwgPSBcIlwiO1xyXG4gICAgICAgIGNhbGxzX3Jvdy5pbm5lckhUTUwgPSBcIlwiO1xyXG5cclxuICAgICAgICAvKiB0aW1lICovXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBjb25zdCB0aW1lX3Jvd19oZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGhcIik7XHJcbiAgICAgICAgICAgIHRpbWVfcm93X2hlYWRlci5pbm5lckhUTUwgPSBcIlRpbWVcIjtcclxuICAgICAgICAgICAgdGltZV9yb3dfaGVhZGVyLmNsYXNzTGlzdC5hZGQoXCJoZWFkZXJcIik7XHJcbiAgICAgICAgICAgIHRpbWVfcm93LmFwcGVuZENoaWxkKHRpbWVfcm93X2hlYWRlcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKiBjYWxscyAqL1xyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgY29uc3QgY2FsbHNfcm93X2hlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0aFwiKTtcclxuICAgICAgICAgICAgY2FsbHNfcm93X2hlYWRlci5pbm5lckhUTUwgPSBcIlBhZ2UgY2FsbHNcIjtcclxuICAgICAgICAgICAgY2FsbHNfcm93X2hlYWRlci5jbGFzc0xpc3QuYWRkKFwiaGVhZGVyXCIpO1xyXG4gICAgICAgICAgICBjYWxsc19yb3cuYXBwZW5kQ2hpbGQoY2FsbHNfcm93X2hlYWRlcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKiBmcmFtZXMgKi9cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIC8qIHJlbW92ZSBvbGQgcm93cyAqL1xyXG4gICAgICAgICAgICB3aGlsZSAodGJvZHkubGFzdENoaWxkICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGlkID0gKHRib2R5Lmxhc3RDaGlsZCBhcyBIVE1MRWxlbWVudCkuaWQ7XHJcbiAgICAgICAgICAgICAgICBpZiAoaWQgPT0gXCJhbmltYXRpb25fdGFibGVfcGFnZV9jYWxsc1wiKSAvLyBza2lwIHRoZSByb3cgd2l0aCBwYWdlIGNhbGxzXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgdGJvZHkucmVtb3ZlQ2hpbGQodGJvZHkubGFzdENoaWxkKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLyogYWRkIGEgcm93IGZvciBlYWNoIGZyYW1lICovXHJcbiAgICAgICAgICAgIGNvbnN0IGZyYW1lX3Jvd3M6IEFycmF5PEhUTUxUYWJsZVJvd0VsZW1lbnQ+ID0gW107XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5tZW51Lm1lbW9yeS5udW1iZXJfb2ZfZnJhbWVzOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGZyYW1lX3JvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0clwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBmcmFtZV9yb3dfaGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRoXCIpO1xyXG4gICAgICAgICAgICAgICAgZnJhbWVfcm93X2hlYWRlci5pbm5lckhUTUwgPSBgRnJhbWUgJHtpfWA7XHJcbiAgICAgICAgICAgICAgICBmcmFtZV9yb3cuYXBwZW5kQ2hpbGQoZnJhbWVfcm93X2hlYWRlcik7XHJcblxyXG4gICAgICAgICAgICAgICAgZnJhbWVfcm93cy5wdXNoKGZyYW1lX3Jvdyk7XHJcbiAgICAgICAgICAgICAgICB0Ym9keS5hcHBlbmRDaGlsZChmcmFtZV9yb3cpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuZnJhbWVfcm93cyA9IGZyYW1lX3Jvd3M7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGRyYXdDYWxscyhTVEFSVF9YPzogbnVtYmVyLCBTVEFSVF9ZPzogbnVtYmVyLCBXSURUSD86IG51bWJlciwgSEVJR0hUPzogbnVtYmVyLCBjYWxsc1RvRHJhdz86IGFueSk6IHZvaWQge1xyXG4gICAgICAgIC8qIGdyYWIgZWxlbWVudHMgKi9cclxuICAgICAgICBjb25zdCB0aW1lX3JvdyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYW5pbWF0aW9uX3RhYmxlX3RpbWVcIikgYXMgSFRNTFRhYmxlUm93RWxlbWVudDtcclxuICAgICAgICBjb25zdCBjYWxsc19yb3cgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFuaW1hdGlvbl90YWJsZV9wYWdlX2NhbGxzXCIpIGFzIEhUTUxUYWJsZVJvd0VsZW1lbnQ7XHJcblxyXG4gICAgICAgIC8qIG9ubHkgYWRkIG9uZSBjb2x1bW4gZm9yIHRoZSBuZXcgc3RhdGUgKi9cclxuICAgICAgICBjb25zdCBuZXdDYWxsID0gdGhpcy5tZW51Lm1lbW9yeS5wcmV2aW91c19wYWdlX2NhbGxzLmF0KC0xKTtcclxuICAgICAgICBpZiAobmV3Q2FsbCA9PSBudWxsKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICAgIC8qIHRpbWUgKi9cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRpbWVUaWNrRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGhcIik7XHJcbiAgICAgICAgICAgIHRpbWVUaWNrRWwuaW5uZXJIVE1MID0gYCR7dGhpcy5tZW51Lm1lbW9yeS50aW1lfWA7XHJcbiAgICAgICAgICAgIHRpbWVfcm93LmFwcGVuZENoaWxkKHRpbWVUaWNrRWwpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyogY2FsbHMgKi9cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNhbGxzVGlja0VsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRoXCIpO1xyXG4gICAgICAgICAgICBjYWxsc1RpY2tFbC5pbm5lckhUTUwgPSBgJHtuZXdDYWxsLmlkfWA7XHJcblxyXG4gICAgICAgICAgICBjYWxsc19yb3cuYXBwZW5kQ2hpbGQoY2FsbHNUaWNrRWwpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyogZnJhbWVzICovXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubWVudS5tZW1vcnkubnVtYmVyX29mX2ZyYW1lczsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBmcmFtZV9yb3cgPSB0aGlzLmZyYW1lX3Jvd3NbaV07XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwYWdlID0gdGhpcy5tZW51Lm1lbW9yeS5mcmFtZXNbaV0ucGFnZTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBmcmFtZVRpY2tFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0aFwiKTtcclxuICAgICAgICAgICAgICAgIGZyYW1lVGlja0VsLmlubmVySFRNTCA9IGAke3BhZ2UgIT0gbnVsbCA/IHBhZ2UuaWQgOiBcIlwifWA7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gbWFrZSBwYWdlIGZhdWx0cyByZWRcclxuICAgICAgICAgICAgICAgIGlmIChwYWdlICE9IG51bGwgJiYgcGFnZS5pZCA9PSBuZXdDYWxsLmlkICYmIHRoaXMubWVudS5tZW1vcnkubGFzdF9jYWxsX2NhdXNlZF9mYXVsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZyYW1lVGlja0VsLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwicmVkXCI7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZnJhbWVfcm93LmFwcGVuZENoaWxkKGZyYW1lVGlja0VsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyogc2Nyb2xsIHRvIHRoZSByaWdodCAqL1xyXG4gICAgICAgIGNvbnN0IHRhYmxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbmltYXRpb25fY2FsbF90YWJsZVwiKSBhcyBIVE1MVGFibGVFbGVtZW50O1xyXG4gICAgICAgIHRhYmxlLnNjcm9sbExlZnQgPSB0YWJsZS5zY3JvbGxXaWR0aDtcclxuICAgIH1cclxuXHJcbiAgICByZWZyZXNoSW5mbygpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBtZW1vcnkgPSB0aGlzLm1lbnUubWVtb3J5O1xyXG4gICAgICAgIGlmIChtZW1vcnkuYWxnb3JpdGhtID09IG51bGwpXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImNhbGwgc3RhcnRBbmltYXRpb24oKSBmaXJzdCFcIik7XHJcblxyXG4gICAgICAgIHRoaXMuaW5mb19hbGdvcml0aG0hLmlubmVySFRNTCA9IG1lbW9yeS5hbGdvcml0aG0ubmFtZTtcclxuICAgICAgICB0aGlzLmluZm9fdGltZSEuaW5uZXJIVE1MID0gbWVtb3J5LnRpbWUudG9TdHJpbmcoKTtcclxuXHJcbiAgICAgICAgaWYgKG1lbW9yeS5pc0ZpbmlzaGVkKCkpXHJcbiAgICAgICAgICAgIHRoaXMuaW5mb19pc19kb25lIS5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgdGhpcy5pbmZvX2lzX2RvbmUhLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuXHJcbiAgICAgICAgdGhpcy5pbmZvX3RvdGFsX3BhZ2VfaGl0cyEuaW5uZXJIVE1MID0gKG1lbW9yeS5wcmV2aW91c19wYWdlX2NhbGxzLmxlbmd0aCAtICBtZW1vcnkudG90YWxfcGFnZV9mYXVsdHMpLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgdGhpcy5pbmZvX3RvdGFsX3BhZ2VfZmF1bHRzIS5pbm5lckhUTUwgPSBtZW1vcnkudG90YWxfcGFnZV9mYXVsdHMudG9TdHJpbmcoKTtcclxuXHJcbiAgICAgICAgdGhpcy5pbmZvX2luX3F1ZXVlIS5pbm5lckhUTUwgPSBtZW1vcnkucGFnZV9jYWxsX3F1ZXVlLmxlbmd0aC50b1N0cmluZygpO1xyXG4gICAgICAgIHRoaXMuaW5mb19maW5pc2hlZCEuaW5uZXJIVE1MID0gbWVtb3J5LnByZXZpb3VzX3BhZ2VfY2FsbHMubGVuZ3RoLnRvU3RyaW5nKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVmcmVzaFNwZWVkKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLnN0b3JlZFNldEludGVydmFsICE9IG51bGwpXHJcbiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5zdG9yZWRTZXRJbnRlcnZhbCk7XHJcblxyXG4gICAgICAgIHRoaXMuc3RvcmVkU2V0SW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5wbGF5aW5nKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RlcCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSkuYmluZCh0aGlzKSwgMTAwMCAvIHRoaXMuc3BlZWQpO1xyXG4gICAgfVxyXG5cclxuICAgIHN0ZXAoKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMubWVudS5tZW1vcnkuaXNGaW5pc2hlZCgpKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICAgIHRoaXMubWVudS5tZW1vcnkubmV4dFRpY2soKTtcclxuICAgICAgICB0aGlzLmRyYXdDdXJyZW50U3RhdGUoKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMubWVudS5tZW1vcnkuaXNGaW5pc2hlZCgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMudG9nZ2xlUGxheWluZyhmYWxzZSk7XHJcbiAgICAgICAgICAgIHRoaXMubWVudS5tZW1vcnkuZGlzcGxheVJlc3VsdHModGhpcy5tZW51Lm1lbW9yeS5nZXRSZXN1bHRzKCkpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5hZnRlckRvbmUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgYWZ0ZXJEb25lKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLmluZm9faXNfZG9uZSA9PSBudWxsIHx8IHRoaXMucGxheV9wYXVzZV9idXR0b24gPT0gbnVsbCB8fCB0aGlzLnN0ZXBfYnV0dG9uID09IG51bGwpXHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImNhbGwgaW5pdCgpIGZpcnN0IVwiKTtcclxuXHJcbiAgICAgICAgdGhpcy5pbmZvX2lzX2RvbmUuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuXHJcbiAgICAgICAgdGhpcy5wbGF5X3BhdXNlX2J1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5zdGVwX2J1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgUGFnZSBmcm9tIFwiLi9QYWdlXCJcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZyYW1lIHtcclxuICAgIHBhZ2U6IFBhZ2UgfCBudWxsXHJcblxyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5wYWdlID0gbnVsbDtcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQgUGFnZSBmcm9tIFwiLi9QYWdlXCJcclxuaW1wb3J0IEZyYW1lIGZyb20gXCIuL0ZyYW1lXCJcclxuaW1wb3J0IFJlcGxhY2VtZW50QWxnb3JpdGhtLCB7IE1lbW9yeVN0YXRlRGF0YSB9IGZyb20gXCIuL1JlcGxhY2VtZW50QWxnb3JpdGhtXCJcclxuXHJcbnR5cGUgcmVzdWx0cyA9IHtcclxuICAgIHRvdGFsX3BhZ2VfZmF1bHRzOiBudW1iZXIsXHJcbiAgICB0b3RhbF9wYWdlX2hpdHM6IG51bWJlcixcclxuICAgIHRvdGFsX3BhZ2VfY2FsbHM6IG51bWJlclxyXG59XHJcblxyXG4vKipcclxuICogTWVtb3J5IE1hbmFnZW1lbnQgVW5pdFxyXG4gKi9cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTU1VIHtcclxuICAgIG51bWJlcl9vZl9wYWdlczogbnVtYmVyID0gMFxyXG4gICAgbnVtYmVyX29mX2ZyYW1lczogbnVtYmVyID0gMFxyXG5cclxuICAgIHBhZ2VfY2FsbF9wb29sOiBBcnJheTxQYWdlPiA9IFtdXHJcbiAgICBwYWdlX2NhbGxfcXVldWU6IEFycmF5PFBhZ2U+ID0gW11cclxuICAgIHByZXZpb3VzX3BhZ2VfY2FsbHM6IEFycmF5PFBhZ2U+ID0gW11cclxuXHJcbiAgICBmcmFtZXM6IEFycmF5PEZyYW1lPiA9IFtdXHJcblxyXG4gICAgYWxnb3JpdGhtOiBSZXBsYWNlbWVudEFsZ29yaXRobSB8IG51bGwgPSBudWxsXHJcbiAgICBsYXN0X3JlcGxhY2VkX2luZGV4OiBudW1iZXIgPSAtMVxyXG5cclxuICAgIHRvdGFsX3BhZ2VfZmF1bHRzOiBudW1iZXJcclxuICAgIHRpbWU6IG51bWJlclxyXG5cclxuICAgIGxhc3RfY2FsbF9jYXVzZWRfZmF1bHQ6IGJvb2xlYW4gPSBmYWxzZVxyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMudGltZSA9IDA7XHJcbiAgICAgICAgdGhpcy50b3RhbF9wYWdlX2ZhdWx0cyA9IDA7XHJcbiAgICB9XHJcblxyXG4gICAgaW5pdChudW1iZXJfb2ZfcGFnZXM/OiBudW1iZXIsIG51bWJlcl9vZl9mcmFtZXM/OiBudW1iZXIpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLm51bWJlcl9vZl9wYWdlcyA9IG51bWJlcl9vZl9wYWdlcyA/PyB0aGlzLm51bWJlcl9vZl9wYWdlcztcclxuICAgICAgICB0aGlzLm51bWJlcl9vZl9mcmFtZXMgPSBudW1iZXJfb2ZfZnJhbWVzID8/IHRoaXMubnVtYmVyX29mX2ZyYW1lcztcclxuXHJcbiAgICAgICAgdGhpcy5wYWdlX2NhbGxfcXVldWUgPSBbLi4udGhpcy5wYWdlX2NhbGxfcG9vbF07IC8vIGNvcHkgYXJyYXlcclxuICAgICAgICB0aGlzLmZyYW1lcyA9IFtdO1xyXG4gICAgICAgIHRoaXMucHJldmlvdXNfcGFnZV9jYWxscyA9IFtdO1xyXG5cclxuICAgICAgICB0aGlzLnRpbWUgPSAwO1xyXG4gICAgICAgIHRoaXMudG90YWxfcGFnZV9mYXVsdHMgPSAwO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMubnVtYmVyX29mX2ZyYW1lczsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZnJhbWVzLnB1c2gobmV3IEZyYW1lKCkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBhZGRQYWdlQ2FsbFRvUG9vbChwYWdlX2NhbGw6IFBhZ2UpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnBhZ2VfY2FsbF9wb29sLnB1c2gocGFnZV9jYWxsKTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRQYWdlQ2FsbHNUb1Bvb2wocGFnZV9jYWxsczogQXJyYXk8bnVtYmVyPikge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFnZV9jYWxscy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLnBhZ2VfY2FsbF9wb29sLnB1c2gobmV3IFBhZ2UocGFnZV9jYWxsc1tpXSkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjbGVhclBhZ2VDYWxsUG9vbCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnBhZ2VfY2FsbF9wb29sID0gW107XHJcbiAgICB9XHJcblxyXG4gICAgc2V0QWxnb3JpdGhtKGFsZ29yaXRobTogUmVwbGFjZW1lbnRBbGdvcml0aG0pOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmFsZ29yaXRobSA9IGFsZ29yaXRobTtcclxuICAgIH1cclxuXHJcbiAgICBuZXh0VGljaygpOiB2b2lkIHtcclxuICAgICAgICAvKiBlbnN1cmUgdGhhdCBhbiBhbGdvcml0aG0gaXMgc2VsZWN0ZWQgKi9cclxuICAgICAgICBpZiAodGhpcy5hbGdvcml0aG0gPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBhbGdvcml0aG0gc2VsZWN0ZWRcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBwYWdlX2NhbGwgPSB0aGlzLnBhZ2VfY2FsbF9xdWV1ZS5zaGlmdCgpO1xyXG5cclxuICAgICAgICAvKiBubyBwYWdlIGNhbGwgYXQgdGhpcyB0aW1lICovXHJcbiAgICAgICAgaWYgKHBhZ2VfY2FsbCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkVtcHR5IHBhZ2UgY2FsbCBxdWV1ZSBidXQgbm90IGZpbmlzaGVkXCIpO1xyXG4gICAgICAgICAgICB0aGlzLnRpbWUrKztcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICB0aGlzLnByZXZpb3VzX3BhZ2VfY2FsbHMucHVzaChwYWdlX2NhbGwpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiUGFnZSBjYWxsOiBcIiArIHBhZ2VfY2FsbC5pZCk7XHJcblxyXG4gICAgICAgIGlmIChwYWdlX2NhbGwpIHtcclxuICAgICAgICAgICAgdGhpcy5hbGdvcml0aG0ub25QYWdlQ2FsbD8uKHRoaXMuZ2V0Q3VycmVudFN0YXRlRGF0YShwYWdlX2NhbGwpKTtcclxuXHJcbiAgICAgICAgICAgIC8qIGNoZWNrIGlmIHRoZXJlIGlzIGEgcGFnZSBmYXVsdCAqL1xyXG4gICAgICAgICAgICBsZXQgcGFnZV9mYXVsdCA9IHRydWU7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5mcmFtZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmZyYW1lc1tpXSA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkZyYW1lIGlzIG51bGxcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZnJhbWVzW2ldLnBhZ2UgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8qIGluc2VydCBpbnRvIHRoZSBmaXJzdCBmcmVlIGZyYW1lICovXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mcmFtZXNbaV0ucGFnZSA9IHBhZ2VfY2FsbDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxhc3RfcmVwbGFjZWRfaW5kZXggPSBpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvKiBpbmNyZW1lbnQgdGhlIHRvdGFsIHBhZ2UgZmF1bHRzICovXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50b3RhbF9wYWdlX2ZhdWx0cysrO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGFzdF9jYWxsX2NhdXNlZF9mYXVsdCA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHBhZ2VfZmF1bHQgPSBmYWxzZTsgLy8gcGFnZSBmYXVsdCBhbHJlYWR5IGhhbmRsZWRcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoKDxQYWdlPiB0aGlzLmZyYW1lc1tpXS5wYWdlKS5pZCA9PSBwYWdlX2NhbGwuaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvKiBwYWdlIGlzIGFscmVhZHkgaW4gbWVtb3J5ICovXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hbGdvcml0aG0ub25QYWdlQWxyZWFkeUluTWVtb3J5Py4odGhpcy5nZXRDdXJyZW50U3RhdGVEYXRhKHBhZ2VfY2FsbCkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxhc3RfY2FsbF9jYXVzZWRfZmF1bHQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICBwYWdlX2ZhdWx0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8qIGhhbmRsZSBwYWdlIGZhdWx0ICovXHJcbiAgICAgICAgICAgIGlmIChwYWdlX2ZhdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlBhZ2UgZmF1bHQ6IFwiICsgcGFnZV9jYWxsLmlkKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvKiBlbnN1cmUgdGhhdCB0aGVyZSBhcmUgbm8gZnJlZSBmcmFtZXMgKi9cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmZyYW1lcy5maW5kKGZyYW1lID0+IGZyYW1lLnBhZ2UgPT0gbnVsbCkgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkluaXRpYWwgcGFnZSBmaWxsIG5vdCBoYW5kbGVkIHByb3Blcmx5XCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8qIGluY3JlbWVudCB0aGUgdG90YWwgcGFnZSBmYXVsdHMgKi9cclxuICAgICAgICAgICAgICAgIHRoaXMudG90YWxfcGFnZV9mYXVsdHMrKztcclxuICAgICAgICAgICAgICAgIHRoaXMubGFzdF9jYWxsX2NhdXNlZF9mYXVsdCA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgLyogcmVwbGFjZSBhIHBhZ2UgKi9cclxuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4X3RvX3JlcGxhY2UgPSB0aGlzLmFsZ29yaXRobS5oYW5kbGVQYWdlRmF1bHQodGhpcy5nZXRDdXJyZW50U3RhdGVEYXRhKHBhZ2VfY2FsbCkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5mcmFtZXNbaW5kZXhfdG9fcmVwbGFjZV0ucGFnZSA9IHBhZ2VfY2FsbDtcclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLmxhc3RfcmVwbGFjZWRfaW5kZXggPSBpbmRleF90b19yZXBsYWNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvKiBlbnN1cmUgdGhhdCB0aGUgcGFnZSBpcyBub3cgaW4gbWVtb3J5ICovXHJcbiAgICAgICAgICAgIGxldCBwYWdlX2luX21lbW9yeSA9IGZhbHNlO1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGZyYW1lIG9mIHRoaXMuZnJhbWVzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZnJhbWUucGFnZSA9PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICgoPFBhZ2U+IGZyYW1lLnBhZ2UpLmlkID09IHBhZ2VfY2FsbC5pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8qIHBhZ2UgaXMgaW4gbWVtb3J5ICovXHJcbiAgICAgICAgICAgICAgICAgICAgcGFnZV9pbl9tZW1vcnkgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghcGFnZV9pbl9tZW1vcnkpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlBhZ2UgZmF1bHQgbm90IGhhbmRsZWQgcHJvcGVybHkgLSBwYWdlIG5vdCBpbiBtZW1vcnlcIik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8qIGNhbGwgdGhlIHBhZ2UgKi9cclxuICAgICAgICAgICAgcGFnZV9jYWxsLmNhbGwodGhpcy50aW1lKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMudGltZSsrO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEN1cnJlbnRTdGF0ZURhdGEocGFnZV9jYWxsOiBQYWdlKTogTWVtb3J5U3RhdGVEYXRhIHtcclxuICAgICAgICBjb25zdCBkYXRhOiBNZW1vcnlTdGF0ZURhdGEgPSB7XHJcbiAgICAgICAgICAgIHBhZ2VfY2FsbDogcGFnZV9jYWxsLFxyXG4gICAgICAgICAgICBsYXN0X3JlcGxhY2VkX2luZGV4OiB0aGlzLmxhc3RfcmVwbGFjZWRfaW5kZXgsXHJcbiAgICAgICAgICAgIGN1cnJlbnRfZnJhbWVzOiB0aGlzLmZyYW1lcyxcclxuICAgICAgICAgICAgZnV0dXJlX3BhZ2VfY2FsbHM6IHRoaXMucGFnZV9jYWxsX3F1ZXVlLFxyXG4gICAgICAgICAgICBwcmV2aW91c19wYWdlX2NhbGxzOiB0aGlzLnByZXZpb3VzX3BhZ2VfY2FsbHNcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgIH1cclxuXHJcbiAgICBpc0ZpbmlzaGVkKCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBhZ2VfY2FsbF9xdWV1ZS5sZW5ndGggPT0gMDtcclxuICAgIH1cclxuXHJcbiAgICBzaW11bGF0ZSgpOiByZXN1bHRzIHtcclxuICAgICAgICB0aGlzLmluaXQoKTtcclxuXHJcbiAgICAgICAgd2hpbGUgKCF0aGlzLmlzRmluaXNoZWQoKSkge1xyXG4gICAgICAgICAgICB0aGlzLm5leHRUaWNrKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5nZXRSZXN1bHRzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0UmVzdWx0cygpOiByZXN1bHRzIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB0b3RhbF9wYWdlX2ZhdWx0czogdGhpcy50b3RhbF9wYWdlX2ZhdWx0cyxcclxuICAgICAgICAgICAgdG90YWxfcGFnZV9oaXRzOiB0aGlzLnByZXZpb3VzX3BhZ2VfY2FsbHMubGVuZ3RoIC0gdGhpcy50b3RhbF9wYWdlX2ZhdWx0cyxcclxuICAgICAgICAgICAgdG90YWxfcGFnZV9jYWxsczogdGhpcy5wcmV2aW91c19wYWdlX2NhbGxzLmxlbmd0aFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiB2aXN1YWxpemF0aW9uICYgb3V0cHV0XHJcbiAgICAgKi9cclxuXHJcbiAgICBwcmludEZyYW1lcygpOiB2b2lkIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkZyYW1lczpcIik7XHJcbiAgICAgICAgZm9yIChjb25zdCBmcmFtZSBvZiB0aGlzLmZyYW1lcykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhmcmFtZS5wYWdlID8gZnJhbWUucGFnZS5pZCA6IFwibnVsbFwiKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZGlzcGxheVJlc3VsdHMocmVzdWx0czogcmVzdWx0cywgYWxnU3RyOiBzdHJpbmcgPSAoPEFsZ29yaXRobT4gdGhpcy5hbGdvcml0aG0pLm5hbWUpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCByZXN1bHRzX3dyYXBwZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJlc3VsdHNfd3JhcHBlclwiKSBhcyBIVE1MRWxlbWVudDtcclxuICAgICAgICByZXN1bHRzX3dyYXBwZXIuc3R5bGUuZGlzcGxheSA9IFwiZmxleFwiO1xyXG5cclxuICAgICAgICBjb25zdCByZXN1bHRzX2VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZXN1bHRzXCIpIGFzIEhUTUxFbGVtZW50O1xyXG4gICAgICAgIHJlc3VsdHNfZWwuaW5uZXJIVE1MID0gYFxyXG4gICAgICAgIEFsZ29yaXRobTogJHthbGdTdHIudG9VcHBlckNhc2UoKX1cclxuXHJcbiAgICAgICAgVG90YWwgcGFnZSBmYXVsdHM6IDxiIHN0eWxlPSdjb2xvcjogcmVkJz4ke3Jlc3VsdHMudG90YWxfcGFnZV9mYXVsdHMudG9GaXhlZCgwKX08L2I+XHJcbiAgICAgICAgVG90YWwgcGFnZSBoaXRzOiA8YiBzdHlsZT0nY29sb3I6IGxpbWUnPiR7cmVzdWx0cy50b3RhbF9wYWdlX2hpdHMudG9GaXhlZCgwKX08L2I+XHJcbiAgICAgICAgVG90YWwgcGFnZSBjYWxsczogPGI+JHtyZXN1bHRzLnRvdGFsX3BhZ2VfY2FsbHMudG9GaXhlZCgwKX08L2I+XHJcbiAgICAgICAgYC5yZXBsYWNlKFJlZ0V4cChcIlxcblwiLCBcImdcIiksIFwiPGJyIC8+XCIpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbXBhcmVBbGxBbmREaXNwbGF5UmVzdWx0cyhhbGdvcml0aG1zOiBBcnJheTxSZXBsYWNlbWVudEFsZ29yaXRobT4pOiB2b2lkIHtcclxuICAgICAgICBjb25zdCByZXN1bHRzX3dyYXBwZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJlc3VsdHNfd3JhcHBlclwiKSBhcyBIVE1MRWxlbWVudDtcclxuICAgICAgICByZXN1bHRzX3dyYXBwZXIuc3R5bGUuZGlzcGxheSA9IFwiZmxleFwiO1xyXG5cclxuICAgICAgICBjb25zdCByZXN1bHRzX2VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZXN1bHRzXCIpIGFzIEhUTUxFbGVtZW50O1xyXG4gICAgICAgIHJlc3VsdHNfZWwuaW5uZXJIVE1MID0gXCJcIjtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhbGdvcml0aG1zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0QWxnb3JpdGhtKGFsZ29yaXRobXNbaV0pO1xyXG4gICAgICAgICAgICBjb25zdCByZXN1bHRzOiByZXN1bHRzID0gdGhpcy5zaW11bGF0ZSgpO1xyXG5cclxuICAgICAgICAgICAgcmVzdWx0c19lbC5pbm5lckhUTUwgKz0gYFxyXG4gICAgICAgICAgICBBbGdvcml0aG06ICR7YWxnb3JpdGhtc1tpXS5uYW1lLnRvVXBwZXJDYXNlKCl9XHJcbiAgICAgICAgICAgIFRvdGFsIHBhZ2UgZmF1bHRzOiA8YiBzdHlsZT0nY29sb3I6IHJlZCc+JHtyZXN1bHRzLnRvdGFsX3BhZ2VfZmF1bHRzLnRvRml4ZWQoMCl9PC9iPlxyXG4gICAgICAgICAgICBUb3RhbCBwYWdlIGhpdHM6IDxiIHN0eWxlPSdjb2xvcjogbGltZSc+JHtyZXN1bHRzLnRvdGFsX3BhZ2VfaGl0cy50b0ZpeGVkKDApfTwvYj5cclxuICAgICAgICAgICAgVG90YWwgcGFnZSBjYWxsczogPGI+JHtyZXN1bHRzLnRvdGFsX3BhZ2VfY2FsbHMudG9GaXhlZCgwKX08L2I+XHJcbiAgICAgICAgICAgIGAucmVwbGFjZShSZWdFeHAoXCJcXG5cIiwgXCJnXCIpLCBcIjxiciAvPlwiKTtcclxuXHJcbiAgICAgICAgICAgIHJlc3VsdHNfZWwuaW5uZXJIVE1MICs9IFwiPGJyIC8+XCI7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwiaW1wb3J0IElNZW51IGZyb20gXCIuLi8uLi9zaGFyZWQvaW50ZXJmYWNlcy9JTWVudVwiO1xyXG5pbXBvcnQgRGlzcGxheSBmcm9tIFwiLi4vLi4vc2hhcmVkL2NsYXNzZXMvRGlzcGxheVwiO1xyXG5cclxuaW1wb3J0IEFuaW1hdGlvbkdVSSBmcm9tIFwiLi9BbmltYXRpb25HVUlcIjtcclxuaW1wb3J0IE1NVSBmcm9tIFwiLi9NTVVcIjtcclxuaW1wb3J0IFBhZ2UgZnJvbSBcIi4vUGFnZVwiO1xyXG5cclxuaW1wb3J0IEZJRk8gZnJvbSBcIi4vYWxnb3JpdGhtcy9GSUZPXCI7XHJcbmltcG9ydCBPUFQgZnJvbSBcIi4vYWxnb3JpdGhtcy9PUFRcIjtcclxuaW1wb3J0IExSVSBmcm9tIFwiLi9hbGdvcml0aG1zL0xSVVwiO1xyXG5pbXBvcnQgQUxSVSBmcm9tIFwiLi9hbGdvcml0aG1zL0FMUlVcIjtcclxuaW1wb3J0IFJBTkQgZnJvbSBcIi4vYWxnb3JpdGhtcy9SQU5EXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNZW51IGltcGxlbWVudHMgSU1lbnUge1xyXG4gICAgZGlzcGxheTogRGlzcGxheVxyXG4gICAgbWVtb3J5OiBNTVVcclxuICAgIGFuaW1hdGlvbkdVSTogQW5pbWF0aW9uR1VJXHJcblxyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5kaXNwbGF5ID0gbmV3IERpc3BsYXkoKTtcclxuICAgICAgICB0aGlzLm1lbW9yeSA9IG5ldyBNTVUoKTtcclxuXHJcbiAgICAgICAgdGhpcy5hbmltYXRpb25HVUkgPSBuZXcgQW5pbWF0aW9uR1VJKHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIGluaXQoKTogdm9pZCB7ICBcclxuICAgICAgICBjb25zdCBydW5fYnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJydW5fYnV0dG9uXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xyXG4gICAgICAgIHJ1bl9idXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHsgdGhpcy5ydW4oKSB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgcnVuX3dpdGhfYW5pbWF0aW9uX2J1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicnVuX3dpdGhfYW5pbWF0aW9uX2J1dHRvblwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcclxuICAgICAgICBydW5fd2l0aF9hbmltYXRpb25fYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7IHRoaXMucnVuKHRydWUpIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBhZGRfYnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhZGRfYnV0dG9uXCIpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xyXG4gICAgICAgIGFkZF9idXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHsgdGhpcy5hZGRDYWxscygpIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBjbGVhcl9idXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNsZWFyX2J1dHRvblwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcclxuICAgICAgICBjbGVhcl9idXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHsgdGhpcy5jbGVhckNhbGxzKCkgfSk7XHJcblxyXG4gICAgICAgIC8qXHJcbiAgICAgICAgICogaW5pdCBcclxuICAgICAgICAgKiBzZXQgY2FsbGJhY2sgZm9yIHJlc2l6ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMubWVtb3J5LmluaXQoNSwgMyk7XHJcbiAgICAgICAgdGhpcy5kaXNwbGF5LmluaXQoXCJtYWluX2NhbnZhc1wiKTtcclxuICAgICAgICB0aGlzLmFuaW1hdGlvbkdVSS5pbml0KCk7XHJcbiAgICAgICAgdGhpcy5kaXNwbGF5LnNldFJlc2l6ZUNhbGxiYWNrKCgpID0+IHsgdGhpcy5yZWZyZXNoQ2FsbHMoKSB9KTtcclxuXHJcbiAgICAgICAgLyoqIFxyXG4gICAgICAgICAqIGJhc2ljIHNldHRpbmdzXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY29uc3QgbnVtYmVyX29mX3BhZ2VzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzX3BhZ2VfY291bnRcIikgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgICAgICBudW1iZXJfb2ZfcGFnZXMuYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCAoZTogRXZlbnQpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgbmV3X3ZhbCA9IHBhcnNlSW50KCg8SFRNTElucHV0RWxlbWVudD4gZS50YXJnZXQpLnZhbHVlKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChpc05hTihuZXdfdmFsKSB8fCBuZXdfdmFsIDwgMSkge1xyXG4gICAgICAgICAgICAgICAgYWxlcnQoXCJJbnZhbGlkIG51bWJlciBvZiBwYWdlc1wiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5tZW1vcnkuaW5pdChuZXdfdmFsLCB0aGlzLm1lbW9yeS5udW1iZXJfb2ZfZnJhbWVzKTtcclxuICAgICAgICAgICAgdGhpcy5jbGVhckNhbGxzKCk7XHJcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaENhbGxzKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IG51bWJlcl9vZl9mcmFtZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNfZnJhbWVfY291bnRcIikgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgICAgICBudW1iZXJfb2ZfZnJhbWVzLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgKGU6IEV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld192YWwgPSBwYXJzZUludCgoPEhUTUxJbnB1dEVsZW1lbnQ+IGUudGFyZ2V0KS52YWx1ZSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoaXNOYU4obmV3X3ZhbCkgfHwgbmV3X3ZhbCA8IDEpIHtcclxuICAgICAgICAgICAgICAgIGFsZXJ0KFwiSW52YWxpZCBudW1iZXIgb2YgZnJhbWVzXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLm1lbW9yeS5pbml0KHRoaXMubWVtb3J5Lm51bWJlcl9vZl9wYWdlcywgbmV3X3ZhbCk7XHJcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaENhbGxzKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIGRpc3RyaWJ1dGlvbiBzZWxlY3RcclxuICAgICAgICAgKiAtPiBzaG93L2hpZGUgc3BlY2lmaWMgb3B0aW9uc1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGNvbnN0IGRpc3RyaWJ1dGlvbl9zZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNfZGlzdHJpYnV0aW9uXCIpIGFzIEhUTUxTZWxlY3RFbGVtZW50O1xyXG4gICAgICAgIGRpc3RyaWJ1dGlvbl9zZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCAoZTogRXZlbnQpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZGlzdHJpYnV0aW9uID0gKDxIVE1MU2VsZWN0RWxlbWVudD4gZS50YXJnZXQpLnZhbHVlLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCB3aW5kb3dfc2l6ZV9lbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY193aW5kb3dfc2l6ZV9hbGxcIikgYXMgSFRNTERpdkVsZW1lbnQ7XHJcbiAgICAgICAgICAgIGNvbnN0IHdpbmRvd19kZWx0YV9lbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY193aW5kb3dfZGVsdGFfYWxsXCIpIGFzIEhUTUxEaXZFbGVtZW50O1xyXG5cclxuICAgICAgICAgICAgc3dpdGNoIChkaXN0cmlidXRpb24pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJ1bmlmb3JtXCI6XHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93X3NpemVfZWwuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvd19kZWx0YV9lbC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwibG9jYWxpdHlcIjpcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3dfc2l6ZV9lbC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvd19kZWx0YV9lbC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBhbGVydChcIkludmFsaWQgZGlzdHJpYnV0aW9uXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIGFsZ29yaXRobSBzZWxlY3RcclxuICAgICAgICAgKiAtPiBkaXNhYmxlIHJ1bm5pbmcgd2l0aCBhbmltYXRpb24gaWYgY29tcGFyZV9hbGxcclxuICAgICAgICAgKi9cclxuICAgICAgICBjb25zdCBhbGdvcml0aG1fc2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhX3R5cGVcIikgYXMgSFRNTFNlbGVjdEVsZW1lbnQ7XHJcbiAgICAgICAgYWxnb3JpdGhtX3NlbGVjdC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIChlOiBFdmVudCkgPT5cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmICgoPEhUTUxTZWxlY3RFbGVtZW50PiBlLnRhcmdldCkudmFsdWUudG9Mb3dlckNhc2UoKSA9PT0gXCJjb21wYXJlX2FsbFwiKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAoPEhUTUxCdXR0b25FbGVtZW50PiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJ1bl93aXRoX2FuaW1hdGlvbl9idXR0b25cIikpLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIFwidHJ1ZVwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICg8SFRNTEJ1dHRvbkVsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicnVuX3dpdGhfYW5pbWF0aW9uX2J1dHRvblwiKSkucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLyogXHJcbiAgICAgICAgICogcmVzdWx0cyBidXR0b25zXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY29uc3QgcmVzdWx0c19jbG9zZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVzdWx0c19jbG9zZVwiKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcclxuICAgICAgICByZXN1bHRzX2Nsb3NlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICg8SFRNTERpdkVsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVzdWx0c193cmFwcGVyXCIpKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8qXHJcbiAgICAgICAgICogcmVmcmVzaCBjYWxscyBcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnJlZnJlc2hDYWxscygpO1xyXG4gICAgfSBcclxuXHJcbiAgICBhZGRDYWxscygpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBkaXN0cmlidXRpb24gPSAoPEhUTUxJbnB1dEVsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY19kaXN0cmlidXRpb25cIikpLnZhbHVlO1xyXG4gICAgICAgIGNvbnN0IGNhbGxfY291bnQgPSBwYXJzZUludCgoPEhUTUxJbnB1dEVsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY19jb3VudFwiKSkudmFsdWUpO1xyXG5cclxuICAgICAgICBzd2l0Y2ggKGRpc3RyaWJ1dGlvbikge1xyXG4gICAgICAgICAgICBjYXNlIFwidW5pZm9ybVwiOlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAvKiBnZW5lcmF0ZSBjYWxscyAqL1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjYWxsX2NvdW50OyBpKyspXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW1vcnkuYWRkUGFnZUNhbGxzVG9Qb29sKFtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB0aGlzLm1lbW9yeS5udW1iZXJfb2ZfcGFnZXMpXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXNlIFwibG9jYWxpdHlcIjpcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgd2luZG93X3NpemUgPSBwYXJzZUludCgoPEhUTUxJbnB1dEVsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY193aW5kb3dfc2l6ZVwiKSkudmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgd2luZG93X2RlbHRhID0gcGFyc2VJbnQoKDxIVE1MSW5wdXRFbGVtZW50PiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNfd2luZG93X2RlbHRhXCIpKS52YWx1ZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLyogdmFsaWRhdGUgaW5wdXQgKi9cclxuICAgICAgICAgICAgICAgIGlmIChpc05hTih3aW5kb3dfc2l6ZSkgfHwgaXNOYU4od2luZG93X2RlbHRhKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwiSW52YWxpZCBpbnB1dFwiKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAod2luZG93X3NpemUgPiB0aGlzLm1lbW9yeS5udW1iZXJfb2ZfcGFnZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBhbGVydChcIldpbmRvdyBzaXplIGlzIGJpZ2dlciB0aGFuIG51bWJlciBvZiBwYWdlc1wiKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAod2luZG93X2RlbHRhID4gdGhpcy5tZW1vcnkubnVtYmVyX29mX3BhZ2VzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWxlcnQoXCJXaW5kb3cgZGVsdGEgaXMgYmlnZ2VyIHRoYW4gbnVtYmVyIG9mIHBhZ2VzXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvKiBnZW5lcmF0ZSBjYWxscyAqL1xyXG4gICAgICAgICAgICAgICAgbGV0IHdpbmRvd19zdGFydCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqICh0aGlzLm1lbW9yeS5udW1iZXJfb2ZfcGFnZXMgLSB3aW5kb3dfc2l6ZSkpO1xyXG4gICAgICAgICAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IGNhbGxfY291bnQ7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhZ2VfaWQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB3aW5kb3dfc2l6ZSkgKyB3aW5kb3dfc3RhcnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZW1vcnkuYWRkUGFnZUNhbGxzVG9Qb29sKFtwYWdlX2lkXSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8qIG1vdmUgd2luZG93IGJ5IGRlbHRhIGluIHJhbmdlIFstd2luZG93X2RlbHRhLCB3aW5kb3dfZGVsdGFdICovXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVsdGEgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAod2luZG93X2RlbHRhICogMiArIDEpKSAtIHdpbmRvd19kZWx0YTtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3dfc3RhcnQgPSAod2luZG93X3N0YXJ0ICsgZGVsdGEpICUgKHRoaXMubWVtb3J5Lm51bWJlcl9vZl9wYWdlcyAtIHdpbmRvd19zaXplKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLyogYXZvaWQgMCAlIDAgKi9cclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5tZW1vcnkubnVtYmVyX29mX3BhZ2VzIC0gd2luZG93X3NpemUgPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93X3N0YXJ0ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8qIG1ha2Ugc3VyZSB3aW5kb3dfc3RhcnQgaXMgaW4gcmFuZ2UgWzAsIG51bWJlcl9vZl9wYWdlcyAtIHdpbmRvd19zaXplXSAqL1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh3aW5kb3dfc3RhcnQgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvd19zdGFydCArPSB0aGlzLm1lbW9yeS5udW1iZXJfb2ZfcGFnZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGFsZXJ0KFwiSW52YWxpZCBkaXN0cmlidXRpb25cIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucmVmcmVzaENhbGxzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xlYXJDYWxscygpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLm1lbW9yeS5jbGVhclBhZ2VDYWxsUG9vbCgpO1xyXG4gICAgICAgIHRoaXMucmVmcmVzaENhbGxzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVmcmVzaENhbGxzKCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiQ2FsbHMgaW4gcG9vbDogXCIgKyB0aGlzLm1lbW9yeS5wYWdlX2NhbGxfcG9vbC5sZW5ndGgpO1xyXG5cclxuICAgICAgICBjb25zdCBjdXJyZW50X2NvdW50X2VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwX2N1cnJlbnRfY291bnRcIikgYXMgSFRNTFBhcmFncmFwaEVsZW1lbnQ7XHJcbiAgICAgICAgY3VycmVudF9jb3VudF9lbC5pbm5lckhUTUwgPSBgKCR7dGhpcy5tZW1vcnkucGFnZV9jYWxsX3Bvb2wubGVuZ3RoLnRvU3RyaW5nKCl9KWA7XHJcblxyXG4gICAgICAgIGNvbnN0IGN1cnJlbnRfcGFnZV9jYWxsc19lbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY3VycmVudF9wYWdlX2NhbGxzX3ZhbFwiKSBhcyBIVE1MUGFyYWdyYXBoRWxlbWVudDtcclxuICAgICAgICBjdXJyZW50X3BhZ2VfY2FsbHNfZWwuaW5uZXJIVE1MID0gdGhpcy5tZW1vcnkucGFnZV9jYWxsX3Bvb2wucmVkdWNlKChhY2M6IHN0cmluZywgcGFnZV9jYWxsOiBQYWdlKSA9PiBhY2MgKyBwYWdlX2NhbGwuaWQudG9TdHJpbmcoKSArIFwiLCBcIiwgXCJcIikuc2xpY2UoMCwgLTIpO1xyXG5cclxuICAgICAgICBpZih0aGlzLm1lbW9yeS5wYWdlX2NhbGxfcG9vbC5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICBjdXJyZW50X3BhZ2VfY2FsbHNfZWwuaW5uZXJIVE1MID0gXCI8c3BhbiBzdHlsZT0nY29sb3I6IHllbGxvdyc+ZW1wdHk8L3NwYW4+XCI7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJ1bihhbmltYXRpb24/OiBib29sZWFuKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgYWxnU3RyID0gKDxIVE1MSW5wdXRFbGVtZW50PiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFfdHlwZVwiKSkudmFsdWU7XHJcbiAgICAgICAgbGV0IGNvbXBhcmVfYWxsOiBib29sZWFuID0gZmFsc2U7XHJcblxyXG4gICAgICAgIHN3aXRjaChhbGdTdHIudG9Mb3dlckNhc2UoKSkge1xyXG4gICAgICAgICAgICBjYXNlIFwiZmlmb1wiOlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1lbW9yeS5zZXRBbGdvcml0aG0obmV3IEZJRk8oKSk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXNlIFwib3B0XCI6XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubWVtb3J5LnNldEFsZ29yaXRobShuZXcgT1BUKCkpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2FzZSBcImxydVwiOlxyXG4gICAgICAgICAgICB7ICAgXHJcbiAgICAgICAgICAgICAgICB0aGlzLm1lbW9yeS5zZXRBbGdvcml0aG0obmV3IExSVSgpKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhc2UgXCJhbHJ1XCI6XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubWVtb3J5LnNldEFsZ29yaXRobShuZXcgQUxSVSgpKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhc2UgXCJyYW5kXCI6XHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubWVtb3J5LnNldEFsZ29yaXRobShuZXcgUkFORCgpKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhc2UgXCJjb21wYXJlX2FsbFwiOlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBjb21wYXJlX2FsbCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBhbGVydChcIkludmFsaWQgYWxnb3JpdGhtXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY29tcGFyZV9hbGwpIHtcclxuICAgICAgICAgICAgY29uc3QgYWxnb3JpdGhtcyA9IFtcclxuICAgICAgICAgICAgICAgIG5ldyBGSUZPKCksXHJcbiAgICAgICAgICAgICAgICBuZXcgT1BUKCksXHJcbiAgICAgICAgICAgICAgICBuZXcgTFJVKCksXHJcbiAgICAgICAgICAgICAgICBuZXcgQUxSVSgpLFxyXG4gICAgICAgICAgICAgICAgbmV3IFJBTkQoKVxyXG4gICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5tZW1vcnkuY29tcGFyZUFsbEFuZERpc3BsYXlSZXN1bHRzKGFsZ29yaXRobXMpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoYW5pbWF0aW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9uR1VJLnN0YXJ0QW5pbWF0aW9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCByZXN1bHRzID0gdGhpcy5tZW1vcnkuc2ltdWxhdGUoKTtcclxuICAgICAgICAgICAgdGhpcy5tZW1vcnkuZGlzcGxheVJlc3VsdHMocmVzdWx0cyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGFnZSB7XHJcbiAgICBpZDogbnVtYmVyXHJcbiAgICBsYXN0X2NhbGxfdGltZTogbnVtYmVyXHJcblxyXG4gICAgY29uc3RydWN0b3IoaWQ6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMuaWQgPSBpZDtcclxuICAgICAgICB0aGlzLmxhc3RfY2FsbF90aW1lID0gMDtcclxuICAgIH1cclxuXHJcbiAgICBjYWxsKHRpbWU6IG51bWJlcik6IHZvaWQge1xyXG4gICAgICAgIHRoaXMubGFzdF9jYWxsX3RpbWUgPSB0aW1lO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IFJlcGxhY2VtZW50QWxnb3JpdGhtLCB7IE1lbW9yeVN0YXRlRGF0YSB9IGZyb20gXCIuLi9SZXBsYWNlbWVudEFsZ29yaXRobVwiO1xyXG5cclxuaW1wb3J0IFBhZ2UgZnJvbSBcIi4uL1BhZ2VcIjtcclxuXHJcbi8qKlxyXG4gKiBBcHByb3hpbWF0ZSBMZWFzdCBSZWNlbnRseSBVc2VkIChBTFJVKVxyXG4gKi9cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQUxSVSBpbXBsZW1lbnRzIFJlcGxhY2VtZW50QWxnb3JpdGhtIHtcclxuICAgIG5hbWU6IHN0cmluZyA9IFwiQUxSVVwiXHJcblxyXG4gICAgYml0X2FycmF5OiBBcnJheTxib29sZWFuPiA9IFtdXHJcbiAgICBwb2ludGVyOiBudW1iZXIgPSAwXHJcblxyXG4gICAgb25QYWdlQWxyZWFkeUluTWVtb3J5KGRhdGE6IE1lbW9yeVN0YXRlRGF0YSkge1xyXG4gICAgICAgIC8qIHNldCB0aGUgXCJzZWNvbmQgY2hhbmNlXCIgYml0IHRvIDEgKi9cclxuICAgICAgICBjb25zdCBpbmRleCA9IGRhdGEuY3VycmVudF9mcmFtZXMuZmluZEluZGV4KHggPT4geC5wYWdlPy5pZCA9PSBkYXRhLnBhZ2VfY2FsbC5pZCk7XHJcblxyXG4gICAgICAgIGlmIChpbmRleCA9PSAtMSlcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQUxSVTogZmF0YWwgZXJyb3IgKGluZGV4IC0xKVwiKTtcclxuXHJcbiAgICAgICAgdGhpcy5iaXRfYXJyYXlbaW5kZXhdID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBoYW5kbGVQYWdlRmF1bHQoZGF0YTogTWVtb3J5U3RhdGVEYXRhKTogbnVtYmVyIHtcclxuICAgICAgICAvKiBtYWtlIHN1cmUgYWxsIGJpdHMgYXJlIGluaXRpYWxpemVkIHRvIDAgKGlmIHVuc2V0KSAqL1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5jdXJyZW50X2ZyYW1lcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5iaXRfYXJyYXlbaV0gPT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHRoaXMuYml0X2FycmF5W2ldID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKiBtYWtlIHN1cmUgdGhlIHBvaW50ZXIgaXMgaW4gcmFuZ2UgKi9cclxuICAgICAgICB0aGlzLnBvaW50ZXIgPSB0aGlzLnBvaW50ZXIgJSBkYXRhLmN1cnJlbnRfZnJhbWVzLmxlbmd0aDtcclxuXHJcbiAgICAgICAgLyogZmluZCB0aGUgZmlyc3QgZnJhbWUgdGhhdCBoYXMgdGhlIFwic2Vjb25kIGNoYW5jZVwiIGJpdCBzZXQgdG8gMCAqL1xyXG4gICAgICAgIHdoaWxlICh0cnVlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGZyYW1lID0gZGF0YS5jdXJyZW50X2ZyYW1lc1t0aGlzLnBvaW50ZXJdO1xyXG4gICAgICAgICAgICBpZiAoZnJhbWUucGFnZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCJGcmFtZSBpcyBlbXB0eSAtIHRoaXMgc2hvdWxkIGJlIGVuc3VyZWQgbm90IHRvIGhhcHBlbiBieSB0aGUgY2FsbGVyXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8qIHNldCB0aGUgXCJzZWNvbmQgY2hhbmNlXCIgYml0IHRvIDEgKi9cclxuICAgICAgICAgICAgICAgIHRoaXMuYml0X2FycmF5W3RoaXMucG9pbnRlcl0gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucG9pbnRlcisrO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvKiB0aGUgXCJzZWNvbmQgY2hhbmNlXCIgYml0IGlzIDAsIHNvIHdlIGNhbiByZXBsYWNlIHRoaXMgZnJhbWUgKi9cclxuICAgICAgICAgICAgaWYgKHRoaXMuYml0X2FycmF5W3RoaXMucG9pbnRlcl0gPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgIC8qIHNldCB0aGUgXCJzZWNvbmQgY2hhbmNlXCIgYml0IHRvIDEgKi9cclxuICAgICAgICAgICAgICAgIHRoaXMuYml0X2FycmF5W3RoaXMucG9pbnRlcl0gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucG9pbnRlcisrO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvKiBzZXQgdGhlIFwic2Vjb25kIGNoYW5jZVwiIGJpdCB0byAwICovXHJcbiAgICAgICAgICAgIHRoaXMuYml0X2FycmF5W3RoaXMucG9pbnRlcl0gPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIC8qIGluY3JlbWVudCB0aGUgcG9pbnRlciAqL1xyXG4gICAgICAgICAgICB0aGlzLnBvaW50ZXIgPSAodGhpcy5wb2ludGVyICsgMSkgJSBkYXRhLmN1cnJlbnRfZnJhbWVzLmxlbmd0aDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IFJlcGxhY2VtZW50QWxnb3JpdGhtLCB7IE1lbW9yeVN0YXRlRGF0YSB9IGZyb20gXCIuLi9SZXBsYWNlbWVudEFsZ29yaXRobVwiO1xyXG5cclxuLyoqXHJcbiAqIEZpcnN0IEluIEZpcnN0IE91dCAoRklGTylcclxuICovXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZJRk8gaW1wbGVtZW50cyBSZXBsYWNlbWVudEFsZ29yaXRobSB7XHJcbiAgICBuYW1lOiBzdHJpbmcgPSBcIkZJRk9cIjtcclxuXHJcbiAgICBoYW5kbGVQYWdlRmF1bHQoZGF0YTogTWVtb3J5U3RhdGVEYXRhKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gKGRhdGEubGFzdF9yZXBsYWNlZF9pbmRleCArIDEpICUgZGF0YS5jdXJyZW50X2ZyYW1lcy5sZW5ndGg7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IFJlcGxhY2VtZW50QWxnb3JpdGhtLCB7IE1lbW9yeVN0YXRlRGF0YSB9IGZyb20gXCIuLi9SZXBsYWNlbWVudEFsZ29yaXRobVwiO1xyXG5cclxuLyoqXHJcbiAqIExlYXN0IFJlY2VudGx5IFVzZWQgKExSVSlcclxuICovXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIExSVSBpbXBsZW1lbnRzIFJlcGxhY2VtZW50QWxnb3JpdGhtIHtcclxuICAgIG5hbWU6IHN0cmluZyA9IFwiTFJVXCJcclxuXHJcbiAgICBoYW5kbGVQYWdlRmF1bHQoZGF0YTogTWVtb3J5U3RhdGVEYXRhKTogbnVtYmVyIHsgXHJcbiAgICAgICAgLyogZmluZCB0aGUgcGFnZSB0aGF0IHdhcyB1c2VkIHRoZSBsb25nZXN0IGFnbyAqL1xyXG4gICAgICAgIGxldCBmcmFtZV90b19yZXBsYWNlX2luZGV4ID0gLTE7XHJcbiAgICAgICAgbGV0IGxlYXN0X3JlY2VudGx5X3VzZWRfcGFnZV9pbmRleCA9IC0xO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEuY3VycmVudF9mcmFtZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgY29uc3QgZnJhbWUgPSBkYXRhLmN1cnJlbnRfZnJhbWVzW2ldO1xyXG4gICAgICAgICAgICBpZiAoZnJhbWUucGFnZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCJGcmFtZSBpcyBlbXB0eSAtIHRoaXMgc2hvdWxkIGJlIGVuc3VyZWQgbm90IHRvIGhhcHBlbiBieSB0aGUgY2FsbGVyXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGxldCBwYWdlX2luZGV4ID0gLTE7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGogPSBkYXRhLnByZXZpb3VzX3BhZ2VfY2FsbHMubGVuZ3RoIC0gMTsgaiA+PSAwOyBqLS0pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHByZXZpb3VzX3BhZ2VfY2FsbCA9IGRhdGEucHJldmlvdXNfcGFnZV9jYWxsc1tqXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAocHJldmlvdXNfcGFnZV9jYWxsLmlkID09IGZyYW1lLnBhZ2UuaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBwYWdlX2luZGV4ID0gajtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKHBhZ2VfaW5kZXggPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIC8qIHBhZ2Ugd2FzIG5ldmVyIHVzZWQgYmVmb3JlICovXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHBhZ2VfaW5kZXggPCBsZWFzdF9yZWNlbnRseV91c2VkX3BhZ2VfaW5kZXggfHwgbGVhc3RfcmVjZW50bHlfdXNlZF9wYWdlX2luZGV4ID09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAvKiBwYWdlIHdhcyB1c2VkIGxvbmdlciBhZ28gKi9cclxuICAgICAgICAgICAgICAgIGZyYW1lX3RvX3JlcGxhY2VfaW5kZXggPSBpO1xyXG4gICAgICAgICAgICAgICAgbGVhc3RfcmVjZW50bHlfdXNlZF9wYWdlX2luZGV4ID0gcGFnZV9pbmRleDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZyYW1lX3RvX3JlcGxhY2VfaW5kZXg7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IFJlcGxhY2VtZW50QWxnb3JpdGhtLCB7IE1lbW9yeVN0YXRlRGF0YSB9IGZyb20gXCIuLi9SZXBsYWNlbWVudEFsZ29yaXRobVwiO1xyXG5cclxuLyoqXHJcbiAqIE9wdGltYWwgKE9QVClcclxuICogTm90IHBvc3NpYmxlIHRvIGltcGxlbWVudCBpbiBwcmFjdGljZSAod2l0aG91dCB0aGUga25vd2xlZGdlIG9mIHRoZSBmdXR1cmUgY2FsbHMpXHJcbiAqL1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBPUFQgaW1wbGVtZW50cyBSZXBsYWNlbWVudEFsZ29yaXRobSB7XHJcbiAgICBuYW1lOiBzdHJpbmcgPSBcIk9QVFwiXHJcblxyXG4gICAgaGFuZGxlUGFnZUZhdWx0KGRhdGE6IE1lbW9yeVN0YXRlRGF0YSk6IG51bWJlciB7XHJcbiAgICAgICAgLyogZmluZCB0aGUgcGFnZSB0aGF0IHdpbGwgYmUgdXNlZCB0aGUgZmFydGhlc3QgaW4gdGhlIGZ1dHVyZSAqL1xyXG4gICAgICAgIGxldCBmcmFtZV90b19yZXBsYWNlX2luZGV4ID0gLTE7XHJcbiAgICAgICAgbGV0IGZhcnRoZXN0X3BhZ2VfaW5kZXggPSAtMTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmN1cnJlbnRfZnJhbWVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGZyYW1lID0gZGF0YS5jdXJyZW50X2ZyYW1lc1tpXTtcclxuICAgICAgICAgICAgaWYgKGZyYW1lLnBhZ2UgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKFwiRnJhbWUgaXMgZW1wdHkgLSB0aGlzIHNob3VsZCBiZSBlbnN1cmVkIG5vdCB0byBoYXBwZW4gYnkgdGhlIGNhbGxlclwiKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBsZXQgcGFnZV9pbmRleCA9IC0xO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGRhdGEuZnV0dXJlX3BhZ2VfY2FsbHMubGVuZ3RoOyBqKyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGZ1dHVyZV9wYWdlX2NhbGwgPSBkYXRhLmZ1dHVyZV9wYWdlX2NhbGxzW2pdO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChmdXR1cmVfcGFnZV9jYWxsLmlkID09IGZyYW1lLnBhZ2UuaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBwYWdlX2luZGV4ID0gajtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKHBhZ2VfaW5kZXggPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIC8qIHBhZ2UgaXMgbm90IHVzZWQgaW4gdGhlIGZ1dHVyZSAqL1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChwYWdlX2luZGV4ID4gZmFydGhlc3RfcGFnZV9pbmRleCkge1xyXG4gICAgICAgICAgICAgICAgLyogcGFnZSBpcyB1c2VkIGZ1cnRoZXIgaW4gdGhlIGZ1dHVyZSAqL1xyXG4gICAgICAgICAgICAgICAgZnJhbWVfdG9fcmVwbGFjZV9pbmRleCA9IGk7XHJcbiAgICAgICAgICAgICAgICBmYXJ0aGVzdF9wYWdlX2luZGV4ID0gcGFnZV9pbmRleDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZyYW1lX3RvX3JlcGxhY2VfaW5kZXg7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IFJlcGxhY2VtZW50QWxnb3JpdGhtLCB7IE1lbW9yeVN0YXRlRGF0YSB9IGZyb20gXCIuLi9SZXBsYWNlbWVudEFsZ29yaXRobVwiO1xyXG5cclxuLyoqXHJcbiAqIFJhbmRvbSAoUkFORClcclxuICovXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJBTkQgaW1wbGVtZW50cyBSZXBsYWNlbWVudEFsZ29yaXRobSB7XHJcbiAgICBuYW1lOiBzdHJpbmcgPSBcIlJBTkRcIlxyXG5cclxuICAgIGhhbmRsZVBhZ2VGYXVsdChkYXRhOiBNZW1vcnlTdGF0ZURhdGEpOiBudW1iZXIge1xyXG4gICAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBkYXRhLmN1cnJlbnRfZnJhbWVzLmxlbmd0aCk7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IE1lbnUgZnJvbSBcIi4vY2xhc3Nlcy9NZW51XCI7XHJcblxyXG5pbXBvcnQgTU1VIGZyb20gXCIuL2NsYXNzZXMvTU1VXCI7XHJcbmltcG9ydCBQYWdlIGZyb20gXCIuL2NsYXNzZXMvUGFnZVwiO1xyXG5cclxuaW1wb3J0IEZJRk8gZnJvbSBcIi4vY2xhc3Nlcy9hbGdvcml0aG1zL0ZJRk9cIjtcclxuaW1wb3J0IE9QVCBmcm9tIFwiLi9jbGFzc2VzL2FsZ29yaXRobXMvT1BUXCI7XHJcbmltcG9ydCBMUlUgZnJvbSBcIi4vY2xhc3Nlcy9hbGdvcml0aG1zL0xSVVwiO1xyXG5pbXBvcnQgQUxSVSBmcm9tIFwiLi9jbGFzc2VzL2FsZ29yaXRobXMvQUxSVVwiO1xyXG5pbXBvcnQgUkFORCBmcm9tIFwiLi9jbGFzc2VzL2FsZ29yaXRobXMvUkFORFwiO1xyXG5cclxuZnVuY3Rpb24gbWFpbigpIHtcclxuICAgIGlmICh0eXBlb2YgZG9jdW1lbnQgIT09IFwidW5kZWZpbmVkXCIpIHtcclxuICAgICAgICBjb25zdCBtZW51ID0gbmV3IE1lbnUoKTtcclxuICAgICAgICBtZW51LmluaXQoKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIC8qXHJcbiAgICAgICAgKiBydW4gd2l0aDogdHNjICYmIG5vZGUgLlxcZGlzdFxccGFnZV9yZXBsYWNlbWVudF9zcmNcXG1haW4uanNcclxuICAgICAgICAqL1xyXG5cclxuICAgICAgICBjb25zdCBtZW1vcnkgPSBuZXcgTU1VKCk7XHJcbiAgICAgICAgbWVtb3J5LmluaXQoNSwgMyk7XHJcbiAgICAgICAgbWVtb3J5LmFkZFBhZ2VDYWxsc1RvUG9vbChbMSwgMiwgMywgNCwgMSwgMiwgNSwgMSwgMiwgMywgNCwgNV0pO1xyXG4gICAgICAgIG1lbW9yeS5zZXRBbGdvcml0aG0obmV3IEFMUlUoKSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgd2hpbGUgKG1lbW9yeS5wYWdlX2NhbGxfcXVldWUubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBtZW1vcnkubmV4dFRpY2soKTtcclxuICAgICAgICAgICAgbWVtb3J5LnByaW50RnJhbWVzKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zb2xlLmxvZyhcIlRvdGFsIHBhZ2UgZmF1bHRzOiBcIiArIG1lbW9yeS50b3RhbF9wYWdlX2ZhdWx0cyk7XHJcbiAgICB9XHJcbn1cclxuXHJcbm1haW4oKTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRGlzcGxheSB7XHJcbiAgICBjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCB8IG51bGwgPSBudWxsXHJcbiAgICByZXNpemVDYWxsYmFjazogKCgpID0+IHZvaWQpIHwgbnVsbFxyXG5cclxuICAgIGNvbnN0cnVjdG9yKCl7XHJcbiAgICAgICAgdGhpcy5yZXNpemVDYWxsYmFjayA9IG51bGw7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGluaXQoZWxlbV9pZDogc3RyaW5nKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZWxlbV9pZCkgYXMgSFRNTENhbnZhc0VsZW1lbnQ7XHJcbiAgICAgICAgdGhpcy5jdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKSBhcyBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQ7XHJcblxyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIHRoaXMucmVzaXplVG9GaXQuYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgIHRoaXMucmVzaXplVG9GaXQoKTtcclxuICAgIH1cclxuXHJcbiAgICByZXNpemVUb0ZpdCgpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5jdHggPT0gbnVsbCl7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuY3R4LmNhbnZhcy53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xyXG4gICAgICAgIHRoaXMuY3R4LmNhbnZhcy5oZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLnJlc2l6ZUNhbGxiYWNrICE9IG51bGwpe1xyXG4gICAgICAgICAgICB0aGlzLnJlc2l6ZUNhbGxiYWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNldFJlc2l6ZUNhbGxiYWNrKGNhbGxiYWNrOiAoKSA9PiB2b2lkKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5yZXNpemVDYWxsYmFjayA9IGNhbGxiYWNrO1xyXG4gICAgfVxyXG59IiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLy8gVGhpcyBlbnRyeSBtb2R1bGUgaXMgcmVmZXJlbmNlZCBieSBvdGhlciBtb2R1bGVzIHNvIGl0IGNhbid0IGJlIGlubGluZWRcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXyg5NjUpO1xuIl0sIm5hbWVzIjpbImNvbnN0cnVjdG9yIiwibWVudSIsInZpc2libGUiLCJwbGF5aW5nIiwic3BlZWQiLCJHVUkiLCJNRU5VIiwicGxheV9wYXVzZV9idXR0b24iLCJzdGVwX2J1dHRvbiIsInN0b3BfYnV0dG9uIiwic3BlZWRfc2xpZGVyIiwiaW5mb19hbGdvcml0aG0iLCJpbmZvX3RpbWUiLCJpbmZvX2lzX2RvbmUiLCJpbmZvX2luX3F1ZXVlIiwiaW5mb19maW5pc2hlZCIsImluZm9fdG90YWxfcGFnZV9mYXVsdHMiLCJpbmZvX3RvdGFsX3BhZ2VfaGl0cyIsImZyYW1lX3Jvd3MiLCJzZWVfY29kZV9idXR0b24iLCJzdG9yZWRTZXRJbnRlcnZhbCIsInRoaXMiLCJpbml0IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInN0eWxlIiwiZGlzcGxheSIsImFkZEV2ZW50TGlzdGVuZXIiLCJ0b2dnbGVQbGF5aW5nIiwic3RlcCIsInRvZ2dsZVZpc2libGUiLCJwYXJzZUludCIsInZhbHVlIiwicmVmcmVzaFNwZWVkIiwibWVtb3J5IiwiYWxnb3JpdGhtIiwiYWxnb3JpdGhtTmFtZSIsIm5hbWUiLCJ3aW5kb3ciLCJvcGVuIiwiZm9jdXMiLCJpbml0U3RhdGVUYWJsZSIsImlubmVySFRNTCIsInJlc2l6ZUNhbGxiYWNrIiwiZHJhd0N1cnJlbnRTdGF0ZSIsImNsZWFySW50ZXJ2YWwiLCJyZWZyZXNoQ2FsbHMiLCJyZXNldCIsIkVycm9yIiwiZGlzYWJsZWQiLCJzdGFydEFuaW1hdGlvbiIsInJlZnJlc2hJbmZvIiwiZHJhd0NhbGxzIiwidGltZV9yb3ciLCJjYWxsc19yb3ciLCJ0Ym9keSIsInRpbWVfcm93X2hlYWRlciIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJhcHBlbmRDaGlsZCIsImNhbGxzX3Jvd19oZWFkZXIiLCJsYXN0Q2hpbGQiLCJpZCIsInJlbW92ZUNoaWxkIiwiaSIsIm51bWJlcl9vZl9mcmFtZXMiLCJmcmFtZV9yb3ciLCJmcmFtZV9yb3dfaGVhZGVyIiwicHVzaCIsIlNUQVJUX1giLCJTVEFSVF9ZIiwiV0lEVEgiLCJIRUlHSFQiLCJjYWxsc1RvRHJhdyIsIm5ld0NhbGwiLCJwcmV2aW91c19wYWdlX2NhbGxzIiwiYXQiLCJ0aW1lVGlja0VsIiwidGltZSIsImNhbGxzVGlja0VsIiwicGFnZSIsImZyYW1lcyIsImZyYW1lVGlja0VsIiwibGFzdF9jYWxsX2NhdXNlZF9mYXVsdCIsImJhY2tncm91bmRDb2xvciIsInRhYmxlIiwic2Nyb2xsTGVmdCIsInNjcm9sbFdpZHRoIiwidG9TdHJpbmciLCJpc0ZpbmlzaGVkIiwibGVuZ3RoIiwidG90YWxfcGFnZV9mYXVsdHMiLCJwYWdlX2NhbGxfcXVldWUiLCJzZXRJbnRlcnZhbCIsImJpbmQiLCJuZXh0VGljayIsImRpc3BsYXlSZXN1bHRzIiwiZ2V0UmVzdWx0cyIsImFmdGVyRG9uZSIsIm51bWJlcl9vZl9wYWdlcyIsInBhZ2VfY2FsbF9wb29sIiwibGFzdF9yZXBsYWNlZF9pbmRleCIsImFkZFBhZ2VDYWxsVG9Qb29sIiwicGFnZV9jYWxsIiwiYWRkUGFnZUNhbGxzVG9Qb29sIiwicGFnZV9jYWxscyIsImNsZWFyUGFnZUNhbGxQb29sIiwic2V0QWxnb3JpdGhtIiwic2hpZnQiLCJjb25zb2xlIiwid2FybiIsImxvZyIsIm9uUGFnZUNhbGwiLCJnZXRDdXJyZW50U3RhdGVEYXRhIiwicGFnZV9mYXVsdCIsIm9uUGFnZUFscmVhZHlJbk1lbW9yeSIsImZpbmQiLCJmcmFtZSIsImluZGV4X3RvX3JlcGxhY2UiLCJoYW5kbGVQYWdlRmF1bHQiLCJwYWdlX2luX21lbW9yeSIsImNhbGwiLCJjdXJyZW50X2ZyYW1lcyIsImZ1dHVyZV9wYWdlX2NhbGxzIiwic2ltdWxhdGUiLCJ0b3RhbF9wYWdlX2hpdHMiLCJ0b3RhbF9wYWdlX2NhbGxzIiwicHJpbnRGcmFtZXMiLCJyZXN1bHRzIiwiYWxnU3RyIiwidG9VcHBlckNhc2UiLCJ0b0ZpeGVkIiwicmVwbGFjZSIsIlJlZ0V4cCIsImNvbXBhcmVBbGxBbmREaXNwbGF5UmVzdWx0cyIsImFsZ29yaXRobXMiLCJyZXN1bHRzX2VsIiwiYW5pbWF0aW9uR1VJIiwicnVuIiwiYWRkQ2FsbHMiLCJjbGVhckNhbGxzIiwic2V0UmVzaXplQ2FsbGJhY2siLCJlIiwibmV3X3ZhbCIsInRhcmdldCIsImlzTmFOIiwiYWxlcnQiLCJkaXN0cmlidXRpb24iLCJ0b0xvd2VyQ2FzZSIsIndpbmRvd19zaXplX2VsIiwid2luZG93X2RlbHRhX2VsIiwic2V0QXR0cmlidXRlIiwicmVtb3ZlQXR0cmlidXRlIiwiY2FsbF9jb3VudCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsIndpbmRvd19zaXplIiwid2luZG93X2RlbHRhIiwid2luZG93X3N0YXJ0IiwicGFnZV9pZCIsImN1cnJlbnRfcGFnZV9jYWxsc19lbCIsInJlZHVjZSIsImFjYyIsInNsaWNlIiwiYW5pbWF0aW9uIiwiY29tcGFyZV9hbGwiLCJsYXN0X2NhbGxfdGltZSIsImJpdF9hcnJheSIsInBvaW50ZXIiLCJkYXRhIiwiaW5kZXgiLCJmaW5kSW5kZXgiLCJ4IiwiZnJhbWVfdG9fcmVwbGFjZV9pbmRleCIsImxlYXN0X3JlY2VudGx5X3VzZWRfcGFnZV9pbmRleCIsInBhZ2VfaW5kZXgiLCJqIiwiZmFydGhlc3RfcGFnZV9pbmRleCIsIm1haW4iLCJjdHgiLCJlbGVtX2lkIiwiY2FudmFzIiwiZ2V0Q29udGV4dCIsInJlc2l6ZVRvRml0Iiwid2lkdGgiLCJpbm5lcldpZHRoIiwiaGVpZ2h0IiwiaW5uZXJIZWlnaHQiLCJjYWxsYmFjayIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsInVuZGVmaW5lZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIl0sInNvdXJjZVJvb3QiOiIifQ==