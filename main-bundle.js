(()=>{"use strict";var e={258:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.resizeCallback=null}init(e){const t=document.getElementById(e);this.ctx=t.getContext("2d"),window.addEventListener("resize",this.resizeToFit.bind(this)),this.resizeToFit()}resizeToFit(){this.ctx.canvas.width=window.innerWidth,this.ctx.canvas.height=window.innerHeight,null!=this.resizeCallback&&this.resizeCallback()}setResizeCallback(e){this.resizeCallback=e}}},268:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(258)),l=i(s(950)),r=i(s(822)),o=i(s(76)),a=i(s(20)),u=i(s(711)),c=i(s(106));t.default=class{constructor(){this.scheduler=new r.default,this.display=new n.default,this.scheduler.initAutoPlay(this.display)}init(){document.getElementById("run_button").addEventListener("click",(()=>{this.run()})),document.getElementById("run_with_animation_button").addEventListener("click",(()=>{this.run(!0)})),document.getElementById("add_button").addEventListener("click",(()=>{this.addProcesses()})),document.getElementById("clear_button").addEventListener("click",(()=>{this.clearProcesses()})),document.getElementById("a_type").addEventListener("change",(e=>{"rr"===e.target.value.toLowerCase()?document.getElementById("a_time_quanta_all").style.display="block":document.getElementById("a_time_quanta_all").style.display="none","compare all"===e.target.value.toLowerCase()?document.getElementById("run_with_animation_button").disabled=!0:document.getElementById("run_with_animation_button").disabled=!1})),this.display.init("main_canvas"),this.display.setResizeCallback((()=>{this.refreshProcesses()})),document.getElementById("results_close").addEventListener("click",(()=>{document.getElementById("results_wrapper").style.display="none"}));const e=document.getElementById("animation_play_pause"),t=document.getElementById("animation_stop");document.getElementById("animation_step").addEventListener("click",(()=>{if(this.scheduler.nextTick(),this.scheduler.refreshAnimation(this.display),this.scheduler.isFinished())return this.scheduler.displayResults(),void this.scheduler.afterDone()})),e.addEventListener("click",(()=>{this.scheduler._paused?(this.scheduler.resumeAnimation(),e.innerHTML="Pause"):(this.scheduler.pauseAnimation(),e.innerHTML="Play")})),t.addEventListener("click",(()=>{document.getElementById("settings").style.display="flex",document.getElementById("results_wrapper").style.display="none",document.getElementById("animation_gui").style.display="none",this.display.ctx.clearRect(0,0,this.display.ctx.canvas.width,this.display.ctx.canvas.height),this.scheduler.reset(),document.getElementById("animation_play_pause").innerHTML="Play",this.refreshProcesses(),this.display.setResizeCallback((()=>{this.refreshProcesses()}))})),document.getElementById("animation_speed_slider").addEventListener("input",(e=>{this.scheduler.setAnimationSpeed(parseInt(e.target.value))}))}addProcesses(){const e=parseInt(document.getElementById("p_count").value),t=parseInt(document.getElementById("p_max_run_time").value),s=parseInt(document.getElementById("p_max_arrival_time").value);if(isNaN(e)||isNaN(t)||isNaN(s))alert("Invalid input");else{for(let i=0;i<e;i++){const e=Math.floor(Math.random()*s),i=Math.floor(Math.random()*t)+1;this.scheduler.addProcessToPool(new l.default(e,i))}this.refreshProcesses()}}clearProcesses(){this.scheduler.process_pool=[],this.refreshProcesses()}refreshProcesses(){document.getElementById("p_current_count").innerHTML=`(${this.scheduler.process_pool.length.toString()})`,this.display.ctx.clearRect(0,0,this.display.ctx.canvas.width,this.display.ctx.canvas.height);const e=this.display.ctx.canvas.width/2;let t=e,s=50,i=1,n=this.scheduler.process_pool.reduce(((e,t)=>e+t.run_time),0);for(;10*n*i>this.display.ctx.canvas.width/2*(this.display.ctx.canvas.height/50)*.95;)i*=.5;for(const n of this.scheduler.process_pool){let l=10*n.run_time*i;t+l>this.display.ctx.canvas.width&&(t=e,s+=50),this.display.ctx.fillStyle="black",this.display.ctx.strokeStyle="white",this.display.ctx.fillRect(t,s,l,50),this.display.ctx.strokeRect(t,s,l,50),l>10&&(this.display.ctx.fillStyle="white",this.display.ctx.font="10px Consolas",this.display.ctx.textAlign="center",this.display.ctx.fillText(n.run_time.toString(),t+l/2,s+40)),t+=l}}run(e=!1){if(0===this.scheduler.process_pool.length)return void alert("No processes to run");const t=document.getElementById("a_type").value;let s=!1;switch(t.toLowerCase()){case"fcfs":this.scheduler.setAlgorithm(new o.default);break;case"sjf":this.scheduler.setAlgorithm(new u.default);break;case"srtf":this.scheduler.setAlgorithm(new c.default);break;case"rr":const e=parseInt(document.getElementById("a_time_quanta").value);if(isNaN(e))return void alert("Invalid input");this.scheduler.setAlgorithm(new a.default(e));break;case"compare all":s=!0;break;default:return void console.log("Invalid algorithm")}if(e&&!s)document.getElementById("settings").style.display="none",document.getElementById("results_wrapper").style.display="none",document.getElementById("animation_gui").style.display="block",this.display.ctx.clearRect(0,0,this.display.ctx.canvas.width,this.display.ctx.canvas.height),this.scheduler.refreshAnimation(this.display),this.display.resizeCallback=()=>{this.scheduler.refreshAnimation(this.display)};else{if(s)return void this.scheduler.compareAllAndDisplayResults();const e=this.scheduler.simulate();this.scheduler.displayResults(t,e)}}}},950:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(498));class l{constructor(e,t){this.id=l.incremented_id,l.incremented_id++,this.start_time=e,this.run_time=t,this.time_left=t,this.wait_time=0,this.visual=new n.default(this)}run(){return this.time_left-=1,this.time_left<=0}getCopy(){const e=new l(this.start_time,this.run_time);return e.id=this.id,e.time_left=this.time_left,e.wait_time=this.wait_time,e}}t.default=l,l.incremented_id=0},822:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(76)),l=i(s(711)),r=i(s(106)),o=i(s(20));t.default=class{constructor(){this.process_pool=[],this.process_queue=[],this.finished_processes=[],this.time=0,this.previousActiveProcess=null,this._paused=!0,this._speed=1,this._interval=null,this._display=null}setAlgorithm(e){this.algorithm=e}reset(){this.process_queue=[],this.finished_processes=[],this.previousActiveProcess=null,this.time=0,this.pauseAnimation()}addProcessToPool(e){this.process_pool.push(e)}nextTick(){for(const e of this.process_pool)e.start_time==this.time&&this.process_queue.push(e.getCopy());if(this.process_queue.length>0){this.process_queue=this.algorithm.preprocess(this.process_queue);for(const e of this.process_queue)e.wait_time++;let e=this.algorithm.pickNext(this.process_queue,this.previousActiveProcess);e.run()&&(this.finished_processes.push(e),this.process_queue.splice(this.process_queue.indexOf(e),1)),this.previousActiveProcess=e}this.time++}isFinished(){return this.process_pool.length==this.finished_processes.length}getResults(){let e=0;for(const t of this.finished_processes)e+=t.wait_time;return e/=this.finished_processes.length,{avgWaitTime:e,maxTime:Math.max(...this.finished_processes.map((e=>e.wait_time)))}}simulate(){for(;!this.isFinished();)this.nextTick();const e=this.getResults();return this.reset(),e}compareAllAndDisplayResults(){this.setAlgorithm(new n.default);const e=this.simulate();this.reset(),this.setAlgorithm(new l.default);const t=this.simulate();this.reset(),this.setAlgorithm(new r.default);const s=this.simulate();this.reset(),this.setAlgorithm(new o.default(1));const i=this.simulate();this.reset(),this.setAlgorithm(new o.default(3));const a=this.simulate();this.reset();let u=`(average wait time)\n\n        FCFS:   ${e.avgWaitTime.toFixed(2)}\n        SJF:    ${t.avgWaitTime.toFixed(2)}\n        SRTF:   ${s.avgWaitTime.toFixed(2)}\n        RR (1):  ${i.avgWaitTime.toFixed(2)}\n        RR (3):  ${a.avgWaitTime.toFixed(2)}`;u=u.replace(RegExp("\n","g"),"<br>"),document.getElementById("results_wrapper").style.display="flex",document.getElementById("results").innerHTML=u}initAutoPlay(e){this._display=e,null!=this._interval&&clearInterval(this._interval),this._interval=setInterval((()=>{this._paused||(this.nextTick(),this.refreshAnimation(e),this.isFinished()&&(this.pauseAnimation(),this.displayResults(this.algorithm.name),this.afterDone()))}).bind(this),1e3/this._speed)}refreshAnimation(e){this.isFinished()||(document.getElementById("animation_play_pause").disabled=!1,document.getElementById("animation_step").disabled=!1,document.getElementById("animation_is_done").style.display="none");const t=e.ctx,s=e.ctx.canvas.width,i=e.ctx.canvas.height;let n=150;for(const e of this.process_queue){const t=10*e.time_left;e.visual.setPos(n,i/3*2-50,t),n+=t+20}null!=this.previousActiveProcess&&(this.previousActiveProcess.visual.color="#ff0000");for(const e of this.process_queue)e!=this.previousActiveProcess&&(e.visual.color="#ffffff");t.clearRect(0,0,s,i),t.fillStyle="white",t.fillRect(0,i/3*2,s,1),t.strokeStyle="white",t.strokeRect(50,i/3*2-100,50,100),t.font="15px Roboto",t.textAlign="center",t.fillText("Î¼P",75,i/3*2-50);for(const e of this.process_queue)e.visual.x+e.visual.width<s-s/4&&e.visual.draw(t);if(this.process_queue.length>0){const e=this.process_queue[this.process_queue.length-1];e.visual.x+e.visual.width>s-s/4&&(t.font="30px Roboto",t.fillStyle="white",t.fillText("... + "+(this.process_queue.length-1)+" more",s-s/8,i/3*2-50+25))}document.getElementById("animation_info_algorithm_value").innerHTML=this.algorithm.name,document.getElementById("animation_info_time_value").innerHTML=this.time.toString();const l=this.process_pool.length-(this.process_queue.length+this.finished_processes.length),r=document.getElementById("processes_info_left_to_join_value");r.innerHTML=l.toString(),r.style.color=l>0?"yellow":"white",document.getElementById("processes_info_finished_value").innerHTML=this.finished_processes.length.toString()}displayResults(e=this.algorithm.name,t=null){null==t&&(t=this.getResults()),document.getElementById("results_wrapper").style.display="flex",document.getElementById("results").innerHTML=`\n        Algorithm: ${e.toUpperCase()} ${"rr"===e.toLowerCase()?`(${document.getElementById("a_time_quanta").value})`:""}\n\n        Average waiting time: ${t.avgWaitTime.toFixed(2)}\n\n        Maximum waiting time: ${t.maxTime.toFixed(2)}\n        `.replace(RegExp("\n","g"),"<br />")}resumeAnimation(){this._paused=!1}pauseAnimation(){this._paused=!0}setAnimationSpeed(e){this._speed=e,this.initAutoPlay(this._display)}afterDone(){document.getElementById("animation_is_done").style.display="block",document.getElementById("animation_play_pause").disabled=!0,document.getElementById("animation_step").disabled=!0}}},498:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e){this.process=e,this.height=50,this.color=this.process.start_time>0?"#ff0000":"#00ff00"}setPos(e,t,s=50){this.x=e,this.y=t,this.width=s}draw(e){e.fillStyle=this.color,e.fillRect(this.x,this.y,this.width,this.height)}}},76:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.name="FCFS"}preprocess(e){return e}pickNext(e,t){return e[0]}}},20:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e){this.name="RR",this.quantum=e}preprocess(e){return e}pickNext(e,t){if(null==t){const t=e[0];return this.current_processIndex=0,this.current_quantum=this.quantum,this.current_quantum--,t}return t.time_left>0&&this.current_quantum>0?(this.current_quantum--,t):t.time_left>0&&this.current_quantum<=0?(this.current_processIndex=(this.current_processIndex+1)%e.length,this.current_quantum=this.quantum,this.current_quantum--,e[this.current_processIndex]):0==t.time_left?(this.current_quantum=this.quantum,this.current_quantum--,this.current_processIndex>=e.length&&(this.current_processIndex=0),e[this.current_processIndex]):void 0}}},711:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.name="SJF"}preprocess(e){return e.sort(((e,t)=>e.run_time-t.run_time))}pickNext(e,t){return null!=t&&t.time_left>0?t:e[0]}}},106:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.name="SRTF"}preprocess(e){return e.sort(((e,t)=>e.time_left-t.time_left))}pickNext(e,t){return e[0]}}},965:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(268)),l=i(s(950)),r=i(s(822)),o=i(s(20));!function(){if("undefined"!=typeof document){const e=new n.default;e.init(),e.scheduler.addProcessToPool(new l.default(0,2)),e.scheduler.addProcessToPool(new l.default(0,5)),e.scheduler.addProcessToPool(new l.default(0,3)),e.refreshProcesses()}else{const e=new r.default;e.addProcessToPool(new l.default(0,2)),e.addProcessToPool(new l.default(0,1)),e.addProcessToPool(new l.default(0,3)),e.setAlgorithm(new o.default(1)),console.log(e.simulate())}}()}},t={};!function s(i){var n=t[i];if(void 0!==n)return n.exports;var l=t[i]={exports:{}};return e[i].call(l.exports,l,l.exports,s),l.exports}(965)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixJQUFJLFVBQVEsRUFBRyxJQUUxQ3ZDLEVBQVU4RCxhQUFhLElBQUksVUFBRyxJQUU5QkUsUUFBUUMsSUFBSWpFLEVBQVVvRSxXLENBRTlCLENBRUE0RCxFLEdDdkNJQyxFQUEyQixDQUFDLEdBR2hDLFNBQVNDLEVBQW9CQyxHQUU1QixJQUFJQyxFQUFlSCxFQUF5QkUsR0FDNUMsUUFBcUJFLElBQWpCRCxFQUNILE9BQU9BLEVBQWFFLFFBR3JCLElBQUlDLEVBQVNOLEVBQXlCRSxHQUFZLENBR2pERyxRQUFTLENBQUMsR0FPWCxPQUhBRSxFQUFvQkwsR0FBVU0sS0FBS0YsRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0osR0FHcEVLLEVBQU9ELE9BQ2YsQ0NuQjBCSixDQUFvQixJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vY2xhc3Nlcy9EaXNwbGF5LnRzIiwid2VicGFjazovLy8uL2NsYXNzZXMvTWVudS50cyIsIndlYnBhY2s6Ly8vLi9jbGFzc2VzL1Byb2Nlc3MudHMiLCJ3ZWJwYWNrOi8vLy4vY2xhc3Nlcy9TY2hlZHVsZXIudHMiLCJ3ZWJwYWNrOi8vLy4vY2xhc3Nlcy9WaXN1YWxQcm9jZXNzLnRzIiwid2VicGFjazovLy8uL2NsYXNzZXMvYWxnb3JpdGhtcy9GQ0ZTLnRzIiwid2VicGFjazovLy8uL2NsYXNzZXMvYWxnb3JpdGhtcy9SUi50cyIsIndlYnBhY2s6Ly8vLi9jbGFzc2VzL2FsZ29yaXRobXMvU0pGLnRzIiwid2VicGFjazovLy8uL2NsYXNzZXMvYWxnb3JpdGhtcy9TUlRGLnRzIiwid2VicGFjazovLy8uL21haW4udHMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovLy93ZWJwYWNrL3N0YXJ0dXAiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRGlzcGxheSB7XG4gICAgY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkRcbiAgICByZXNpemVDYWxsYmFjazogKCkgPT4gdm9pZFxuXG4gICAgY29uc3RydWN0b3IoKXtcbiAgICAgICAgdGhpcy5yZXNpemVDYWxsYmFjayA9IG51bGw7XG4gICAgfVxuICAgIFxuICAgIGluaXQoZWxlbV9pZDogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGNhbnZhcyA9IDxIVE1MQ2FudmFzRWxlbWVudD4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZWxlbV9pZCk7XG4gICAgICAgIHRoaXMuY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG5cbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgdGhpcy5yZXNpemVUb0ZpdC5iaW5kKHRoaXMpKTtcblxuICAgICAgICB0aGlzLnJlc2l6ZVRvRml0KCk7XG4gICAgfVxuXG4gICAgcmVzaXplVG9GaXQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY3R4LmNhbnZhcy53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xuICAgICAgICB0aGlzLmN0eC5jYW52YXMuaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xuXG4gICAgICAgIGlmICh0aGlzLnJlc2l6ZUNhbGxiYWNrICE9IG51bGwpe1xuICAgICAgICAgICAgdGhpcy5yZXNpemVDYWxsYmFjaygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgc2V0UmVzaXplQ2FsbGJhY2soY2FsbGJhY2s6ICgpID0+IHZvaWQpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5yZXNpemVDYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgIH1cbn0iLCJpbXBvcnQgRGlzcGxheSBmcm9tIFwiLi9EaXNwbGF5XCI7XG5cbmltcG9ydCBQcm9jZXNzIGZyb20gXCIuL1Byb2Nlc3NcIjtcbmltcG9ydCBTY2hlZHVsZXIgZnJvbSBcIi4vU2NoZWR1bGVyXCI7XG5cbmltcG9ydCBGQ0ZTIGZyb20gXCIuL2FsZ29yaXRobXMvRkNGU1wiO1xuaW1wb3J0IFJSIGZyb20gXCIuL2FsZ29yaXRobXMvUlJcIjtcbmltcG9ydCBTSkYgZnJvbSBcIi4vYWxnb3JpdGhtcy9TSkZcIjtcbmltcG9ydCBTUlRGIGZyb20gXCIuL2FsZ29yaXRobXMvU1JURlwiO1xuXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1lbnUge1xuICAgIHNjaGVkdWxlcjogU2NoZWR1bGVyXG4gICAgZGlzcGxheTogRGlzcGxheVxuXG4gICAgY29uc3RydWN0b3IoKXtcbiAgICAgICAgdGhpcy5zY2hlZHVsZXIgPSBuZXcgU2NoZWR1bGVyKCk7XG4gICAgICAgIHRoaXMuZGlzcGxheSA9IG5ldyBEaXNwbGF5KCk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLnNjaGVkdWxlci5pbml0QXV0b1BsYXkodGhpcy5kaXNwbGF5KTtcbiAgICB9XG5cbiAgICBpbml0KCk6IHZvaWQge1xuICAgICAgICBjb25zdCBydW5fYnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJydW5fYnV0dG9uXCIpO1xuICAgICAgICBydW5fYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7IHRoaXMucnVuKCkgfSk7XG5cbiAgICAgICAgY29uc3QgcnVuX3dpdGhfYW5pbWF0aW9uX2J1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicnVuX3dpdGhfYW5pbWF0aW9uX2J1dHRvblwiKTtcbiAgICAgICAgcnVuX3dpdGhfYW5pbWF0aW9uX2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4geyB0aGlzLnJ1bih0cnVlKSB9KTtcblxuICAgICAgICBjb25zdCBhZGRfYnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhZGRfYnV0dG9uXCIpO1xuICAgICAgICBhZGRfYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7IHRoaXMuYWRkUHJvY2Vzc2VzKCkgfSk7XG5cbiAgICAgICAgY29uc3QgY2xlYXJfYnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjbGVhcl9idXR0b25cIik7XG4gICAgICAgIGNsZWFyX2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4geyB0aGlzLmNsZWFyUHJvY2Vzc2VzKCkgfSk7XG5cbiAgICAgICAgY29uc3QgYWxnb3JpdGhtX3NlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYV90eXBlXCIpO1xuICAgICAgICBhbGdvcml0aG1fc2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgKGU6IEV2ZW50KSA9PiBcbiAgICAgICAgeyBcbiAgICAgICAgICAgIGlmICgoPEhUTUxTZWxlY3RFbGVtZW50PiBlLnRhcmdldCkudmFsdWUudG9Mb3dlckNhc2UoKSA9PT0gXCJyclwiKVxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYV90aW1lX3F1YW50YV9hbGxcIikuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFfdGltZV9xdWFudGFfYWxsXCIpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblxuICAgICAgICAgICAgaWYgKCg8SFRNTFNlbGVjdEVsZW1lbnQ+IGUudGFyZ2V0KS52YWx1ZS50b0xvd2VyQ2FzZSgpID09PSBcImNvbXBhcmUgYWxsXCIpXG4gICAgICAgICAgICAgICAgKDxIVE1MQnV0dG9uRWxlbWVudD4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJydW5fd2l0aF9hbmltYXRpb25fYnV0dG9uXCIpKS5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgKDxIVE1MQnV0dG9uRWxlbWVudD4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJydW5fd2l0aF9hbmltYXRpb25fYnV0dG9uXCIpKS5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmRpc3BsYXkuaW5pdChcIm1haW5fY2FudmFzXCIpO1xuICAgICAgICB0aGlzLmRpc3BsYXkuc2V0UmVzaXplQ2FsbGJhY2soKCkgPT4geyB0aGlzLnJlZnJlc2hQcm9jZXNzZXMoKSB9KTtcblxuICAgICAgICAvKiByZXN1bHRzIGJ1dHRvbnMgKi9cblxuICAgICAgICBjb25zdCByZXN1bHRzX2Nsb3NlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZXN1bHRzX2Nsb3NlXCIpO1xuICAgICAgICByZXN1bHRzX2Nsb3NlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJlc3VsdHNfd3JhcHBlclwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8qIGFuaW1hdGlvbiBidXR0b25zICovXG4gICAgICAgIFxuICAgICAgICBjb25zdCBwbGF5X3BhdXNlX2J1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYW5pbWF0aW9uX3BsYXlfcGF1c2VcIik7XG4gICAgICAgIGNvbnN0IHN0b3BfYnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbmltYXRpb25fc3RvcFwiKTtcbiAgICAgICAgY29uc3Qgc3RlcF9idXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFuaW1hdGlvbl9zdGVwXCIpO1xuXG4gICAgICAgIHN0ZXBfYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlci5uZXh0VGljaygpO1xuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZXIucmVmcmVzaEFuaW1hdGlvbih0aGlzLmRpc3BsYXkpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5zY2hlZHVsZXIuaXNGaW5pc2hlZCgpKXtcbiAgICAgICAgICAgICAgICB0aGlzLnNjaGVkdWxlci5kaXNwbGF5UmVzdWx0cygpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVyLmFmdGVyRG9uZSgpO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBwbGF5X3BhdXNlX2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuc2NoZWR1bGVyLl9wYXVzZWQpe1xuICAgICAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVyLnJlc3VtZUFuaW1hdGlvbigpO1xuICAgICAgICAgICAgICAgIHBsYXlfcGF1c2VfYnV0dG9uLmlubmVySFRNTCA9IFwiUGF1c2VcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZXIucGF1c2VBbmltYXRpb24oKTtcbiAgICAgICAgICAgICAgICBwbGF5X3BhdXNlX2J1dHRvbi5pbm5lckhUTUwgPSBcIlBsYXlcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgc3RvcF9idXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgICAgIC8vIGdvIGJhY2sgdG8gbWVudVxuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZXR0aW5nc1wiKS5zdHlsZS5kaXNwbGF5ID0gXCJmbGV4XCI7XG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJlc3VsdHNfd3JhcHBlclwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFuaW1hdGlvbl9ndWlcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuXG4gICAgICAgICAgICAvLyBjbGVhciB0aGUgY2FudmFzXG4gICAgICAgICAgICB0aGlzLmRpc3BsYXkuY3R4LmNsZWFyUmVjdCgwLCAwLCB0aGlzLmRpc3BsYXkuY3R4LmNhbnZhcy53aWR0aCwgdGhpcy5kaXNwbGF5LmN0eC5jYW52YXMuaGVpZ2h0KTtcblxuICAgICAgICAgICAgLy8gcmVzZXRcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVyLnJlc2V0KCk7XG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFuaW1hdGlvbl9wbGF5X3BhdXNlXCIpLmlubmVySFRNTCA9IFwiUGxheVwiO1xuXG4gICAgICAgICAgICAvLyBkcmF3IHByb2Nlc3MgcHJldmlld1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoUHJvY2Vzc2VzKCk7XG5cbiAgICAgICAgICAgIC8vIHNldCBiYWNrIHRoZSByZXNpemUgY2FsbGJhY2tcbiAgICAgICAgICAgIHRoaXMuZGlzcGxheS5zZXRSZXNpemVDYWxsYmFjaygoKSA9PiB7IHRoaXMucmVmcmVzaFByb2Nlc3NlcygpIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICAvKiBzcGVlZCBjb250cm9sIHNsaWRlciAqL1xuICAgICAgICBjb25zdCBzcGVlZF9zbGlkZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFuaW1hdGlvbl9zcGVlZF9zbGlkZXJcIik7XG4gICAgICAgIHNwZWVkX3NsaWRlci5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKGU6IEV2ZW50KSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlci5zZXRBbmltYXRpb25TcGVlZChwYXJzZUludCgoPEhUTUxJbnB1dEVsZW1lbnQ+IGUudGFyZ2V0KS52YWx1ZSkpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBhZGRQcm9jZXNzZXMoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHByb2Nlc3NfY291bnQgPSBwYXJzZUludCgoPEhUTUxJbnB1dEVsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicF9jb3VudFwiKSkudmFsdWUpO1xuICAgICAgICBjb25zdCBtYXhfcHJvY2Vzc19ydW5fdGltZSA9IHBhcnNlSW50KCg8SFRNTElucHV0RWxlbWVudD4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwX21heF9ydW5fdGltZVwiKSkudmFsdWUpO1xuICAgICAgICBjb25zdCBtYXhfcHJvY2Vzc19hcnJpdmFsX3RpbWUgPSBwYXJzZUludCgoPEhUTUxJbnB1dEVsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicF9tYXhfYXJyaXZhbF90aW1lXCIpKS52YWx1ZSk7XG5cbiAgICAgICAgLy8gY2hlY2sgaWYgaW5wdXQgaXMgdmFsaWRcbiAgICAgICAgaWYgKGlzTmFOKHByb2Nlc3NfY291bnQpIHx8IGlzTmFOKG1heF9wcm9jZXNzX3J1bl90aW1lKSB8fCBpc05hTihtYXhfcHJvY2Vzc19hcnJpdmFsX3RpbWUpKXtcbiAgICAgICAgICAgIGFsZXJ0KFwiSW52YWxpZCBpbnB1dFwiKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBwcm9jZXNzX2NvdW50OyBpKyspe1xuICAgICAgICAgICAgY29uc3QgYXJyaXZhbF90aW1lID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogbWF4X3Byb2Nlc3NfYXJyaXZhbF90aW1lKTtcbiAgICAgICAgICAgIGNvbnN0IHJ1bl90aW1lID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogbWF4X3Byb2Nlc3NfcnVuX3RpbWUpICsgMTtcblxuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZXIuYWRkUHJvY2Vzc1RvUG9vbChuZXcgUHJvY2VzcyhhcnJpdmFsX3RpbWUsIHJ1bl90aW1lKSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnJlZnJlc2hQcm9jZXNzZXMoKTtcbiAgICB9XG5cbiAgICBjbGVhclByb2Nlc3NlcygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zY2hlZHVsZXIucHJvY2Vzc19wb29sID0gW107XG5cbiAgICAgICAgdGhpcy5yZWZyZXNoUHJvY2Vzc2VzKCk7XG4gICAgfVxuXG4gICAgcmVmcmVzaFByb2Nlc3NlcygpOiB2b2lke1xuICAgICAgICBjb25zdCBwcm9jZXNzX2N1cnJlbnRfY291bnRfZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBfY3VycmVudF9jb3VudFwiKTtcbiAgICAgICAgcHJvY2Vzc19jdXJyZW50X2NvdW50X2VsLmlubmVySFRNTCA9IGAoJHt0aGlzLnNjaGVkdWxlci5wcm9jZXNzX3Bvb2wubGVuZ3RoLnRvU3RyaW5nKCl9KWA7XG5cbiAgICAgICAgLy8gZHJhdyBwcm9jZXNzZXMgYXMgc3F1YXJlcyBvbiB0aGUgc2NyZWVuXG4gICAgICAgIHRoaXMuZGlzcGxheS5jdHguY2xlYXJSZWN0KDAsIDAsIHRoaXMuZGlzcGxheS5jdHguY2FudmFzLndpZHRoLCB0aGlzLmRpc3BsYXkuY3R4LmNhbnZhcy5oZWlnaHQpO1xuXG4gICAgICAgIGNvbnN0IHN0YXJ0X3ggPSB0aGlzLmRpc3BsYXkuY3R4LmNhbnZhcy53aWR0aCAvIDI7XG4gICAgICAgIGNvbnN0IHN0YXJ0X3kgPSA1MDtcblxuICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgIGxldCBwcmV2aW91c1dpZHRoID0gc3RhcnRfeDtcbiAgICAgICAgbGV0IHByZXZpb3VzSGVpZ2h0ID0gc3RhcnRfeTtcblxuICAgICAgICBsZXQgd2lkdGhTY2FsZSA9IDE7XG4gICAgICAgIGNvbnN0IEhFSUdIVCA9IDUwO1xuXG4gICAgICAgIGxldCBzdW1PZlJ1blRpbWVzID0gdGhpcy5zY2hlZHVsZXIucHJvY2Vzc19wb29sLnJlZHVjZSgoYSwgYikgPT4gYSArIGIucnVuX3RpbWUsIDApO1xuXG4gICAgICAgIC8vIHJlZHVjZSBzY2FsZSBieSB0byBmaXQgdGhlIHNjcmVlblxuICAgICAgICB3aGlsZSAoc3VtT2ZSdW5UaW1lcyAqIDEwICogd2lkdGhTY2FsZSA+ICh0aGlzLmRpc3BsYXkuY3R4LmNhbnZhcy53aWR0aCAvIDIpICogKHRoaXMuZGlzcGxheS5jdHguY2FudmFzLmhlaWdodCAvIEhFSUdIVCkgKiAwLjk1KXtcbiAgICAgICAgICAgIHdpZHRoU2NhbGUgKj0gMC41O1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChjb25zdCBwcm9jZXNzIG9mIHRoaXMuc2NoZWR1bGVyLnByb2Nlc3NfcG9vbCl7XG4gICAgICAgICAgICBsZXQgd2lkdGggPSBwcm9jZXNzLnJ1bl90aW1lICogMTAgKiB3aWR0aFNjYWxlO1xuXG4gICAgICAgICAgICAvLyBjaGVjayBpZiBpdCB3aWxsIGZpdCBvbiB0aGUgc2NyZWVuXG4gICAgICAgICAgICBpZiAocHJldmlvdXNXaWR0aCArIHdpZHRoID4gdGhpcy5kaXNwbGF5LmN0eC5jYW52YXMud2lkdGgpe1xuICAgICAgICAgICAgICAgIHByZXZpb3VzV2lkdGggPSBzdGFydF94O1xuICAgICAgICAgICAgICAgIHByZXZpb3VzSGVpZ2h0ICs9IEhFSUdIVDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYmxhY2sgcmVjdGFuZ2xlcyB3aXRoIHdoaXRlIGJvcmRlclxuICAgICAgICAgICAgdGhpcy5kaXNwbGF5LmN0eC5maWxsU3R5bGUgPSBcImJsYWNrXCI7XG4gICAgICAgICAgICB0aGlzLmRpc3BsYXkuY3R4LnN0cm9rZVN0eWxlID0gXCJ3aGl0ZVwiO1xuICAgICAgICAgICAgdGhpcy5kaXNwbGF5LmN0eC5maWxsUmVjdChwcmV2aW91c1dpZHRoLCBwcmV2aW91c0hlaWdodCwgd2lkdGgsIEhFSUdIVCk7XG4gICAgICAgICAgICB0aGlzLmRpc3BsYXkuY3R4LnN0cm9rZVJlY3QocHJldmlvdXNXaWR0aCwgcHJldmlvdXNIZWlnaHQsIHdpZHRoLCBIRUlHSFQpO1xuXG4gICAgICAgICAgICAvLyB0ZXh0IChydW5fdGltZSkgaW5zaWRlIHRoZSByZWN0YW5nbGVcbiAgICAgICAgICAgIGlmICh3aWR0aCA+IDEwKXtcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkuY3R4LmZpbGxTdHlsZSA9IFwid2hpdGVcIjtcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkuY3R4LmZvbnQgPSBcIjEwcHggQ29uc29sYXNcIjtcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkuY3R4LnRleHRBbGlnbiA9IFwiY2VudGVyXCI7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5LmN0eC5maWxsVGV4dChwcm9jZXNzLnJ1bl90aW1lLnRvU3RyaW5nKCksIHByZXZpb3VzV2lkdGggKyB3aWR0aC8yLCBwcmV2aW91c0hlaWdodCArIDQwKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcHJldmlvdXNXaWR0aCArPSB3aWR0aDtcbiAgICAgICAgICAgIGkrKztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJ1bihhbmltYXRpb246IGJvb2xlYW4gPSBmYWxzZSk6IHZvaWR7XG4gICAgICAgIGlmICh0aGlzLnNjaGVkdWxlci5wcm9jZXNzX3Bvb2wubGVuZ3RoID09PSAwKXtcbiAgICAgICAgICAgIGFsZXJ0KFwiTm8gcHJvY2Vzc2VzIHRvIHJ1blwiKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGFsZ1N0ciA9ICg8SFRNTElucHV0RWxlbWVudD4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhX3R5cGVcIikpLnZhbHVlO1xuICAgICAgICBsZXQgY29tcGFyZV9hbGwgPSBmYWxzZTtcblxuICAgICAgICBzd2l0Y2goYWxnU3RyLnRvTG93ZXJDYXNlKCkpe1xuXG4gICAgICAgICAgICAvLyBmaXJzdCBjb21lIGZpcnN0IHNlcnZlXG4gICAgICAgICAgICBjYXNlIFwiZmNmc1wiOlxuICAgICAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVyLnNldEFsZ29yaXRobShuZXcgRkNGUygpKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgLy8gc2hvcnRlc3Qgam9iIGZpcnN0XG4gICAgICAgICAgICBjYXNlIFwic2pmXCI6XG4gICAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZXIuc2V0QWxnb3JpdGhtKG5ldyBTSkYoKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIC8vIHNob3J0ZXN0IHJlbWFpbmluZyB0aW1lIGZpcnN0XG4gICAgICAgICAgICBjYXNlIFwic3J0ZlwiOlxuICAgICAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVyLnNldEFsZ29yaXRobShuZXcgU1JURigpKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgLy8gcm91bmQgcm9iaW5cbiAgICAgICAgICAgIGNhc2UgXCJyclwiOlxuICAgICAgICAgICAgICAgIGNvbnN0IHF1YW50dW0gPSBwYXJzZUludCgoPEhUTUxJbnB1dEVsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYV90aW1lX3F1YW50YVwiKSkudmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmIChpc05hTihxdWFudHVtKSl7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwiSW52YWxpZCBpbnB1dFwiKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVyLnNldEFsZ29yaXRobShuZXcgUlIocXVhbnR1bSkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAvLyBjb21wYXJlIGFsbCBhbGdvcml0aG1zXG4gICAgICAgICAgICBjYXNlIFwiY29tcGFyZSBhbGxcIjpcbiAgICAgICAgICAgICAgICBjb21wYXJlX2FsbCA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJJbnZhbGlkIGFsZ29yaXRobVwiKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKGFuaW1hdGlvbiAmJiAhY29tcGFyZV9hbGwpe1xuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZXR0aW5nc1wiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJlc3VsdHNfd3JhcHBlclwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFuaW1hdGlvbl9ndWlcIikuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcblxuICAgICAgICAgICAgLy8gY2xlYXIgdGhlIGNhbnZhc1xuICAgICAgICAgICAgdGhpcy5kaXNwbGF5LmN0eC5jbGVhclJlY3QoMCwgMCwgdGhpcy5kaXNwbGF5LmN0eC5jYW52YXMud2lkdGgsIHRoaXMuZGlzcGxheS5jdHguY2FudmFzLmhlaWdodCk7XG5cbiAgICAgICAgICAgIC8vIGluaXRpYWxpemVcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVyLnJlZnJlc2hBbmltYXRpb24odGhpcy5kaXNwbGF5KTtcblxuICAgICAgICAgICAgLy8gc2V0IHJlc2l6ZSBjYWxsYmFja1xuICAgICAgICAgICAgdGhpcy5kaXNwbGF5LnJlc2l6ZUNhbGxiYWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVyLnJlZnJlc2hBbmltYXRpb24odGhpcy5kaXNwbGF5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmIChjb21wYXJlX2FsbCl7XG4gICAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZXIuY29tcGFyZUFsbEFuZERpc3BsYXlSZXN1bHRzKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyByZXR1cm4gdGhlIHJlc3VsdHMgaW1tZWRpYXRlbHlcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdHMgPSB0aGlzLnNjaGVkdWxlci5zaW11bGF0ZSgpO1xuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZXIuZGlzcGxheVJlc3VsdHMoYWxnU3RyLCByZXN1bHRzKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCBWaXN1YWxQcm9jZXNzIGZyb20gXCIuL1Zpc3VhbFByb2Nlc3NcIlxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQcm9jZXNzIHtcbiAgICBzdGF0aWMgaW5jcmVtZW50ZWRfaWQgPSAwXG5cbiAgICBpZDogbnVtYmVyXG4gICAgc3RhcnRfdGltZTogbnVtYmVyXG4gICAgcnVuX3RpbWU6IG51bWJlclxuICAgIHRpbWVfbGVmdDogbnVtYmVyXG5cbiAgICB3YWl0X3RpbWU6IG51bWJlclxuXG4gICAgdmlzdWFsOiBWaXN1YWxQcm9jZXNzXG5cbiAgICBjb25zdHJ1Y3RvcihzdGFydF90aW1lOiBudW1iZXIsIHJ1bl90aW1lOiBudW1iZXIpe1xuICAgICAgICB0aGlzLmlkID0gUHJvY2Vzcy5pbmNyZW1lbnRlZF9pZDtcbiAgICAgICAgUHJvY2Vzcy5pbmNyZW1lbnRlZF9pZCsrO1xuXG4gICAgICAgIHRoaXMuc3RhcnRfdGltZSA9IHN0YXJ0X3RpbWU7XG5cbiAgICAgICAgdGhpcy5ydW5fdGltZSA9IHJ1bl90aW1lO1xuICAgICAgICB0aGlzLnRpbWVfbGVmdCA9IHJ1bl90aW1lO1xuXG4gICAgICAgIHRoaXMud2FpdF90aW1lID0gMDtcblxuICAgICAgICB0aGlzLnZpc3VhbCA9IG5ldyBWaXN1YWxQcm9jZXNzKHRoaXMpO1xuICAgIH1cblxuICAgIHJ1bigpOiBib29sZWFue1xuICAgICAgICB0aGlzLnRpbWVfbGVmdCAtPSAxO1xuXG4gICAgICAgIGlmICh0aGlzLnRpbWVfbGVmdCA8PSAwKVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGdldENvcHkoKTogUHJvY2Vzc3tcbiAgICAgICAgY29uc3QgY29weSA9IG5ldyBQcm9jZXNzKHRoaXMuc3RhcnRfdGltZSwgdGhpcy5ydW5fdGltZSk7XG5cbiAgICAgICAgY29weS5pZCA9IHRoaXMuaWQ7XG4gICAgICAgIGNvcHkudGltZV9sZWZ0ID0gdGhpcy50aW1lX2xlZnQ7XG4gICAgICAgIGNvcHkud2FpdF90aW1lID0gdGhpcy53YWl0X3RpbWU7XG5cbiAgICAgICAgcmV0dXJuIGNvcHk7XG4gICAgfVxufVxuIiwiaW1wb3J0IFByb2Nlc3MgZnJvbSBcIi4vUHJvY2Vzc1wiXG5pbXBvcnQgQWNjZXNzQWxnb3JpdGhtIGZyb20gXCIuL0FjY2Vzc0FsZ29yaXRobVwiXG5pbXBvcnQgRGlzcGxheSBmcm9tIFwiLi9EaXNwbGF5XCJcblxuaW1wb3J0IEZDRlMgZnJvbSBcIi4vYWxnb3JpdGhtcy9GQ0ZTXCJcbmltcG9ydCBTSkYgZnJvbSBcIi4vYWxnb3JpdGhtcy9TSkZcIlxuaW1wb3J0IFNSVEYgZnJvbSBcIi4vYWxnb3JpdGhtcy9TUlRGXCJcbmltcG9ydCBSUiBmcm9tIFwiLi9hbGdvcml0aG1zL1JSXCJcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2NoZWR1bGVyIHtcbiAgICBwcm9jZXNzX3F1ZXVlOiAgICBBcnJheTxQcm9jZXNzPiAgICAgIC8vIHByb2Nlc3NlcyBpbiBxdWV1ZVxuICAgIHByb2Nlc3NfcG9vbDogICAgIEFycmF5PFByb2Nlc3M+ICAgICAgLy8gYWxsIHByb2Nlc3NlcyBcbiAgICBmaW5pc2hlZF9wcm9jZXNzZXM6IEFycmF5PFByb2Nlc3M+ICAgIC8vIGZpbmlzaGVkIFxuXG4gICAgYWxnb3JpdGhtOiBBY2Nlc3NBbGdvcml0aG1cbiAgICB0aW1lOiBudW1iZXJcbiAgICBwcmV2aW91c0FjdGl2ZVByb2Nlc3M6IFByb2Nlc3NcblxuICAgIC8qIGFuaW1hdGlvbiAqL1xuICAgIF9wYXVzZWQ6IGJvb2xlYW5cbiAgICBfc3BlZWQ6IG51bWJlclxuICAgIF9pbnRlcnZhbDogTm9kZUpTLlRpbWVyXG4gICAgX2Rpc3BsYXk6IERpc3BsYXlcblxuICAgIGNvbnN0cnVjdG9yKCl7XG4gICAgICAgIHRoaXMucHJvY2Vzc19wb29sID0gW107XG4gICAgICAgIHRoaXMucHJvY2Vzc19xdWV1ZSA9IFtdO1xuICAgICAgICB0aGlzLmZpbmlzaGVkX3Byb2Nlc3NlcyA9IFtdO1xuXG4gICAgICAgIHRoaXMudGltZSA9IDA7XG5cbiAgICAgICAgdGhpcy5wcmV2aW91c0FjdGl2ZVByb2Nlc3MgPSBudWxsO1xuXG4gICAgICAgIHRoaXMuX3BhdXNlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuX3NwZWVkID0gMTtcbiAgICAgICAgdGhpcy5faW50ZXJ2YWwgPSBudWxsO1xuICAgICAgICB0aGlzLl9kaXNwbGF5ID0gbnVsbDtcbiAgICB9XG5cbiAgICBzZXRBbGdvcml0aG0oYWxnb3JpdGhtOiBBY2Nlc3NBbGdvcml0aG0pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5hbGdvcml0aG0gPSBhbGdvcml0aG07XG4gICAgfVxuXG4gICAgcmVzZXQoKTogdm9pZHtcbiAgICAgICAgdGhpcy5wcm9jZXNzX3F1ZXVlID0gW107XG4gICAgICAgIHRoaXMuZmluaXNoZWRfcHJvY2Vzc2VzID0gW107XG5cbiAgICAgICAgdGhpcy5wcmV2aW91c0FjdGl2ZVByb2Nlc3MgPSBudWxsO1xuXG4gICAgICAgIHRoaXMudGltZSA9IDA7XG4gICAgICAgIHRoaXMucGF1c2VBbmltYXRpb24oKTtcbiAgICB9XG5cbiAgICBhZGRQcm9jZXNzVG9Qb29sKHByb2Nlc3M6IFByb2Nlc3MpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5wcm9jZXNzX3Bvb2wucHVzaChwcm9jZXNzKTtcbiAgICB9XG5cbiAgICBuZXh0VGljaygpOiB2b2lkIHtcbiAgICAgICAgLy8gY2hlY2sgZm9yIHByb2Nlc3NlcyB3aGljaCBzaG91bGQgam9pbiB0aGUgcXVldWVcbiAgICAgICAgZm9yIChjb25zdCBwcm9jZXNzIG9mIHRoaXMucHJvY2Vzc19wb29sKXtcbiAgICAgICAgICAgIGlmIChwcm9jZXNzLnN0YXJ0X3RpbWUgPT0gdGhpcy50aW1lKSB0aGlzLnByb2Nlc3NfcXVldWUucHVzaChwcm9jZXNzLmdldENvcHkoKSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gaWYgcXVldWUgaXMgbm90IGVtcHR5XG4gICAgICAgIGlmICh0aGlzLnByb2Nlc3NfcXVldWUubGVuZ3RoID4gMClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5wcm9jZXNzX3F1ZXVlID0gdGhpcy5hbGdvcml0aG0ucHJlcHJvY2Vzcyh0aGlzLnByb2Nlc3NfcXVldWUpO1xuXG4gICAgICAgICAgICAvLyBpbmNyZWFzZSB3YWl0X3RpbWVcbiAgICAgICAgICAgIGZvciAoY29uc3QgcHJvY2VzcyBvZiB0aGlzLnByb2Nlc3NfcXVldWUpe1xuICAgICAgICAgICAgICAgIHByb2Nlc3Mud2FpdF90aW1lKys7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBwaWNrIGEgcHJvY2VzcyBmcm9tIHRoZSBxdWV1ZSB0byBiZSBydW4gaW4gdGhpcyB0aWNrXG4gICAgICAgICAgICBsZXQgY3VycmVudF9wcm9jZXNzOiBQcm9jZXNzID0gdGhpcy5hbGdvcml0aG0ucGlja05leHQodGhpcy5wcm9jZXNzX3F1ZXVlLCB0aGlzLnByZXZpb3VzQWN0aXZlUHJvY2Vzcyk7XG4gICAgICAgICAgICBsZXQgZmluaXNoZWQ6IGJvb2xlYW4gPSBjdXJyZW50X3Byb2Nlc3MucnVuKCk7XG5cbiAgICAgICAgICAgIC8vIGlmIGl0J3MgZmluaXNoZWQsIHJlbW92ZSBmcm9tIHF1ZXVlXG4gICAgICAgICAgICBpZiAoZmluaXNoZWQpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5maW5pc2hlZF9wcm9jZXNzZXMucHVzaChjdXJyZW50X3Byb2Nlc3MpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJvY2Vzc19xdWV1ZS5zcGxpY2UodGhpcy5wcm9jZXNzX3F1ZXVlLmluZGV4T2YoY3VycmVudF9wcm9jZXNzKSwgMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMucHJldmlvdXNBY3RpdmVQcm9jZXNzID0gY3VycmVudF9wcm9jZXNzO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaW5jcmVhc2UgdGltZVxuICAgICAgICB0aGlzLnRpbWUrKztcbiAgICB9XG5cbiAgICBpc0ZpbmlzaGVkKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzX3Bvb2wubGVuZ3RoID09IHRoaXMuZmluaXNoZWRfcHJvY2Vzc2VzLmxlbmd0aDtcbiAgICB9XG5cbiAgICBnZXRSZXN1bHRzKCk6IHsgYXZnV2FpdFRpbWU6IG51bWJlciwgbWF4VGltZTogbnVtYmVyIH0ge1xuICAgICAgICAvLyBhdmVyYWdlIHRpbWVcbiAgICAgICAgbGV0IGF2Z1dhaXRUaW1lID0gMDtcbiAgICAgICAgZm9yIChjb25zdCBwcm9jZXNzIG9mIHRoaXMuZmluaXNoZWRfcHJvY2Vzc2VzKSB7XG4gICAgICAgICAgICBhdmdXYWl0VGltZSArPSBwcm9jZXNzLndhaXRfdGltZTtcbiAgICAgICAgfVxuICAgICAgICBhdmdXYWl0VGltZSAvPSB0aGlzLmZpbmlzaGVkX3Byb2Nlc3Nlcy5sZW5ndGg7XG5cbiAgICAgICAgLy8gbWF4aW11bSB0aW1lXG4gICAgICAgIGxldCBtYXhUaW1lID0gTWF0aC5tYXgoLi4udGhpcy5maW5pc2hlZF9wcm9jZXNzZXMubWFwKG8gPT4gby53YWl0X3RpbWUpKTtcblxuICAgICAgICByZXR1cm4geyBhdmdXYWl0VGltZSwgbWF4VGltZSB9O1xuICAgIH1cblxuICAgIC8qIHJ1bm5pbmcgdGhlIHNpbXVsYXRpb24gKi9cbiAgICAvKlxuICAgIC8qXG4gICAgLyogKi9cblxuICAgIHNpbXVsYXRlKCk6IHsgYXZnV2FpdFRpbWU6IG51bWJlciwgbWF4VGltZTogbnVtYmVyIH0ge1xuICAgICAgICB3aGlsZSAoIXRoaXMuaXNGaW5pc2hlZCgpKXtcbiAgICAgICAgICAgIHRoaXMubmV4dFRpY2soKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIHdoZW4gZmluaXNoZWQgKi9cbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHJlc3VsdHMgPSB0aGlzLmdldFJlc3VsdHMoKTtcblxuICAgICAgICAvLyByZXNldCBiYWNrIHRvIGluaXRpYWwgc3RhdGVcbiAgICAgICAgdGhpcy5yZXNldCgpO1xuXG4gICAgICAgIHJldHVybiByZXN1bHRzO1xuICAgIH1cblxuICAgIGNvbXBhcmVBbGxBbmREaXNwbGF5UmVzdWx0cygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zZXRBbGdvcml0aG0obmV3IEZDRlMoKSk7XG4gICAgICAgIGNvbnN0IGZjZnNfcmVzdWx0cyA9IHRoaXMuc2ltdWxhdGUoKTtcbiAgICAgICAgdGhpcy5yZXNldCgpO1xuXG4gICAgICAgIHRoaXMuc2V0QWxnb3JpdGhtKG5ldyBTSkYoKSk7XG4gICAgICAgIGNvbnN0IHNqZl9yZXN1bHRzID0gdGhpcy5zaW11bGF0ZSgpO1xuICAgICAgICB0aGlzLnJlc2V0KCk7XG5cbiAgICAgICAgdGhpcy5zZXRBbGdvcml0aG0obmV3IFNSVEYoKSk7XG4gICAgICAgIGNvbnN0IHNydGZfcmVzdWx0cyA9IHRoaXMuc2ltdWxhdGUoKTtcbiAgICAgICAgdGhpcy5yZXNldCgpO1xuXG4gICAgICAgIHRoaXMuc2V0QWxnb3JpdGhtKG5ldyBSUigxKSk7XG4gICAgICAgIGNvbnN0IHJyMV9yZXN1bHRzID0gdGhpcy5zaW11bGF0ZSgpO1xuICAgICAgICB0aGlzLnJlc2V0KCk7XG5cbiAgICAgICAgdGhpcy5zZXRBbGdvcml0aG0obmV3IFJSKDMpKTtcbiAgICAgICAgY29uc3QgcnIzX3Jlc3VsdHMgPSB0aGlzLnNpbXVsYXRlKCk7XG4gICAgICAgIHRoaXMucmVzZXQoKTtcblxuICAgICAgICBsZXQgcmVzVGV4dCA9IGAoYXZlcmFnZSB3YWl0IHRpbWUpXG5cbiAgICAgICAgRkNGUzogICAke2ZjZnNfcmVzdWx0cy5hdmdXYWl0VGltZS50b0ZpeGVkKDIpfVxuICAgICAgICBTSkY6ICAgICR7c2pmX3Jlc3VsdHMuYXZnV2FpdFRpbWUudG9GaXhlZCgyKX1cbiAgICAgICAgU1JURjogICAke3NydGZfcmVzdWx0cy5hdmdXYWl0VGltZS50b0ZpeGVkKDIpfVxuICAgICAgICBSUiAoMSk6ICAke3JyMV9yZXN1bHRzLmF2Z1dhaXRUaW1lLnRvRml4ZWQoMil9XG4gICAgICAgIFJSICgzKTogICR7cnIzX3Jlc3VsdHMuYXZnV2FpdFRpbWUudG9GaXhlZCgyKX1gO1xuICAgICAgICByZXNUZXh0ID0gcmVzVGV4dC5yZXBsYWNlKFJlZ0V4cChcIlxcblwiLCBcImdcIiksIFwiPGJyPlwiKTtcblxuICAgICAgICBjb25zdCByZXN1bHRzV3JhcHBlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVzdWx0c193cmFwcGVyXCIpO1xuICAgICAgICByZXN1bHRzV3JhcHBlci5zdHlsZS5kaXNwbGF5ID0gXCJmbGV4XCI7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0c0RpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVzdWx0c1wiKTtcbiAgICAgICAgcmVzdWx0c0Rpdi5pbm5lckhUTUwgPSByZXNUZXh0O1xuICAgIH1cblxuICAgIC8qIGFuaW1hdGlvbiAqL1xuICAgIC8qXG4gICAgLypcbiAgICAvKiAqL1xuXG4gICAgaW5pdEF1dG9QbGF5KGRpc3BsYXk6IERpc3BsYXkpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fZGlzcGxheSA9IGRpc3BsYXk7XG5cbiAgICAgICAgaWYgKHRoaXMuX2ludGVydmFsICE9IG51bGwpIGNsZWFySW50ZXJ2YWwodGhpcy5faW50ZXJ2YWwpO1xuXG4gICAgICAgIHRoaXMuX2ludGVydmFsID0gc2V0SW50ZXJ2YWwoKCgpID0+IHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fcGF1c2VkKXtcbiAgICAgICAgICAgICAgICB0aGlzLm5leHRUaWNrKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoQW5pbWF0aW9uKGRpc3BsYXkpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNGaW5pc2hlZCgpKXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXVzZUFuaW1hdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXlSZXN1bHRzKHRoaXMuYWxnb3JpdGhtLm5hbWUpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZnRlckRvbmUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLmJpbmQodGhpcyksIDEwMDAgLyB0aGlzLl9zcGVlZCk7XG4gICAgfVxuXG4gICAgcmVmcmVzaEFuaW1hdGlvbihkaXNwbGF5OiBEaXNwbGF5KXtcbiAgICAgICAgaWYgKCF0aGlzLmlzRmluaXNoZWQoKSl7XG4gICAgICAgICAgICAoPEhUTUxCdXR0b25FbGVtZW50PiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFuaW1hdGlvbl9wbGF5X3BhdXNlXCIpKS5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgICAgICAgKDxIVE1MQnV0dG9uRWxlbWVudD4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbmltYXRpb25fc3RlcFwiKSkuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYW5pbWF0aW9uX2lzX2RvbmVcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZ2V0IGN0eFxuICAgICAgICBjb25zdCBjdHggPSBkaXNwbGF5LmN0eDtcbiAgICAgICAgY29uc3Qgc2NyZWVuV2lkdGggPSBkaXNwbGF5LmN0eC5jYW52YXMud2lkdGg7XG4gICAgICAgIGNvbnN0IHNjcmVlbkhlaWdodCA9IGRpc3BsYXkuY3R4LmNhbnZhcy5oZWlnaHQ7XG5cbiAgICAgICAgLy8gc2V0IHByb2Nlc3MgcG9zaXRpb25zXG4gICAgICAgIGxldCB4ID0gMTUwO1xuICAgICAgICBmb3IgKGNvbnN0IHByb2Nlc3Mgb2YgdGhpcy5wcm9jZXNzX3F1ZXVlKXtcbiAgICAgICAgICAgIGNvbnN0IFdJRFRIID0gcHJvY2Vzcy50aW1lX2xlZnQgKiAxMDtcbiAgICAgICAgICAgIHByb2Nlc3MudmlzdWFsLnNldFBvcyh4LCAyICogKHNjcmVlbkhlaWdodCAvIDMpIC0gNTAsIFdJRFRIKTtcblxuICAgICAgICAgICAgeCArPSBXSURUSCArIDIwO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gbWFrZSBwcmV2aW91cyBhY3RpdmUgcHJvY2VzcyByZWQgYW5kIG90aGVycyB3aGl0ZVxuICAgICAgICBpZiAodGhpcy5wcmV2aW91c0FjdGl2ZVByb2Nlc3MgIT0gbnVsbCl7XG4gICAgICAgICAgICB0aGlzLnByZXZpb3VzQWN0aXZlUHJvY2Vzcy52aXN1YWwuY29sb3IgPSBcIiNmZjAwMDBcIjtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IHByb2Nlc3Mgb2YgdGhpcy5wcm9jZXNzX3F1ZXVlKXtcbiAgICAgICAgICAgIGlmIChwcm9jZXNzICE9IHRoaXMucHJldmlvdXNBY3RpdmVQcm9jZXNzKXtcbiAgICAgICAgICAgICAgICBwcm9jZXNzLnZpc3VhbC5jb2xvciA9IFwiI2ZmZmZmZlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY3R4LmNsZWFyUmVjdCgwLCAwLCBzY3JlZW5XaWR0aCwgc2NyZWVuSGVpZ2h0KTtcbiAgICAgICAgY3R4LmZpbGxTdHlsZSA9IFwid2hpdGVcIjtcblxuICAgICAgICAvLyBob3Jpem9udGFsIGxpbmUgXG4gICAgICAgIGN0eC5maWxsUmVjdCgwLCAyICogKHNjcmVlbkhlaWdodCAvIDMpLCBzY3JlZW5XaWR0aCwgMSk7XG5cbiAgICAgICAgLy8gbWljcm9wcm9jZXNzb3JcbiAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gXCJ3aGl0ZVwiO1xuICAgICAgICBjdHguc3Ryb2tlUmVjdCg1MCwgMiAqIChzY3JlZW5IZWlnaHQgLyAzKSAtIDEwMCwgNTAsIDEwMCk7XG5cbiAgICAgICAgLy8gYmxhY2sgdGV4dCBpbiB0aGUgbWlkZGxlIHNheWluZyDOvFBcbiAgICAgICAgY3R4LmZvbnQgPSBcIjE1cHggUm9ib3RvXCI7XG4gICAgICAgIGN0eC50ZXh0QWxpZ24gPSBcImNlbnRlclwiO1xuICAgICAgICBjdHguZmlsbFRleHQoXCLOvFBcIiwgNTAgKyAyNSwgMiAqIChzY3JlZW5IZWlnaHQgLyAzKSAtIDUwKTtcblxuICAgICAgICAvLyBkcmF3IHByb2Nlc3Nlc1xuICAgICAgICBmb3IgKGNvbnN0IHByb2Nlc3Mgb2YgdGhpcy5wcm9jZXNzX3F1ZXVlKXtcbiAgICAgICAgICAgIGlmIChwcm9jZXNzLnZpc3VhbC54ICsgcHJvY2Vzcy52aXN1YWwud2lkdGggPCBzY3JlZW5XaWR0aCAtIHNjcmVlbldpZHRoIC8gNCl7XG4gICAgICAgICAgICAgICAgcHJvY2Vzcy52aXN1YWwuZHJhdyhjdHgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gYXQgdGhlIGFuZCBhZGQgXCIuLi4gKyBuIG1vcmVcIiBpZiB0aGVyZSBhcmUgbW9yZSBwcm9jZXNzZXNcbiAgICAgICAgaWYgKHRoaXMucHJvY2Vzc19xdWV1ZS5sZW5ndGggPiAwKXtcbiAgICAgICAgICAgIGNvbnN0IGxhc3RQcm9jZXNzID0gdGhpcy5wcm9jZXNzX3F1ZXVlW3RoaXMucHJvY2Vzc19xdWV1ZS5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIGlmIChsYXN0UHJvY2Vzcy52aXN1YWwueCArIGxhc3RQcm9jZXNzLnZpc3VhbC53aWR0aCA+IHNjcmVlbldpZHRoIC0gc2NyZWVuV2lkdGggLyA0KXtcbiAgICAgICAgICAgICAgICBjdHguZm9udCA9IFwiMzBweCBSb2JvdG9cIjtcbiAgICAgICAgICAgICAgICBjdHguZmlsbFN0eWxlID0gXCJ3aGl0ZVwiO1xuICAgICAgICAgICAgICAgIGN0eC5maWxsVGV4dChcIi4uLiArIFwiICsgKHRoaXMucHJvY2Vzc19xdWV1ZS5sZW5ndGggLSAxKSArIFwiIG1vcmVcIiwgc2NyZWVuV2lkdGggLSBzY3JlZW5XaWR0aCAvIDgsIDIgKiAoc2NyZWVuSGVpZ2h0IC8gMykgLSA1MCArIDI1KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHJlZnJlc2ggaW5mb1xuICAgICAgICBjb25zdCBhbGdvcml0aG1fZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFuaW1hdGlvbl9pbmZvX2FsZ29yaXRobV92YWx1ZVwiKTtcbiAgICAgICAgYWxnb3JpdGhtX2VsLmlubmVySFRNTCA9IHRoaXMuYWxnb3JpdGhtLm5hbWU7XG5cbiAgICAgICAgY29uc3QgdGltZV9lbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYW5pbWF0aW9uX2luZm9fdGltZV92YWx1ZVwiKTtcbiAgICAgICAgdGltZV9lbC5pbm5lckhUTUwgPSB0aGlzLnRpbWUudG9TdHJpbmcoKTtcblxuICAgICAgICBjb25zdCBsZWZ0ID0gKHRoaXMucHJvY2Vzc19wb29sLmxlbmd0aCAtICh0aGlzLnByb2Nlc3NfcXVldWUubGVuZ3RoICsgdGhpcy5maW5pc2hlZF9wcm9jZXNzZXMubGVuZ3RoKSk7XG4gICAgICAgIGNvbnN0IHByb2Nlc3Nlc19sZWZ0X3RvX2pvaW5fZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2Nlc3Nlc19pbmZvX2xlZnRfdG9fam9pbl92YWx1ZVwiKTtcbiAgICAgICAgcHJvY2Vzc2VzX2xlZnRfdG9fam9pbl9lbC5pbm5lckhUTUwgPSBsZWZ0LnRvU3RyaW5nKCk7XG5cbiAgICAgICAgaWYgKGxlZnQgPiAwKVxuICAgICAgICAgICAgcHJvY2Vzc2VzX2xlZnRfdG9fam9pbl9lbC5zdHlsZS5jb2xvciA9IFwieWVsbG93XCI7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHByb2Nlc3Nlc19sZWZ0X3RvX2pvaW5fZWwuc3R5bGUuY29sb3IgPSBcIndoaXRlXCI7XG5cbiAgICAgICAgY29uc3QgZmluaXNoZWRfcHJvY2Vzc2VzX2VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9jZXNzZXNfaW5mb19maW5pc2hlZF92YWx1ZVwiKTtcbiAgICAgICAgZmluaXNoZWRfcHJvY2Vzc2VzX2VsLmlubmVySFRNTCA9IHRoaXMuZmluaXNoZWRfcHJvY2Vzc2VzLmxlbmd0aC50b1N0cmluZygpO1xuICAgIH1cblxuICAgIGRpc3BsYXlSZXN1bHRzKGFsZ1N0cjogc3RyaW5nID0gdGhpcy5hbGdvcml0aG0ubmFtZSwgcmVzdWx0czogeyBhdmdXYWl0VGltZTogbnVtYmVyLCBtYXhUaW1lOiBudW1iZXIgfSA9IG51bGwpOiB2b2lkIHtcbiAgICAgICAgLy8gZ2V0IHJlc3VsdHNcbiAgICAgICAgaWYgKHJlc3VsdHMgPT0gbnVsbClcbiAgICAgICAgICAgIHJlc3VsdHMgPSB0aGlzLmdldFJlc3VsdHMoKTtcblxuICAgICAgICAvLyBkaXNwbGF5IHJlc3VsdHNcbiAgICAgICAgY29uc3QgcmVzdWx0c193cmFwcGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZXN1bHRzX3dyYXBwZXJcIik7XG4gICAgICAgIHJlc3VsdHNfd3JhcHBlci5zdHlsZS5kaXNwbGF5ID0gXCJmbGV4XCI7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0c19lbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVzdWx0c1wiKTtcbiAgICAgICAgcmVzdWx0c19lbC5pbm5lckhUTUwgPSBgXG4gICAgICAgIEFsZ29yaXRobTogJHthbGdTdHIudG9VcHBlckNhc2UoKX0gJHthbGdTdHIudG9Mb3dlckNhc2UoKSA9PT0gXCJyclwiID8gYCgkeyg8SFRNTElucHV0RWxlbWVudD4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhX3RpbWVfcXVhbnRhXCIpKS52YWx1ZX0pYCA6IFwiXCJ9XG5cbiAgICAgICAgQXZlcmFnZSB3YWl0aW5nIHRpbWU6ICR7cmVzdWx0cy5hdmdXYWl0VGltZS50b0ZpeGVkKDIpfVxuXG4gICAgICAgIE1heGltdW0gd2FpdGluZyB0aW1lOiAke3Jlc3VsdHMubWF4VGltZS50b0ZpeGVkKDIpfVxuICAgICAgICBgLnJlcGxhY2UoUmVnRXhwKFwiXFxuXCIsIFwiZ1wiKSwgXCI8YnIgLz5cIik7XG59XG5cbiAgICByZXN1bWVBbmltYXRpb24oKTogdm9pZCB7XG4gICAgICAgIHRoaXMuX3BhdXNlZCA9IGZhbHNlO1xuICAgIH1cblxuICAgIHBhdXNlQW5pbWF0aW9uKCk6IHZvaWQge1xuICAgICAgICB0aGlzLl9wYXVzZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIHNldEFuaW1hdGlvblNwZWVkKHNwZWVkOiBudW1iZXIpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fc3BlZWQgPSBzcGVlZDtcblxuICAgICAgICB0aGlzLmluaXRBdXRvUGxheSh0aGlzLl9kaXNwbGF5KTtcbiAgICB9XG5cbiAgICBhZnRlckRvbmUoKTogdm9pZCB7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYW5pbWF0aW9uX2lzX2RvbmVcIikuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcblxuICAgICAgICAoPEhUTUxCdXR0b25FbGVtZW50PiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFuaW1hdGlvbl9wbGF5X3BhdXNlXCIpKS5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgICg8SFRNTEJ1dHRvbkVsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYW5pbWF0aW9uX3N0ZXBcIikpLmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9XG59XG4iLCJpbXBvcnQgUHJvY2VzcyBmcm9tIFwiLi9Qcm9jZXNzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFZpc3VhbFByb2Nlc3Mge1xuICAgIHByb2Nlc3M6IFByb2Nlc3NcblxuICAgIHg6IG51bWJlclxuICAgIHk6IG51bWJlclxuICAgIHdpZHRoOiBudW1iZXJcbiAgICBoZWlnaHQ6IG51bWJlclxuXG4gICAgY29sb3I6IHN0cmluZ1xuXG4gICAgY29uc3RydWN0b3IocHJvY2VzczogUHJvY2Vzcyl7XG4gICAgICAgIHRoaXMucHJvY2VzcyA9IHByb2Nlc3M7XG5cbiAgICAgICAgdGhpcy5oZWlnaHQgPSA1MDtcbiAgICAgICAgdGhpcy5jb2xvciA9IHRoaXMucHJvY2Vzcy5zdGFydF90aW1lID4gMCA/IFwiI2ZmMDAwMFwiIDogXCIjMDBmZjAwXCI7XG4gICAgfVxuXG4gICAgc2V0UG9zKHg6IG51bWJlciwgeTogbnVtYmVyLCB3aWR0aDogbnVtYmVyID0gNTApOiB2b2lkIHtcbiAgICAgICAgdGhpcy54ID0geDtcbiAgICAgICAgdGhpcy55ID0geTtcblxuICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7XG4gICAgfVxuXG4gICAgZHJhdyhjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCk6IHZvaWQge1xuICAgICAgICBjdHguZmlsbFN0eWxlID0gdGhpcy5jb2xvcjtcbiAgICAgICAgY3R4LmZpbGxSZWN0KHRoaXMueCwgdGhpcy55LCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XG4gICAgfVxufSIsImltcG9ydCBBY2Nlc3NBbGdvcml0aG0gZnJvbSBcIi4uL0FjY2Vzc0FsZ29yaXRobVwiO1xuaW1wb3J0IFByb2Nlc3MgZnJvbSBcIi4uL1Byb2Nlc3NcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRkNGUyBpbXBsZW1lbnRzIEFjY2Vzc0FsZ29yaXRobSB7XG4gICAgbmFtZTogc3RyaW5nID0gXCJGQ0ZTXCJcblxuICAgIHByZXByb2Nlc3MocHJvY2Vzc19xdWV1ZTogQXJyYXk8UHJvY2Vzcz4pOiBBcnJheTxQcm9jZXNzPiB7XG4gICAgICAgIHJldHVybiBwcm9jZXNzX3F1ZXVlOyAvLyBkbyBub3RoaW5nXG4gICAgfVxuXG4gICAgcGlja05leHQocHJvY2Vzc19xdWV1ZTogQXJyYXk8UHJvY2Vzcz4sIHByZXZpb3VzQWN0aXZlUHJvY2VzczogUHJvY2Vzcyk6IFByb2Nlc3Mge1xuICAgICAgICByZXR1cm4gcHJvY2Vzc19xdWV1ZVswXTsgLy8gcmV0dXJucyB0aGUgZmlyc3QgZWxlbWVudCAoZmlyc3QgY29tZSlcbiAgICB9XG59XG4iLCJpbXBvcnQgQWNjZXNzQWxnb3JpdGhtIGZyb20gXCIuLi9BY2Nlc3NBbGdvcml0aG1cIjtcbmltcG9ydCBQcm9jZXNzIGZyb20gXCIuLi9Qcm9jZXNzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJSIGltcGxlbWVudHMgQWNjZXNzQWxnb3JpdGhtIHtcbiAgICBxdWFudHVtOiBudW1iZXJcblxuICAgIGN1cnJlbnRfcXVhbnR1bTogbnVtYmVyXG4gICAgY3VycmVudF9wcm9jZXNzSW5kZXg6IG51bWJlclxuXG4gICAgbmFtZTogc3RyaW5nID0gXCJSUlwiXG5cbiAgICBjb25zdHJ1Y3RvcihxdWFudHVtOiBudW1iZXIpe1xuICAgICAgICB0aGlzLnF1YW50dW0gPSBxdWFudHVtO1xuICAgIH1cblxuICAgIHByZXByb2Nlc3MocHJvY2Vzc19xdWV1ZTogQXJyYXk8UHJvY2Vzcz4pOiBBcnJheTxQcm9jZXNzPiB7XG4gICAgICAgIHJldHVybiBwcm9jZXNzX3F1ZXVlOyAvLyBkbyBub3RoaW5nXG4gICAgfVxuXG4gICAgcGlja05leHQocHJvY2Vzc19xdWV1ZTogQXJyYXk8UHJvY2Vzcz4sIHByZXZpb3VzQWN0aXZlUHJvY2VzczogUHJvY2Vzcyk6IFByb2Nlc3Mge1xuICAgICAgICAvLyBpZiBpdCdzIHRoZSBmaXJzdCBwcm9jZXNzXG4gICAgICAgIGlmIChwcmV2aW91c0FjdGl2ZVByb2Nlc3MgPT0gbnVsbCl7XG4gICAgICAgICAgICBjb25zdCBuZXh0UHJvY2VzcyA9IHByb2Nlc3NfcXVldWVbMF07XG5cbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9wcm9jZXNzSW5kZXggPSAwO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50X3F1YW50dW0gPSB0aGlzLnF1YW50dW07XG5cbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9xdWFudHVtLS07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiBuZXh0UHJvY2VzcztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gaWYgdGhlIHByZXZpb3VzIHByb2Nlc3MgaGFzIHRpbWUgbGVmdCBhbmQgcXVhbnR1bSBsZWZ0XG4gICAgICAgIGlmIChwcmV2aW91c0FjdGl2ZVByb2Nlc3MudGltZV9sZWZ0ID4gMCAmJiB0aGlzLmN1cnJlbnRfcXVhbnR1bSA+IDApe1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50X3F1YW50dW0tLTtcbiAgICAgICAgICAgIHJldHVybiBwcmV2aW91c0FjdGl2ZVByb2Nlc3M7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpZiB0aGUgcHJldmlvdXMgcHJvY2VzcyBoYXMgdGltZSBsZWZ0IGFuZCBxdWFudHVtIGlzIG92ZXJcbiAgICAgICAgaWYgKHByZXZpb3VzQWN0aXZlUHJvY2Vzcy50aW1lX2xlZnQgPiAwICYmIHRoaXMuY3VycmVudF9xdWFudHVtIDw9IDApe1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50X3Byb2Nlc3NJbmRleCA9ICh0aGlzLmN1cnJlbnRfcHJvY2Vzc0luZGV4ICsgMSkgJSBwcm9jZXNzX3F1ZXVlLmxlbmd0aDtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9xdWFudHVtID0gdGhpcy5xdWFudHVtO1xuXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRfcXVhbnR1bS0tO1xuXG4gICAgICAgICAgICByZXR1cm4gcHJvY2Vzc19xdWV1ZVt0aGlzLmN1cnJlbnRfcHJvY2Vzc0luZGV4XTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gdGhlIHByZXZpb3VzIHByb2Nlc3MgZW5kZWRcbiAgICAgICAgaWYgKHByZXZpb3VzQWN0aXZlUHJvY2Vzcy50aW1lX2xlZnQgPT0gMCl7XG4gICAgICAgICAgICAvLyB0aGUgcHJvY2VzcyBnb3QgcmVtb3ZlZCBmcm9tIHF1ZXVlIHNvIHJldHVybiB0aGUgc2FtZSBpbmRleFxuICAgICAgICAgICAgdGhpcy5jdXJyZW50X3F1YW50dW0gPSB0aGlzLnF1YW50dW07XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRfcXVhbnR1bS0tO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50X3Byb2Nlc3NJbmRleCA+PSBwcm9jZXNzX3F1ZXVlLmxlbmd0aCkgdGhpcy5jdXJyZW50X3Byb2Nlc3NJbmRleCA9IDA7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiBwcm9jZXNzX3F1ZXVlW3RoaXMuY3VycmVudF9wcm9jZXNzSW5kZXhdO1xuICAgICAgICB9XG4gICAgfVxufSIsImltcG9ydCBBY2Nlc3NBbGdvcml0aG0gZnJvbSBcIi4uL0FjY2Vzc0FsZ29yaXRobVwiO1xuaW1wb3J0IFByb2Nlc3MgZnJvbSBcIi4uL1Byb2Nlc3NcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU0pGIGltcGxlbWVudHMgQWNjZXNzQWxnb3JpdGhtIHtcbiAgICBuYW1lOiBzdHJpbmcgPSBcIlNKRlwiXG5cbiAgICBwcmVwcm9jZXNzKHByb2Nlc3NfcXVldWU6IEFycmF5PFByb2Nlc3M+KTogQXJyYXk8UHJvY2Vzcz4ge1xuICAgICAgICByZXR1cm4gcHJvY2Vzc19xdWV1ZS5zb3J0KChhLCBiKSA9PiBhLnJ1bl90aW1lIC0gYi5ydW5fdGltZSk7XG4gICAgfVxuXG4gICAgcGlja05leHQocHJvY2Vzc19xdWV1ZTogQXJyYXk8UHJvY2Vzcz4sIHByZXZpb3VzQWN0aXZlUHJvY2VzczogUHJvY2Vzcyk6IFByb2Nlc3Mge1xuICAgICAgICBpZiAocHJldmlvdXNBY3RpdmVQcm9jZXNzICE9IG51bGwgJiYgcHJldmlvdXNBY3RpdmVQcm9jZXNzLnRpbWVfbGVmdCA+IDApXG4gICAgICAgICAgICByZXR1cm4gcHJldmlvdXNBY3RpdmVQcm9jZXNzO1xuXG4gICAgICAgIHJldHVybiBwcm9jZXNzX3F1ZXVlWzBdO1xuICAgIH1cbn0iLCJpbXBvcnQgQWNjZXNzQWxnb3JpdGhtIGZyb20gXCIuLi9BY2Nlc3NBbGdvcml0aG1cIjtcbmltcG9ydCBQcm9jZXNzIGZyb20gXCIuLi9Qcm9jZXNzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNSVEYgaW1wbGVtZW50cyBBY2Nlc3NBbGdvcml0aG0ge1xuICAgIG5hbWU6IHN0cmluZyA9IFwiU1JURlwiXG5cbiAgICBwcmVwcm9jZXNzKHByb2Nlc3NfcXVldWU6IEFycmF5PFByb2Nlc3M+KTogQXJyYXk8UHJvY2Vzcz4ge1xuICAgICAgICByZXR1cm4gcHJvY2Vzc19xdWV1ZS5zb3J0KChhLCBiKSA9PiBhLnRpbWVfbGVmdCAtIGIudGltZV9sZWZ0KTtcbiAgICB9XG5cbiAgICBwaWNrTmV4dChwcm9jZXNzX3F1ZXVlOiBBcnJheTxQcm9jZXNzPiwgcHJldmlvdXNBY3RpdmVQcm9jZXNzOiBQcm9jZXNzKTogUHJvY2VzcyB7XG4gICAgICAgIHJldHVybiBwcm9jZXNzX3F1ZXVlWzBdO1xuICAgIH1cbn0iLCJpbXBvcnQgTWVudSBmcm9tICcuL2NsYXNzZXMvTWVudSc7XG5pbXBvcnQgUHJvY2VzcyBmcm9tICcuL2NsYXNzZXMvUHJvY2Vzcyc7XG5cbmltcG9ydCBTY2hlZHVsZXIgZnJvbSAnLi9jbGFzc2VzL1NjaGVkdWxlcic7XG5pbXBvcnQgRkNGUyBmcm9tICcuL2NsYXNzZXMvYWxnb3JpdGhtcy9GQ0ZTJztcbmltcG9ydCBSUiBmcm9tICcuL2NsYXNzZXMvYWxnb3JpdGhtcy9SUic7XG5cbmZ1bmN0aW9uIG1haW4oKXtcbiAgICBpZiAodHlwZW9mIGRvY3VtZW50ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgIGNvbnN0IG1lbnUgPSBuZXcgTWVudSgpO1xuICAgICAgICBtZW51LmluaXQoKTtcblxuICAgICAgICBtZW51LnNjaGVkdWxlci5hZGRQcm9jZXNzVG9Qb29sKG5ldyBQcm9jZXNzKDAsIDIpKTtcbiAgICAgICAgbWVudS5zY2hlZHVsZXIuYWRkUHJvY2Vzc1RvUG9vbChuZXcgUHJvY2VzcygwLCA1KSk7XG4gICAgICAgIG1lbnUuc2NoZWR1bGVyLmFkZFByb2Nlc3NUb1Bvb2wobmV3IFByb2Nlc3MoMCwgMykpO1xuICAgICAgICBtZW51LnJlZnJlc2hQcm9jZXNzZXMoKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGNvbnN0IHNjaGVkdWxlciA9IG5ldyBTY2hlZHVsZXIoKTtcblxuICAgICAgICAvLyBjb25zdCBwcm9jX3J1bnRpbWUgPSAxMDA7XG4gICAgICAgIC8vIGNvbnN0IHByb2Nfc3RhcnQgPSA1MDtcbiAgICAgICAgLy8gY29uc3QgcHJvY19jb3VudCA9IDEwMDAwO1xuXG4gICAgICAgIC8vIGZvciAobGV0IGkgPSAwOyBpIDwgcHJvY19jb3VudDsgaSsrKXtcbiAgICAgICAgLy8gICAgIHNjaGVkdWxlci5hZGRQcm9jZXNzVG9Qb29sKG5ldyBQcm9jZXNzKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHByb2Nfc3RhcnQpLCBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwcm9jX3J1bnRpbWUpKSk7XG4gICAgICAgIC8vIH1cblxuICAgICAgICAvLyBzY2hlZHVsZXIuc2V0QWxnb3JpdGhtKG5ldyBGQ0ZTKCkpO1xuXG4gICAgICAgIHNjaGVkdWxlci5hZGRQcm9jZXNzVG9Qb29sKG5ldyBQcm9jZXNzKDAsIDIpKTtcbiAgICAgICAgc2NoZWR1bGVyLmFkZFByb2Nlc3NUb1Bvb2wobmV3IFByb2Nlc3MoMCwgMSkpO1xuICAgICAgICBzY2hlZHVsZXIuYWRkUHJvY2Vzc1RvUG9vbChuZXcgUHJvY2VzcygwLCAzKSk7XG5cbiAgICAgICAgc2NoZWR1bGVyLnNldEFsZ29yaXRobShuZXcgUlIoMSkpO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKHNjaGVkdWxlci5zaW11bGF0ZSgpKTtcbiAgICB9XG59XG5cbm1haW4oKTtcbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8vIFRoaXMgZW50cnkgbW9kdWxlIGlzIHJlZmVyZW5jZWQgYnkgb3RoZXIgbW9kdWxlcyBzbyBpdCBjYW4ndCBiZSBpbmxpbmVkXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oOTY1KTtcbiJdLCJuYW1lcyI6WyJjb25zdHJ1Y3RvciIsInRoaXMiLCJyZXNpemVDYWxsYmFjayIsImluaXQiLCJlbGVtX2lkIiwiY2FudmFzIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImN0eCIsImdldENvbnRleHQiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwicmVzaXplVG9GaXQiLCJiaW5kIiwid2lkdGgiLCJpbm5lcldpZHRoIiwiaGVpZ2h0IiwiaW5uZXJIZWlnaHQiLCJzZXRSZXNpemVDYWxsYmFjayIsImNhbGxiYWNrIiwic2NoZWR1bGVyIiwiZGlzcGxheSIsImluaXRBdXRvUGxheSIsInJ1biIsImFkZFByb2Nlc3NlcyIsImNsZWFyUHJvY2Vzc2VzIiwiZSIsInRhcmdldCIsInZhbHVlIiwidG9Mb3dlckNhc2UiLCJzdHlsZSIsImRpc2FibGVkIiwicmVmcmVzaFByb2Nlc3NlcyIsInBsYXlfcGF1c2VfYnV0dG9uIiwic3RvcF9idXR0b24iLCJuZXh0VGljayIsInJlZnJlc2hBbmltYXRpb24iLCJpc0ZpbmlzaGVkIiwiZGlzcGxheVJlc3VsdHMiLCJhZnRlckRvbmUiLCJfcGF1c2VkIiwicmVzdW1lQW5pbWF0aW9uIiwiaW5uZXJIVE1MIiwicGF1c2VBbmltYXRpb24iLCJjbGVhclJlY3QiLCJyZXNldCIsInNldEFuaW1hdGlvblNwZWVkIiwicGFyc2VJbnQiLCJwcm9jZXNzX2NvdW50IiwibWF4X3Byb2Nlc3NfcnVuX3RpbWUiLCJtYXhfcHJvY2Vzc19hcnJpdmFsX3RpbWUiLCJpc05hTiIsImFsZXJ0IiwiaSIsImFycml2YWxfdGltZSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInJ1bl90aW1lIiwiYWRkUHJvY2Vzc1RvUG9vbCIsInByb2Nlc3NfcG9vbCIsImxlbmd0aCIsInRvU3RyaW5nIiwic3RhcnRfeCIsInByZXZpb3VzV2lkdGgiLCJwcmV2aW91c0hlaWdodCIsIndpZHRoU2NhbGUiLCJzdW1PZlJ1blRpbWVzIiwicmVkdWNlIiwiYSIsImIiLCJwcm9jZXNzIiwiZmlsbFN0eWxlIiwic3Ryb2tlU3R5bGUiLCJmaWxsUmVjdCIsInN0cm9rZVJlY3QiLCJmb250IiwidGV4dEFsaWduIiwiZmlsbFRleHQiLCJhbmltYXRpb24iLCJhbGdTdHIiLCJjb21wYXJlX2FsbCIsInNldEFsZ29yaXRobSIsInF1YW50dW0iLCJjb25zb2xlIiwibG9nIiwiY29tcGFyZUFsbEFuZERpc3BsYXlSZXN1bHRzIiwicmVzdWx0cyIsInNpbXVsYXRlIiwiUHJvY2VzcyIsInN0YXJ0X3RpbWUiLCJpZCIsImluY3JlbWVudGVkX2lkIiwidGltZV9sZWZ0Iiwid2FpdF90aW1lIiwidmlzdWFsIiwiZ2V0Q29weSIsImNvcHkiLCJwcm9jZXNzX3F1ZXVlIiwiZmluaXNoZWRfcHJvY2Vzc2VzIiwidGltZSIsInByZXZpb3VzQWN0aXZlUHJvY2VzcyIsIl9zcGVlZCIsIl9pbnRlcnZhbCIsIl9kaXNwbGF5IiwiYWxnb3JpdGhtIiwicHVzaCIsInByZXByb2Nlc3MiLCJjdXJyZW50X3Byb2Nlc3MiLCJwaWNrTmV4dCIsInNwbGljZSIsImluZGV4T2YiLCJnZXRSZXN1bHRzIiwiYXZnV2FpdFRpbWUiLCJtYXhUaW1lIiwibWF4IiwibWFwIiwibyIsImZjZnNfcmVzdWx0cyIsInNqZl9yZXN1bHRzIiwic3J0Zl9yZXN1bHRzIiwicnIxX3Jlc3VsdHMiLCJycjNfcmVzdWx0cyIsInJlc1RleHQiLCJ0b0ZpeGVkIiwicmVwbGFjZSIsIlJlZ0V4cCIsImNsZWFySW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsIm5hbWUiLCJzY3JlZW5XaWR0aCIsInNjcmVlbkhlaWdodCIsIngiLCJXSURUSCIsInNldFBvcyIsImNvbG9yIiwiZHJhdyIsImxhc3RQcm9jZXNzIiwibGVmdCIsInByb2Nlc3Nlc19sZWZ0X3RvX2pvaW5fZWwiLCJ0b1VwcGVyQ2FzZSIsInNwZWVkIiwieSIsIm5leHRQcm9jZXNzIiwiY3VycmVudF9wcm9jZXNzSW5kZXgiLCJjdXJyZW50X3F1YW50dW0iLCJzb3J0IiwibWVudSIsIm1haW4iLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImNhbGwiXSwic291cmNlUm9vdCI6IiJ9