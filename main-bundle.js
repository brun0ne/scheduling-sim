(()=>{"use strict";var e={258:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.resizeCallback=null}init(e){const t=document.getElementById(e);this.ctx=t.getContext("2d"),window.addEventListener("resize",this.resizeToFit.bind(this)),this.resizeToFit()}resizeToFit(){this.ctx.canvas.width=window.innerWidth,this.ctx.canvas.height=window.innerHeight,null!=this.resizeCallback&&this.resizeCallback()}setResizeCallback(e){this.resizeCallback=e}}},268:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(258)),l=i(s(950)),r=i(s(822)),o=i(s(76)),a=i(s(20)),u=i(s(711)),c=i(s(106));t.default=class{constructor(){this.scheduler=new r.default,this.display=new n.default,this.scheduler.initAutoPlay(this.display)}init(){document.getElementById("run_button").addEventListener("click",(()=>{this.run()})),document.getElementById("run_with_animation_button").addEventListener("click",(()=>{this.run(!0)})),document.getElementById("add_button").addEventListener("click",(()=>{this.addProcesses()})),document.getElementById("clear_button").addEventListener("click",(()=>{this.clearProcesses()})),document.getElementById("a_type").addEventListener("change",(e=>{"rr"===e.target.value.toLowerCase()?document.getElementById("a_time_quanta_all").style.display="block":document.getElementById("a_time_quanta_all").style.display="none","compare all"===e.target.value.toLowerCase()?document.getElementById("run_with_animation_button").disabled=!0:document.getElementById("run_with_animation_button").disabled=!1})),this.display.init("main_canvas"),this.display.setResizeCallback((()=>{this.refreshProcesses()})),document.getElementById("results_close").addEventListener("click",(()=>{document.getElementById("results_wrapper").style.display="none"}));const e=document.getElementById("animation_play_pause"),t=document.getElementById("animation_stop");document.getElementById("animation_step").addEventListener("click",(()=>{if(this.scheduler.nextTick(),this.scheduler.refreshAnimation(this.display),this.scheduler.isFinished())return this.scheduler.displayResults(),void this.scheduler.afterDone()})),e.addEventListener("click",(()=>{this.scheduler._paused?(this.scheduler.resumeAnimation(),e.innerHTML="Pause"):(this.scheduler.pauseAnimation(),e.innerHTML="Play")})),t.addEventListener("click",(()=>{document.getElementById("settings").style.display="flex",document.getElementById("results_wrapper").style.display="none",document.getElementById("animation_gui").style.display="none",this.display.ctx.clearRect(0,0,this.display.ctx.canvas.width,this.display.ctx.canvas.height),this.scheduler.reset(),document.getElementById("animation_play_pause").innerHTML="Play",this.refreshProcesses(),this.display.setResizeCallback((()=>{this.refreshProcesses()}))})),document.getElementById("animation_speed_slider").addEventListener("input",(e=>{this.scheduler.setAnimationSpeed(parseInt(e.target.value))}))}addProcesses(){const e=parseInt(document.getElementById("p_count").value),t=parseInt(document.getElementById("p_max_run_time").value),s=parseInt(document.getElementById("p_max_arrival_time").value);if(isNaN(e)||isNaN(t)||isNaN(s))alert("Invalid input");else{for(let i=0;i<e;i++){const e=Math.floor(Math.random()*s),i=Math.floor(Math.random()*t)+1;this.scheduler.addProcessToPool(new l.default(e,i))}this.refreshProcesses()}}clearProcesses(){this.scheduler.process_pool=[],this.refreshProcesses()}refreshProcesses(){document.getElementById("p_current_count").innerHTML=`(${this.scheduler.process_pool.length.toString()})`,this.display.ctx.clearRect(0,0,this.display.ctx.canvas.width,this.display.ctx.canvas.height);const e=this.display.ctx.canvas.width/2;let t=e,s=50,i=1,n=this.scheduler.process_pool.reduce(((e,t)=>e+t.run_time),0);for(;10*n*i>this.display.ctx.canvas.width/2*(this.display.ctx.canvas.height/50)*.95;)i*=.5;for(const n of this.scheduler.process_pool){let l=10*n.run_time*i;t+l>this.display.ctx.canvas.width&&(t=e,s+=50),this.display.ctx.fillStyle="black",this.display.ctx.strokeStyle="white",this.display.ctx.fillRect(t,s,l,50),this.display.ctx.strokeRect(t,s,l,50),l>10&&(this.display.ctx.fillStyle="white",this.display.ctx.font="10px Consolas",this.display.ctx.textAlign="center",this.display.ctx.fillText(n.run_time.toString(),t+l/2,s+40)),t+=l}}run(e=!1){if(0===this.scheduler.process_pool.length)return void alert("No processes to run");const t=document.getElementById("a_type").value;let s=!1;switch(t.toLowerCase()){case"fcfs":this.scheduler.setAlgorithm(new o.default);break;case"sjf":this.scheduler.setAlgorithm(new u.default);break;case"srtf":this.scheduler.setAlgorithm(new c.default);break;case"rr":const e=parseInt(document.getElementById("a_time_quanta").value);if(isNaN(e))return void alert("Invalid input");this.scheduler.setAlgorithm(new a.default(e));break;case"compare all":s=!0;break;default:return void console.log("Invalid algorithm")}if(e&&!s)document.getElementById("settings").style.display="none",document.getElementById("results_wrapper").style.display="none",document.getElementById("animation_gui").style.display="block",this.display.ctx.clearRect(0,0,this.display.ctx.canvas.width,this.display.ctx.canvas.height),this.scheduler.refreshAnimation(this.display),this.display.resizeCallback=()=>{this.scheduler.refreshAnimation(this.display)};else{if(s)return void this.scheduler.compareAllAndDisplayResults();const e=this.scheduler.simulate();this.scheduler.displayResults(t,e)}}}},950:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(498));class l{constructor(e,t){this.id=l.incremented_id,l.incremented_id++,this.start_time=e,this.run_time=t,this.time_left=t,this.wait_time=0,this.visual=new n.default(this)}run(){return this.time_left-=1,this.time_left<=0}getCopy(){const e=new l(this.start_time,this.run_time);return e.id=this.id,e.time_left=this.time_left,e.wait_time=this.wait_time,e}}t.default=l,l.incremented_id=0},822:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(76)),l=i(s(711)),r=i(s(106)),o=i(s(20));t.default=class{constructor(){this.process_pool=[],this.process_queue=[],this.finished_processes=[],this.time=0,this.previousActiveProcess=null,this._paused=!0,this._speed=1,this._interval=null,this._display=null}setAlgorithm(e){this.algorithm=e}reset(){this.process_queue=[],this.finished_processes=[],this.previousActiveProcess=null,this.time=0,this.pauseAnimation()}addProcessToPool(e){this.process_pool.push(e)}nextTick(){for(const e of this.process_pool)e.start_time==this.time&&this.process_queue.push(e.getCopy());if(this.process_queue.length>0){this.process_queue=this.algorithm.preprocess(this.process_queue);for(const e of this.process_queue)e.wait_time++;let e=this.algorithm.pickNext(this.process_queue,this.previousActiveProcess);e.run()&&(this.finished_processes.push(e),this.process_queue.splice(this.process_queue.indexOf(e),1)),this.previousActiveProcess=e}this.time++}isFinished(){return this.process_pool.length==this.finished_processes.length}getResults(){let e=0;for(const t of this.finished_processes)e+=t.wait_time;return e/=this.finished_processes.length,{avgWaitTime:e,maxTime:Math.max(...this.finished_processes.map((e=>e.wait_time)))}}simulate(){for(;!this.isFinished();)this.nextTick();const e=this.getResults();return this.reset(),e}compareAllAndDisplayResults(){this.setAlgorithm(new n.default);const e=this.simulate();this.reset(),this.setAlgorithm(new l.default);const t=this.simulate();this.reset(),this.setAlgorithm(new r.default);const s=this.simulate();this.reset(),this.setAlgorithm(new o.default(1));const i=this.simulate();this.reset(),this.setAlgorithm(new o.default(3));const a=this.simulate();this.reset();let u=`(average wait time)\n\n        FCFS:   ${e.avgWaitTime.toFixed(2)}\n        SJF:    ${t.avgWaitTime.toFixed(2)}\n        SRTF:   ${s.avgWaitTime.toFixed(2)}\n        RR (1):  ${i.avgWaitTime.toFixed(2)}\n        RR (3):  ${a.avgWaitTime.toFixed(2)}`;u=u.replace(RegExp("\n","g"),"<br>"),document.getElementById("results_wrapper").style.display="flex",document.getElementById("results").innerHTML=u}initAutoPlay(e){this._display=e,null!=this._interval&&clearInterval(this._interval),this._interval=setInterval((()=>{this._paused||(this.nextTick(),this.refreshAnimation(e),this.isFinished()&&(this.pauseAnimation(),this.displayResults(this.algorithm.constructor.name),this.afterDone()))}).bind(this),1e3/this._speed)}refreshAnimation(e){this.isFinished()||(document.getElementById("animation_play_pause").disabled=!1,document.getElementById("animation_step").disabled=!1,document.getElementById("animation_is_done").style.display="none");const t=e.ctx,s=e.ctx.canvas.width,i=e.ctx.canvas.height;let n=150;for(const e of this.process_queue){const t=10*e.time_left;e.visual.setPos(n,i/3*2-50,t),n+=t+20}null!=this.previousActiveProcess&&(this.previousActiveProcess.visual.color="#ff0000");for(const e of this.process_queue)e!=this.previousActiveProcess&&(e.visual.color="#ffffff");t.clearRect(0,0,s,i),t.fillStyle="white",t.fillRect(0,i/3*2,s,1),t.strokeStyle="white",t.strokeRect(50,i/3*2-100,50,100),t.font="15px Roboto",t.textAlign="center",t.fillText("Î¼P",75,i/3*2-50);for(const e of this.process_queue)e.visual.x+e.visual.width<s-s/4&&e.visual.draw(t);if(this.process_queue.length>0){const e=this.process_queue[this.process_queue.length-1];e.visual.x+e.visual.width>s-s/4&&(t.font="30px Roboto",t.fillStyle="white",t.fillText("... + "+(this.process_queue.length-1)+" more",s-s/8,i/3*2-50+25))}document.getElementById("animation_info_algorithm_value").innerHTML=this.algorithm.constructor.name,document.getElementById("animation_info_time_value").innerHTML=this.time.toString();const l=this.process_pool.length-(this.process_queue.length+this.finished_processes.length),r=document.getElementById("processes_info_left_to_join_value");r.innerHTML=l.toString(),r.style.color=l>0?"yellow":"white",document.getElementById("processes_info_finished_value").innerHTML=this.finished_processes.length.toString()}displayResults(e=this.algorithm.constructor.name,t=null){null==t&&(t=this.getResults()),document.getElementById("results_wrapper").style.display="flex",document.getElementById("results").innerHTML=`\n        Algorithm: ${e.toUpperCase()} ${"rr"===e.toLowerCase()?`(${document.getElementById("a_time_quanta").value})`:""}\n\n        Average waiting time: ${t.avgWaitTime.toFixed(2)}\n\n        Maximum waiting time: ${t.maxTime.toFixed(2)}\n        `.replace(RegExp("\n","g"),"<br />")}resumeAnimation(){this._paused=!1}pauseAnimation(){this._paused=!0}setAnimationSpeed(e){this._speed=e,this.initAutoPlay(this._display)}afterDone(){document.getElementById("animation_is_done").style.display="block",document.getElementById("animation_play_pause").disabled=!0,document.getElementById("animation_step").disabled=!0}}},498:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e){this.process=e,this.height=50,this.color=this.process.start_time>0?"#ff0000":"#00ff00"}setPos(e,t,s=50){this.x=e,this.y=t,this.width=s}draw(e){e.fillStyle=this.color,e.fillRect(this.x,this.y,this.width,this.height)}}},76:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{preprocess(e){return e}pickNext(e,t){return e[0]}}},20:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e){this.quantum=e}preprocess(e){return e}pickNext(e,t){if(null==t){const t=e[0];return this.current_processIndex=0,this.current_quantum=this.quantum,this.current_quantum--,t}return t.time_left>0&&this.current_quantum>0?(this.current_quantum--,t):t.time_left>0&&this.current_quantum<=0?(this.current_processIndex=(this.current_processIndex+1)%e.length,this.current_quantum=this.quantum,this.current_quantum--,e[this.current_processIndex]):0==t.time_left?(this.current_quantum=this.quantum,this.current_quantum--,this.current_processIndex>=e.length&&(this.current_processIndex=0),e[this.current_processIndex]):void 0}}},711:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{preprocess(e){return e.sort(((e,t)=>e.run_time-t.run_time))}pickNext(e,t){return null!=t&&t.time_left>0?t:e[0]}}},106:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{preprocess(e){return e.sort(((e,t)=>e.time_left-t.time_left))}pickNext(e,t){return e[0]}}},965:function(e,t,s){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=i(s(268)),l=i(s(950)),r=i(s(822)),o=i(s(20));!function(){if("undefined"!=typeof document){const e=new n.default;e.init(),e.scheduler.addProcessToPool(new l.default(0,2)),e.scheduler.addProcessToPool(new l.default(0,5)),e.scheduler.addProcessToPool(new l.default(0,3)),e.refreshProcesses()}else{const e=new r.default;e.addProcessToPool(new l.default(0,2)),e.addProcessToPool(new l.default(0,1)),e.addProcessToPool(new l.default(0,3)),e.setAlgorithm(new o.default(1)),console.log(e.simulate())}}()}},t={};!function s(i){var n=t[i];if(void 0!==n)return n.exports;var l=t[i]={exports:{}};return e[i].call(l.exports,l,l.exports,s),l.exports}(965)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RSxFQUFVb0UsVyxDQUU5QixDQUVBNEQsRSxHQ3ZDSUMsRUFBMkIsQ0FBQyxHQUdoQyxTQUFTQyxFQUFvQkMsR0FFNUIsSUFBSUMsRUFBZUgsRUFBeUJFLEdBQzVDLFFBQXFCRSxJQUFqQkQsRUFDSCxPQUFPQSxFQUFhRSxRQUdyQixJQUFJQyxFQUFTTixFQUF5QkUsR0FBWSxDQUdqREcsUUFBUyxDQUFDLEdBT1gsT0FIQUUsRUFBb0JMLEdBQVVNLEtBQUtGLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNKLEdBR3BFSyxFQUFPRCxPQUNmLENDbkIwQkosQ0FBb0IsSSIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2NsYXNzZXMvRGlzcGxheS50cyIsIndlYnBhY2s6Ly8vLi9jbGFzc2VzL01lbnUudHMiLCJ3ZWJwYWNrOi8vLy4vY2xhc3Nlcy9Qcm9jZXNzLnRzIiwid2VicGFjazovLy8uL2NsYXNzZXMvU2NoZWR1bGVyLnRzIiwid2VicGFjazovLy8uL2NsYXNzZXMvVmlzdWFsUHJvY2Vzcy50cyIsIndlYnBhY2s6Ly8vLi9jbGFzc2VzL2FsZ29yaXRobXMvRkNGUy50cyIsIndlYnBhY2s6Ly8vLi9jbGFzc2VzL2FsZ29yaXRobXMvUlIudHMiLCJ3ZWJwYWNrOi8vLy4vY2xhc3Nlcy9hbGdvcml0aG1zL1NKRi50cyIsIndlYnBhY2s6Ly8vLi9jbGFzc2VzL2FsZ29yaXRobXMvU1JURi50cyIsIndlYnBhY2s6Ly8vLi9tYWluLnRzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly8vd2VicGFjay9zdGFydHVwIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIERpc3BsYXkge1xuICAgIGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEXG4gICAgcmVzaXplQ2FsbGJhY2s6ICgpID0+IHZvaWRcblxuICAgIGNvbnN0cnVjdG9yKCl7XG4gICAgICAgIHRoaXMucmVzaXplQ2FsbGJhY2sgPSBudWxsO1xuICAgIH1cbiAgICBcbiAgICBpbml0KGVsZW1faWQ6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBjb25zdCBjYW52YXMgPSA8SFRNTENhbnZhc0VsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVsZW1faWQpO1xuICAgICAgICB0aGlzLmN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIHRoaXMucmVzaXplVG9GaXQuYmluZCh0aGlzKSk7XG5cbiAgICAgICAgdGhpcy5yZXNpemVUb0ZpdCgpO1xuICAgIH1cblxuICAgIHJlc2l6ZVRvRml0KCk6IHZvaWQge1xuICAgICAgICB0aGlzLmN0eC5jYW52YXMud2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcbiAgICAgICAgdGhpcy5jdHguY2FudmFzLmhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcblxuICAgICAgICBpZiAodGhpcy5yZXNpemVDYWxsYmFjayAhPSBudWxsKXtcbiAgICAgICAgICAgIHRoaXMucmVzaXplQ2FsbGJhY2soKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNldFJlc2l6ZUNhbGxiYWNrKGNhbGxiYWNrOiAoKSA9PiB2b2lkKTogdm9pZCB7XG4gICAgICAgIHRoaXMucmVzaXplQ2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICB9XG59IiwiaW1wb3J0IERpc3BsYXkgZnJvbSBcIi4vRGlzcGxheVwiO1xuXG5pbXBvcnQgUHJvY2VzcyBmcm9tIFwiLi9Qcm9jZXNzXCI7XG5pbXBvcnQgU2NoZWR1bGVyIGZyb20gXCIuL1NjaGVkdWxlclwiO1xuXG5pbXBvcnQgRkNGUyBmcm9tIFwiLi9hbGdvcml0aG1zL0ZDRlNcIjtcbmltcG9ydCBSUiBmcm9tIFwiLi9hbGdvcml0aG1zL1JSXCI7XG5pbXBvcnQgU0pGIGZyb20gXCIuL2FsZ29yaXRobXMvU0pGXCI7XG5pbXBvcnQgU1JURiBmcm9tIFwiLi9hbGdvcml0aG1zL1NSVEZcIjtcblxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNZW51IHtcbiAgICBzY2hlZHVsZXI6IFNjaGVkdWxlclxuICAgIGRpc3BsYXk6IERpc3BsYXlcblxuICAgIGNvbnN0cnVjdG9yKCl7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVyID0gbmV3IFNjaGVkdWxlcigpO1xuICAgICAgICB0aGlzLmRpc3BsYXkgPSBuZXcgRGlzcGxheSgpO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5zY2hlZHVsZXIuaW5pdEF1dG9QbGF5KHRoaXMuZGlzcGxheSk7XG4gICAgfVxuXG4gICAgaW5pdCgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgcnVuX2J1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicnVuX2J1dHRvblwiKTtcbiAgICAgICAgcnVuX2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4geyB0aGlzLnJ1bigpIH0pO1xuXG4gICAgICAgIGNvbnN0IHJ1bl93aXRoX2FuaW1hdGlvbl9idXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJ1bl93aXRoX2FuaW1hdGlvbl9idXR0b25cIik7XG4gICAgICAgIHJ1bl93aXRoX2FuaW1hdGlvbl9idXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHsgdGhpcy5ydW4odHJ1ZSkgfSk7XG5cbiAgICAgICAgY29uc3QgYWRkX2J1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWRkX2J1dHRvblwiKTtcbiAgICAgICAgYWRkX2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4geyB0aGlzLmFkZFByb2Nlc3NlcygpIH0pO1xuXG4gICAgICAgIGNvbnN0IGNsZWFyX2J1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2xlYXJfYnV0dG9uXCIpO1xuICAgICAgICBjbGVhcl9idXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHsgdGhpcy5jbGVhclByb2Nlc3NlcygpIH0pO1xuXG4gICAgICAgIGNvbnN0IGFsZ29yaXRobV9zZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFfdHlwZVwiKTtcbiAgICAgICAgYWxnb3JpdGhtX3NlbGVjdC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIChlOiBFdmVudCkgPT4gXG4gICAgICAgIHsgXG4gICAgICAgICAgICBpZiAoKDxIVE1MU2VsZWN0RWxlbWVudD4gZS50YXJnZXQpLnZhbHVlLnRvTG93ZXJDYXNlKCkgPT09IFwicnJcIilcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFfdGltZV9xdWFudGFfYWxsXCIpLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhX3RpbWVfcXVhbnRhX2FsbFwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cbiAgICAgICAgICAgIGlmICgoPEhUTUxTZWxlY3RFbGVtZW50PiBlLnRhcmdldCkudmFsdWUudG9Mb3dlckNhc2UoKSA9PT0gXCJjb21wYXJlIGFsbFwiKVxuICAgICAgICAgICAgICAgICg8SFRNTEJ1dHRvbkVsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicnVuX3dpdGhfYW5pbWF0aW9uX2J1dHRvblwiKSkuZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICg8SFRNTEJ1dHRvbkVsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicnVuX3dpdGhfYW5pbWF0aW9uX2J1dHRvblwiKSkuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5kaXNwbGF5LmluaXQoXCJtYWluX2NhbnZhc1wiKTtcbiAgICAgICAgdGhpcy5kaXNwbGF5LnNldFJlc2l6ZUNhbGxiYWNrKCgpID0+IHsgdGhpcy5yZWZyZXNoUHJvY2Vzc2VzKCkgfSk7XG5cbiAgICAgICAgLyogcmVzdWx0cyBidXR0b25zICovXG5cbiAgICAgICAgY29uc3QgcmVzdWx0c19jbG9zZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVzdWx0c19jbG9zZVwiKTtcbiAgICAgICAgcmVzdWx0c19jbG9zZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZXN1bHRzX3dyYXBwZXJcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICB9KTtcblxuICAgICAgICAvKiBhbmltYXRpb24gYnV0dG9ucyAqL1xuICAgICAgICBcbiAgICAgICAgY29uc3QgcGxheV9wYXVzZV9idXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFuaW1hdGlvbl9wbGF5X3BhdXNlXCIpO1xuICAgICAgICBjb25zdCBzdG9wX2J1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYW5pbWF0aW9uX3N0b3BcIik7XG4gICAgICAgIGNvbnN0IHN0ZXBfYnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbmltYXRpb25fc3RlcFwiKTtcblxuICAgICAgICBzdGVwX2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZXIubmV4dFRpY2soKTtcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVyLnJlZnJlc2hBbmltYXRpb24odGhpcy5kaXNwbGF5KTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuc2NoZWR1bGVyLmlzRmluaXNoZWQoKSl7XG4gICAgICAgICAgICAgICAgdGhpcy5zY2hlZHVsZXIuZGlzcGxheVJlc3VsdHMoKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNjaGVkdWxlci5hZnRlckRvbmUoKTtcblxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcGxheV9wYXVzZV9idXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLnNjaGVkdWxlci5fcGF1c2VkKXtcbiAgICAgICAgICAgICAgICB0aGlzLnNjaGVkdWxlci5yZXN1bWVBbmltYXRpb24oKTtcbiAgICAgICAgICAgICAgICBwbGF5X3BhdXNlX2J1dHRvbi5pbm5lckhUTUwgPSBcIlBhdXNlXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVyLnBhdXNlQW5pbWF0aW9uKCk7XG4gICAgICAgICAgICAgICAgcGxheV9wYXVzZV9idXR0b24uaW5uZXJIVE1MID0gXCJQbGF5XCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHN0b3BfYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICAvLyBnbyBiYWNrIHRvIG1lbnVcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2V0dGluZ3NcIikuc3R5bGUuZGlzcGxheSA9IFwiZmxleFwiO1xuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZXN1bHRzX3dyYXBwZXJcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbmltYXRpb25fZ3VpXCIpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblxuICAgICAgICAgICAgLy8gY2xlYXIgdGhlIGNhbnZhc1xuICAgICAgICAgICAgdGhpcy5kaXNwbGF5LmN0eC5jbGVhclJlY3QoMCwgMCwgdGhpcy5kaXNwbGF5LmN0eC5jYW52YXMud2lkdGgsIHRoaXMuZGlzcGxheS5jdHguY2FudmFzLmhlaWdodCk7XG5cbiAgICAgICAgICAgIC8vIHJlc2V0XG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlci5yZXNldCgpO1xuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbmltYXRpb25fcGxheV9wYXVzZVwiKS5pbm5lckhUTUwgPSBcIlBsYXlcIjtcblxuICAgICAgICAgICAgLy8gZHJhdyBwcm9jZXNzIHByZXZpZXdcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaFByb2Nlc3NlcygpO1xuXG4gICAgICAgICAgICAvLyBzZXQgYmFjayB0aGUgcmVzaXplIGNhbGxiYWNrXG4gICAgICAgICAgICB0aGlzLmRpc3BsYXkuc2V0UmVzaXplQ2FsbGJhY2soKCkgPT4geyB0aGlzLnJlZnJlc2hQcm9jZXNzZXMoKSB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLyogc3BlZWQgY29udHJvbCBzbGlkZXIgKi9cbiAgICAgICAgY29uc3Qgc3BlZWRfc2xpZGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbmltYXRpb25fc3BlZWRfc2xpZGVyXCIpO1xuICAgICAgICBzcGVlZF9zbGlkZXIuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChlOiBFdmVudCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zY2hlZHVsZXIuc2V0QW5pbWF0aW9uU3BlZWQocGFyc2VJbnQoKDxIVE1MSW5wdXRFbGVtZW50PiBlLnRhcmdldCkudmFsdWUpKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgYWRkUHJvY2Vzc2VzKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBwcm9jZXNzX2NvdW50ID0gcGFyc2VJbnQoKDxIVE1MSW5wdXRFbGVtZW50PiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBfY291bnRcIikpLnZhbHVlKTtcbiAgICAgICAgY29uc3QgbWF4X3Byb2Nlc3NfcnVuX3RpbWUgPSBwYXJzZUludCgoPEhUTUxJbnB1dEVsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicF9tYXhfcnVuX3RpbWVcIikpLnZhbHVlKTtcbiAgICAgICAgY29uc3QgbWF4X3Byb2Nlc3NfYXJyaXZhbF90aW1lID0gcGFyc2VJbnQoKDxIVE1MSW5wdXRFbGVtZW50PiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBfbWF4X2Fycml2YWxfdGltZVwiKSkudmFsdWUpO1xuXG4gICAgICAgIC8vIGNoZWNrIGlmIGlucHV0IGlzIHZhbGlkXG4gICAgICAgIGlmIChpc05hTihwcm9jZXNzX2NvdW50KSB8fCBpc05hTihtYXhfcHJvY2Vzc19ydW5fdGltZSkgfHwgaXNOYU4obWF4X3Byb2Nlc3NfYXJyaXZhbF90aW1lKSl7XG4gICAgICAgICAgICBhbGVydChcIkludmFsaWQgaW5wdXRcIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgcHJvY2Vzc19jb3VudDsgaSsrKXtcbiAgICAgICAgICAgIGNvbnN0IGFycml2YWxfdGltZSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIG1heF9wcm9jZXNzX2Fycml2YWxfdGltZSk7XG4gICAgICAgICAgICBjb25zdCBydW5fdGltZSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIG1heF9wcm9jZXNzX3J1bl90aW1lKSArIDE7XG5cbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVyLmFkZFByb2Nlc3NUb1Bvb2wobmV3IFByb2Nlc3MoYXJyaXZhbF90aW1lLCBydW5fdGltZSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5yZWZyZXNoUHJvY2Vzc2VzKCk7XG4gICAgfVxuXG4gICAgY2xlYXJQcm9jZXNzZXMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVyLnByb2Nlc3NfcG9vbCA9IFtdO1xuXG4gICAgICAgIHRoaXMucmVmcmVzaFByb2Nlc3NlcygpO1xuICAgIH1cblxuICAgIHJlZnJlc2hQcm9jZXNzZXMoKTogdm9pZHtcbiAgICAgICAgY29uc3QgcHJvY2Vzc19jdXJyZW50X2NvdW50X2VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwX2N1cnJlbnRfY291bnRcIik7XG4gICAgICAgIHByb2Nlc3NfY3VycmVudF9jb3VudF9lbC5pbm5lckhUTUwgPSBgKCR7dGhpcy5zY2hlZHVsZXIucHJvY2Vzc19wb29sLmxlbmd0aC50b1N0cmluZygpfSlgO1xuXG4gICAgICAgIC8vIGRyYXcgcHJvY2Vzc2VzIGFzIHNxdWFyZXMgb24gdGhlIHNjcmVlblxuICAgICAgICB0aGlzLmRpc3BsYXkuY3R4LmNsZWFyUmVjdCgwLCAwLCB0aGlzLmRpc3BsYXkuY3R4LmNhbnZhcy53aWR0aCwgdGhpcy5kaXNwbGF5LmN0eC5jYW52YXMuaGVpZ2h0KTtcblxuICAgICAgICBjb25zdCBzdGFydF94ID0gdGhpcy5kaXNwbGF5LmN0eC5jYW52YXMud2lkdGggLyAyO1xuICAgICAgICBjb25zdCBzdGFydF95ID0gNTA7XG5cbiAgICAgICAgbGV0IGkgPSAwO1xuICAgICAgICBsZXQgcHJldmlvdXNXaWR0aCA9IHN0YXJ0X3g7XG4gICAgICAgIGxldCBwcmV2aW91c0hlaWdodCA9IHN0YXJ0X3k7XG5cbiAgICAgICAgbGV0IHdpZHRoU2NhbGUgPSAxO1xuICAgICAgICBjb25zdCBIRUlHSFQgPSA1MDtcblxuICAgICAgICBsZXQgc3VtT2ZSdW5UaW1lcyA9IHRoaXMuc2NoZWR1bGVyLnByb2Nlc3NfcG9vbC5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLnJ1bl90aW1lLCAwKTtcblxuICAgICAgICAvLyByZWR1Y2Ugc2NhbGUgYnkgdG8gZml0IHRoZSBzY3JlZW5cbiAgICAgICAgd2hpbGUgKHN1bU9mUnVuVGltZXMgKiAxMCAqIHdpZHRoU2NhbGUgPiAodGhpcy5kaXNwbGF5LmN0eC5jYW52YXMud2lkdGggLyAyKSAqICh0aGlzLmRpc3BsYXkuY3R4LmNhbnZhcy5oZWlnaHQgLyBIRUlHSFQpICogMC45NSl7XG4gICAgICAgICAgICB3aWR0aFNjYWxlICo9IDAuNTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoY29uc3QgcHJvY2VzcyBvZiB0aGlzLnNjaGVkdWxlci5wcm9jZXNzX3Bvb2wpe1xuICAgICAgICAgICAgbGV0IHdpZHRoID0gcHJvY2Vzcy5ydW5fdGltZSAqIDEwICogd2lkdGhTY2FsZTtcblxuICAgICAgICAgICAgLy8gY2hlY2sgaWYgaXQgd2lsbCBmaXQgb24gdGhlIHNjcmVlblxuICAgICAgICAgICAgaWYgKHByZXZpb3VzV2lkdGggKyB3aWR0aCA+IHRoaXMuZGlzcGxheS5jdHguY2FudmFzLndpZHRoKXtcbiAgICAgICAgICAgICAgICBwcmV2aW91c1dpZHRoID0gc3RhcnRfeDtcbiAgICAgICAgICAgICAgICBwcmV2aW91c0hlaWdodCArPSBIRUlHSFQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGJsYWNrIHJlY3RhbmdsZXMgd2l0aCB3aGl0ZSBib3JkZXJcbiAgICAgICAgICAgIHRoaXMuZGlzcGxheS5jdHguZmlsbFN0eWxlID0gXCJibGFja1wiO1xuICAgICAgICAgICAgdGhpcy5kaXNwbGF5LmN0eC5zdHJva2VTdHlsZSA9IFwid2hpdGVcIjtcbiAgICAgICAgICAgIHRoaXMuZGlzcGxheS5jdHguZmlsbFJlY3QocHJldmlvdXNXaWR0aCwgcHJldmlvdXNIZWlnaHQsIHdpZHRoLCBIRUlHSFQpO1xuICAgICAgICAgICAgdGhpcy5kaXNwbGF5LmN0eC5zdHJva2VSZWN0KHByZXZpb3VzV2lkdGgsIHByZXZpb3VzSGVpZ2h0LCB3aWR0aCwgSEVJR0hUKTtcblxuICAgICAgICAgICAgLy8gdGV4dCAocnVuX3RpbWUpIGluc2lkZSB0aGUgcmVjdGFuZ2xlXG4gICAgICAgICAgICBpZiAod2lkdGggPiAxMCl7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5LmN0eC5maWxsU3R5bGUgPSBcIndoaXRlXCI7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5LmN0eC5mb250ID0gXCIxMHB4IENvbnNvbGFzXCI7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5LmN0eC50ZXh0QWxpZ24gPSBcImNlbnRlclwiO1xuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheS5jdHguZmlsbFRleHQocHJvY2Vzcy5ydW5fdGltZS50b1N0cmluZygpLCBwcmV2aW91c1dpZHRoICsgd2lkdGgvMiwgcHJldmlvdXNIZWlnaHQgKyA0MCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHByZXZpb3VzV2lkdGggKz0gd2lkdGg7XG4gICAgICAgICAgICBpKys7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBydW4oYW5pbWF0aW9uOiBib29sZWFuID0gZmFsc2UpOiB2b2lke1xuICAgICAgICBpZiAodGhpcy5zY2hlZHVsZXIucHJvY2Vzc19wb29sLmxlbmd0aCA9PT0gMCl7XG4gICAgICAgICAgICBhbGVydChcIk5vIHByb2Nlc3NlcyB0byBydW5cIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBhbGdTdHIgPSAoPEhUTUxJbnB1dEVsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYV90eXBlXCIpKS52YWx1ZTtcbiAgICAgICAgbGV0IGNvbXBhcmVfYWxsID0gZmFsc2U7XG5cbiAgICAgICAgc3dpdGNoKGFsZ1N0ci50b0xvd2VyQ2FzZSgpKXtcblxuICAgICAgICAgICAgLy8gZmlyc3QgY29tZSBmaXJzdCBzZXJ2ZVxuICAgICAgICAgICAgY2FzZSBcImZjZnNcIjpcbiAgICAgICAgICAgICAgICB0aGlzLnNjaGVkdWxlci5zZXRBbGdvcml0aG0obmV3IEZDRlMoKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIC8vIHNob3J0ZXN0IGpvYiBmaXJzdFxuICAgICAgICAgICAgY2FzZSBcInNqZlwiOlxuICAgICAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVyLnNldEFsZ29yaXRobShuZXcgU0pGKCkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAvLyBzaG9ydGVzdCByZW1haW5pbmcgdGltZSBmaXJzdFxuICAgICAgICAgICAgY2FzZSBcInNydGZcIjpcbiAgICAgICAgICAgICAgICB0aGlzLnNjaGVkdWxlci5zZXRBbGdvcml0aG0obmV3IFNSVEYoKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIC8vIHJvdW5kIHJvYmluXG4gICAgICAgICAgICBjYXNlIFwicnJcIjpcbiAgICAgICAgICAgICAgICBjb25zdCBxdWFudHVtID0gcGFyc2VJbnQoKDxIVE1MSW5wdXRFbGVtZW50PiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFfdGltZV9xdWFudGFcIikpLnZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4ocXVhbnR1bSkpe1xuICAgICAgICAgICAgICAgICAgICBhbGVydChcIkludmFsaWQgaW5wdXRcIik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLnNjaGVkdWxlci5zZXRBbGdvcml0aG0obmV3IFJSKHF1YW50dW0pKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgLy8gY29tcGFyZSBhbGwgYWxnb3JpdGhtc1xuICAgICAgICAgICAgY2FzZSBcImNvbXBhcmUgYWxsXCI6XG4gICAgICAgICAgICAgICAgY29tcGFyZV9hbGwgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiSW52YWxpZCBhbGdvcml0aG1cIik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmIChhbmltYXRpb24gJiYgIWNvbXBhcmVfYWxsKXtcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2V0dGluZ3NcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZXN1bHRzX3dyYXBwZXJcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbmltYXRpb25fZ3VpXCIpLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG5cbiAgICAgICAgICAgIC8vIGNsZWFyIHRoZSBjYW52YXNcbiAgICAgICAgICAgIHRoaXMuZGlzcGxheS5jdHguY2xlYXJSZWN0KDAsIDAsIHRoaXMuZGlzcGxheS5jdHguY2FudmFzLndpZHRoLCB0aGlzLmRpc3BsYXkuY3R4LmNhbnZhcy5oZWlnaHQpO1xuXG4gICAgICAgICAgICAvLyBpbml0aWFsaXplXG4gICAgICAgICAgICB0aGlzLnNjaGVkdWxlci5yZWZyZXNoQW5pbWF0aW9uKHRoaXMuZGlzcGxheSk7XG5cbiAgICAgICAgICAgIC8vIHNldCByZXNpemUgY2FsbGJhY2tcbiAgICAgICAgICAgIHRoaXMuZGlzcGxheS5yZXNpemVDYWxsYmFjayA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnNjaGVkdWxlci5yZWZyZXNoQW5pbWF0aW9uKHRoaXMuZGlzcGxheSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAoY29tcGFyZV9hbGwpe1xuICAgICAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVyLmNvbXBhcmVBbGxBbmREaXNwbGF5UmVzdWx0cygpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gcmV0dXJuIHRoZSByZXN1bHRzIGltbWVkaWF0ZWx5XG4gICAgICAgICAgICBjb25zdCByZXN1bHRzID0gdGhpcy5zY2hlZHVsZXIuc2ltdWxhdGUoKTtcbiAgICAgICAgICAgIHRoaXMuc2NoZWR1bGVyLmRpc3BsYXlSZXN1bHRzKGFsZ1N0ciwgcmVzdWx0cyk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgVmlzdWFsUHJvY2VzcyBmcm9tIFwiLi9WaXN1YWxQcm9jZXNzXCJcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUHJvY2VzcyB7XG4gICAgc3RhdGljIGluY3JlbWVudGVkX2lkID0gMFxuXG4gICAgaWQ6IG51bWJlclxuICAgIHN0YXJ0X3RpbWU6IG51bWJlclxuICAgIHJ1bl90aW1lOiBudW1iZXJcbiAgICB0aW1lX2xlZnQ6IG51bWJlclxuXG4gICAgd2FpdF90aW1lOiBudW1iZXJcblxuICAgIHZpc3VhbDogVmlzdWFsUHJvY2Vzc1xuXG4gICAgY29uc3RydWN0b3Ioc3RhcnRfdGltZTogbnVtYmVyLCBydW5fdGltZTogbnVtYmVyKXtcbiAgICAgICAgdGhpcy5pZCA9IFByb2Nlc3MuaW5jcmVtZW50ZWRfaWQ7XG4gICAgICAgIFByb2Nlc3MuaW5jcmVtZW50ZWRfaWQrKztcblxuICAgICAgICB0aGlzLnN0YXJ0X3RpbWUgPSBzdGFydF90aW1lO1xuXG4gICAgICAgIHRoaXMucnVuX3RpbWUgPSBydW5fdGltZTtcbiAgICAgICAgdGhpcy50aW1lX2xlZnQgPSBydW5fdGltZTtcblxuICAgICAgICB0aGlzLndhaXRfdGltZSA9IDA7XG5cbiAgICAgICAgdGhpcy52aXN1YWwgPSBuZXcgVmlzdWFsUHJvY2Vzcyh0aGlzKTtcbiAgICB9XG5cbiAgICBydW4oKTogYm9vbGVhbntcbiAgICAgICAgdGhpcy50aW1lX2xlZnQgLT0gMTtcblxuICAgICAgICBpZiAodGhpcy50aW1lX2xlZnQgPD0gMClcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBnZXRDb3B5KCk6IFByb2Nlc3N7XG4gICAgICAgIGNvbnN0IGNvcHkgPSBuZXcgUHJvY2Vzcyh0aGlzLnN0YXJ0X3RpbWUsIHRoaXMucnVuX3RpbWUpO1xuXG4gICAgICAgIGNvcHkuaWQgPSB0aGlzLmlkO1xuICAgICAgICBjb3B5LnRpbWVfbGVmdCA9IHRoaXMudGltZV9sZWZ0O1xuICAgICAgICBjb3B5LndhaXRfdGltZSA9IHRoaXMud2FpdF90aW1lO1xuXG4gICAgICAgIHJldHVybiBjb3B5O1xuICAgIH1cbn1cbiIsImltcG9ydCBQcm9jZXNzIGZyb20gXCIuL1Byb2Nlc3NcIlxuaW1wb3J0IEFjY2Vzc0FsZ29yaXRobSBmcm9tIFwiLi9BY2Nlc3NBbGdvcml0aG1cIlxuaW1wb3J0IERpc3BsYXkgZnJvbSBcIi4vRGlzcGxheVwiXG5cbmltcG9ydCBGQ0ZTIGZyb20gXCIuL2FsZ29yaXRobXMvRkNGU1wiXG5pbXBvcnQgU0pGIGZyb20gXCIuL2FsZ29yaXRobXMvU0pGXCJcbmltcG9ydCBTUlRGIGZyb20gXCIuL2FsZ29yaXRobXMvU1JURlwiXG5pbXBvcnQgUlIgZnJvbSBcIi4vYWxnb3JpdGhtcy9SUlwiXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNjaGVkdWxlciB7XG4gICAgcHJvY2Vzc19xdWV1ZTogICAgQXJyYXk8UHJvY2Vzcz4gICAgICAvLyBwcm9jZXNzZXMgaW4gcXVldWVcbiAgICBwcm9jZXNzX3Bvb2w6ICAgICBBcnJheTxQcm9jZXNzPiAgICAgIC8vIGFsbCBwcm9jZXNzZXMgXG4gICAgZmluaXNoZWRfcHJvY2Vzc2VzOiBBcnJheTxQcm9jZXNzPiAgICAvLyBmaW5pc2hlZCBcblxuICAgIGFsZ29yaXRobTogQWNjZXNzQWxnb3JpdGhtXG4gICAgdGltZTogbnVtYmVyXG4gICAgcHJldmlvdXNBY3RpdmVQcm9jZXNzOiBQcm9jZXNzXG5cbiAgICAvKiBhbmltYXRpb24gKi9cbiAgICBfcGF1c2VkOiBib29sZWFuXG4gICAgX3NwZWVkOiBudW1iZXJcbiAgICBfaW50ZXJ2YWw6IE5vZGVKUy5UaW1lclxuICAgIF9kaXNwbGF5OiBEaXNwbGF5XG5cbiAgICBjb25zdHJ1Y3Rvcigpe1xuICAgICAgICB0aGlzLnByb2Nlc3NfcG9vbCA9IFtdO1xuICAgICAgICB0aGlzLnByb2Nlc3NfcXVldWUgPSBbXTtcbiAgICAgICAgdGhpcy5maW5pc2hlZF9wcm9jZXNzZXMgPSBbXTtcblxuICAgICAgICB0aGlzLnRpbWUgPSAwO1xuXG4gICAgICAgIHRoaXMucHJldmlvdXNBY3RpdmVQcm9jZXNzID0gbnVsbDtcblxuICAgICAgICB0aGlzLl9wYXVzZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLl9zcGVlZCA9IDE7XG4gICAgICAgIHRoaXMuX2ludGVydmFsID0gbnVsbDtcbiAgICAgICAgdGhpcy5fZGlzcGxheSA9IG51bGw7XG4gICAgfVxuXG4gICAgc2V0QWxnb3JpdGhtKGFsZ29yaXRobTogQWNjZXNzQWxnb3JpdGhtKTogdm9pZCB7XG4gICAgICAgIHRoaXMuYWxnb3JpdGhtID0gYWxnb3JpdGhtO1xuICAgIH1cblxuICAgIHJlc2V0KCk6IHZvaWR7XG4gICAgICAgIHRoaXMucHJvY2Vzc19xdWV1ZSA9IFtdO1xuICAgICAgICB0aGlzLmZpbmlzaGVkX3Byb2Nlc3NlcyA9IFtdO1xuXG4gICAgICAgIHRoaXMucHJldmlvdXNBY3RpdmVQcm9jZXNzID0gbnVsbDtcblxuICAgICAgICB0aGlzLnRpbWUgPSAwO1xuICAgICAgICB0aGlzLnBhdXNlQW5pbWF0aW9uKCk7XG4gICAgfVxuXG4gICAgYWRkUHJvY2Vzc1RvUG9vbChwcm9jZXNzOiBQcm9jZXNzKTogdm9pZCB7XG4gICAgICAgIHRoaXMucHJvY2Vzc19wb29sLnB1c2gocHJvY2Vzcyk7XG4gICAgfVxuXG4gICAgbmV4dFRpY2soKTogdm9pZCB7XG4gICAgICAgIC8vIGNoZWNrIGZvciBwcm9jZXNzZXMgd2hpY2ggc2hvdWxkIGpvaW4gdGhlIHF1ZXVlXG4gICAgICAgIGZvciAoY29uc3QgcHJvY2VzcyBvZiB0aGlzLnByb2Nlc3NfcG9vbCl7XG4gICAgICAgICAgICBpZiAocHJvY2Vzcy5zdGFydF90aW1lID09IHRoaXMudGltZSkgdGhpcy5wcm9jZXNzX3F1ZXVlLnB1c2gocHJvY2Vzcy5nZXRDb3B5KCkpO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIGlmIHF1ZXVlIGlzIG5vdCBlbXB0eVxuICAgICAgICBpZiAodGhpcy5wcm9jZXNzX3F1ZXVlLmxlbmd0aCA+IDApXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc19xdWV1ZSA9IHRoaXMuYWxnb3JpdGhtLnByZXByb2Nlc3ModGhpcy5wcm9jZXNzX3F1ZXVlKTtcblxuICAgICAgICAgICAgLy8gaW5jcmVhc2Ugd2FpdF90aW1lXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHByb2Nlc3Mgb2YgdGhpcy5wcm9jZXNzX3F1ZXVlKXtcbiAgICAgICAgICAgICAgICBwcm9jZXNzLndhaXRfdGltZSsrO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy8gcGljayBhIHByb2Nlc3MgZnJvbSB0aGUgcXVldWUgdG8gYmUgcnVuIGluIHRoaXMgdGlja1xuICAgICAgICAgICAgbGV0IGN1cnJlbnRfcHJvY2VzczogUHJvY2VzcyA9IHRoaXMuYWxnb3JpdGhtLnBpY2tOZXh0KHRoaXMucHJvY2Vzc19xdWV1ZSwgdGhpcy5wcmV2aW91c0FjdGl2ZVByb2Nlc3MpO1xuICAgICAgICAgICAgbGV0IGZpbmlzaGVkOiBib29sZWFuID0gY3VycmVudF9wcm9jZXNzLnJ1bigpO1xuXG4gICAgICAgICAgICAvLyBpZiBpdCdzIGZpbmlzaGVkLCByZW1vdmUgZnJvbSBxdWV1ZVxuICAgICAgICAgICAgaWYgKGZpbmlzaGVkKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuZmluaXNoZWRfcHJvY2Vzc2VzLnB1c2goY3VycmVudF9wcm9jZXNzKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByb2Nlc3NfcXVldWUuc3BsaWNlKHRoaXMucHJvY2Vzc19xdWV1ZS5pbmRleE9mKGN1cnJlbnRfcHJvY2VzcyksIDEpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnByZXZpb3VzQWN0aXZlUHJvY2VzcyA9IGN1cnJlbnRfcHJvY2VzcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGluY3JlYXNlIHRpbWVcbiAgICAgICAgdGhpcy50aW1lKys7XG4gICAgfVxuXG4gICAgaXNGaW5pc2hlZCgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvY2Vzc19wb29sLmxlbmd0aCA9PSB0aGlzLmZpbmlzaGVkX3Byb2Nlc3Nlcy5sZW5ndGg7XG4gICAgfVxuXG4gICAgZ2V0UmVzdWx0cygpOiB7IGF2Z1dhaXRUaW1lOiBudW1iZXIsIG1heFRpbWU6IG51bWJlciB9IHtcbiAgICAgICAgLy8gYXZlcmFnZSB0aW1lXG4gICAgICAgIGxldCBhdmdXYWl0VGltZSA9IDA7XG4gICAgICAgIGZvciAoY29uc3QgcHJvY2VzcyBvZiB0aGlzLmZpbmlzaGVkX3Byb2Nlc3Nlcykge1xuICAgICAgICAgICAgYXZnV2FpdFRpbWUgKz0gcHJvY2Vzcy53YWl0X3RpbWU7XG4gICAgICAgIH1cbiAgICAgICAgYXZnV2FpdFRpbWUgLz0gdGhpcy5maW5pc2hlZF9wcm9jZXNzZXMubGVuZ3RoO1xuXG4gICAgICAgIC8vIG1heGltdW0gdGltZVxuICAgICAgICBsZXQgbWF4VGltZSA9IE1hdGgubWF4KC4uLnRoaXMuZmluaXNoZWRfcHJvY2Vzc2VzLm1hcChvID0+IG8ud2FpdF90aW1lKSk7XG5cbiAgICAgICAgcmV0dXJuIHsgYXZnV2FpdFRpbWUsIG1heFRpbWUgfTtcbiAgICB9XG5cbiAgICAvKiBydW5uaW5nIHRoZSBzaW11bGF0aW9uICovXG4gICAgLypcbiAgICAvKlxuICAgIC8qICovXG5cbiAgICBzaW11bGF0ZSgpOiB7IGF2Z1dhaXRUaW1lOiBudW1iZXIsIG1heFRpbWU6IG51bWJlciB9IHtcbiAgICAgICAgd2hpbGUgKCF0aGlzLmlzRmluaXNoZWQoKSl7XG4gICAgICAgICAgICB0aGlzLm5leHRUaWNrKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvKiB3aGVuIGZpbmlzaGVkICovXG4gICAgICAgIFxuICAgICAgICBjb25zdCByZXN1bHRzID0gdGhpcy5nZXRSZXN1bHRzKCk7XG5cbiAgICAgICAgLy8gcmVzZXQgYmFjayB0byBpbml0aWFsIHN0YXRlXG4gICAgICAgIHRoaXMucmVzZXQoKTtcblxuICAgICAgICByZXR1cm4gcmVzdWx0cztcbiAgICB9XG5cbiAgICBjb21wYXJlQWxsQW5kRGlzcGxheVJlc3VsdHMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc2V0QWxnb3JpdGhtKG5ldyBGQ0ZTKCkpO1xuICAgICAgICBjb25zdCBmY2ZzX3Jlc3VsdHMgPSB0aGlzLnNpbXVsYXRlKCk7XG4gICAgICAgIHRoaXMucmVzZXQoKTtcblxuICAgICAgICB0aGlzLnNldEFsZ29yaXRobShuZXcgU0pGKCkpO1xuICAgICAgICBjb25zdCBzamZfcmVzdWx0cyA9IHRoaXMuc2ltdWxhdGUoKTtcbiAgICAgICAgdGhpcy5yZXNldCgpO1xuXG4gICAgICAgIHRoaXMuc2V0QWxnb3JpdGhtKG5ldyBTUlRGKCkpO1xuICAgICAgICBjb25zdCBzcnRmX3Jlc3VsdHMgPSB0aGlzLnNpbXVsYXRlKCk7XG4gICAgICAgIHRoaXMucmVzZXQoKTtcblxuICAgICAgICB0aGlzLnNldEFsZ29yaXRobShuZXcgUlIoMSkpO1xuICAgICAgICBjb25zdCBycjFfcmVzdWx0cyA9IHRoaXMuc2ltdWxhdGUoKTtcbiAgICAgICAgdGhpcy5yZXNldCgpO1xuXG4gICAgICAgIHRoaXMuc2V0QWxnb3JpdGhtKG5ldyBSUigzKSk7XG4gICAgICAgIGNvbnN0IHJyM19yZXN1bHRzID0gdGhpcy5zaW11bGF0ZSgpO1xuICAgICAgICB0aGlzLnJlc2V0KCk7XG5cbiAgICAgICAgbGV0IHJlc1RleHQgPSBgKGF2ZXJhZ2Ugd2FpdCB0aW1lKVxuXG4gICAgICAgIEZDRlM6ICAgJHtmY2ZzX3Jlc3VsdHMuYXZnV2FpdFRpbWUudG9GaXhlZCgyKX1cbiAgICAgICAgU0pGOiAgICAke3NqZl9yZXN1bHRzLmF2Z1dhaXRUaW1lLnRvRml4ZWQoMil9XG4gICAgICAgIFNSVEY6ICAgJHtzcnRmX3Jlc3VsdHMuYXZnV2FpdFRpbWUudG9GaXhlZCgyKX1cbiAgICAgICAgUlIgKDEpOiAgJHtycjFfcmVzdWx0cy5hdmdXYWl0VGltZS50b0ZpeGVkKDIpfVxuICAgICAgICBSUiAoMyk6ICAke3JyM19yZXN1bHRzLmF2Z1dhaXRUaW1lLnRvRml4ZWQoMil9YDtcbiAgICAgICAgcmVzVGV4dCA9IHJlc1RleHQucmVwbGFjZShSZWdFeHAoXCJcXG5cIiwgXCJnXCIpLCBcIjxicj5cIik7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0c1dyYXBwZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJlc3VsdHNfd3JhcHBlclwiKTtcbiAgICAgICAgcmVzdWx0c1dyYXBwZXIuc3R5bGUuZGlzcGxheSA9IFwiZmxleFwiO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdHNEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJlc3VsdHNcIik7XG4gICAgICAgIHJlc3VsdHNEaXYuaW5uZXJIVE1MID0gcmVzVGV4dDtcbiAgICB9XG5cbiAgICAvKiBhbmltYXRpb24gKi9cbiAgICAvKlxuICAgIC8qXG4gICAgLyogKi9cblxuICAgIGluaXRBdXRvUGxheShkaXNwbGF5OiBEaXNwbGF5KTogdm9pZCB7XG4gICAgICAgIHRoaXMuX2Rpc3BsYXkgPSBkaXNwbGF5O1xuXG4gICAgICAgIGlmICh0aGlzLl9pbnRlcnZhbCAhPSBudWxsKSBjbGVhckludGVydmFsKHRoaXMuX2ludGVydmFsKTtcblxuICAgICAgICB0aGlzLl9pbnRlcnZhbCA9IHNldEludGVydmFsKCgoKSA9PiB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX3BhdXNlZCl7XG4gICAgICAgICAgICAgICAgdGhpcy5uZXh0VGljaygpO1xuICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaEFuaW1hdGlvbihkaXNwbGF5KTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzRmluaXNoZWQoKSl7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGF1c2VBbmltYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5UmVzdWx0cyh0aGlzLmFsZ29yaXRobS5jb25zdHJ1Y3Rvci5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWZ0ZXJEb25lKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KS5iaW5kKHRoaXMpLCAxMDAwIC8gdGhpcy5fc3BlZWQpO1xuICAgIH1cblxuICAgIHJlZnJlc2hBbmltYXRpb24oZGlzcGxheTogRGlzcGxheSl7XG4gICAgICAgIGlmICghdGhpcy5pc0ZpbmlzaGVkKCkpe1xuICAgICAgICAgICAgKDxIVE1MQnV0dG9uRWxlbWVudD4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbmltYXRpb25fcGxheV9wYXVzZVwiKSkuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICg8SFRNTEJ1dHRvbkVsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYW5pbWF0aW9uX3N0ZXBcIikpLmRpc2FibGVkID0gZmFsc2U7XG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFuaW1hdGlvbl9pc19kb25lXCIpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGdldCBjdHhcbiAgICAgICAgY29uc3QgY3R4ID0gZGlzcGxheS5jdHg7XG4gICAgICAgIGNvbnN0IHNjcmVlbldpZHRoID0gZGlzcGxheS5jdHguY2FudmFzLndpZHRoO1xuICAgICAgICBjb25zdCBzY3JlZW5IZWlnaHQgPSBkaXNwbGF5LmN0eC5jYW52YXMuaGVpZ2h0O1xuXG4gICAgICAgIC8vIHNldCBwcm9jZXNzIHBvc2l0aW9uc1xuICAgICAgICBsZXQgeCA9IDE1MDtcbiAgICAgICAgZm9yIChjb25zdCBwcm9jZXNzIG9mIHRoaXMucHJvY2Vzc19xdWV1ZSl7XG4gICAgICAgICAgICBjb25zdCBXSURUSCA9IHByb2Nlc3MudGltZV9sZWZ0ICogMTA7XG4gICAgICAgICAgICBwcm9jZXNzLnZpc3VhbC5zZXRQb3MoeCwgMiAqIChzY3JlZW5IZWlnaHQgLyAzKSAtIDUwLCBXSURUSCk7XG5cbiAgICAgICAgICAgIHggKz0gV0lEVEggKyAyMDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIG1ha2UgcHJldmlvdXMgYWN0aXZlIHByb2Nlc3MgcmVkIGFuZCBvdGhlcnMgd2hpdGVcbiAgICAgICAgaWYgKHRoaXMucHJldmlvdXNBY3RpdmVQcm9jZXNzICE9IG51bGwpe1xuICAgICAgICAgICAgdGhpcy5wcmV2aW91c0FjdGl2ZVByb2Nlc3MudmlzdWFsLmNvbG9yID0gXCIjZmYwMDAwXCI7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCBwcm9jZXNzIG9mIHRoaXMucHJvY2Vzc19xdWV1ZSl7XG4gICAgICAgICAgICBpZiAocHJvY2VzcyAhPSB0aGlzLnByZXZpb3VzQWN0aXZlUHJvY2Vzcyl7XG4gICAgICAgICAgICAgICAgcHJvY2Vzcy52aXN1YWwuY29sb3IgPSBcIiNmZmZmZmZcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGN0eC5jbGVhclJlY3QoMCwgMCwgc2NyZWVuV2lkdGgsIHNjcmVlbkhlaWdodCk7XG4gICAgICAgIGN0eC5maWxsU3R5bGUgPSBcIndoaXRlXCI7XG5cbiAgICAgICAgLy8gaG9yaXpvbnRhbCBsaW5lIFxuICAgICAgICBjdHguZmlsbFJlY3QoMCwgMiAqIChzY3JlZW5IZWlnaHQgLyAzKSwgc2NyZWVuV2lkdGgsIDEpO1xuXG4gICAgICAgIC8vIG1pY3JvcHJvY2Vzc29yXG4gICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IFwid2hpdGVcIjtcbiAgICAgICAgY3R4LnN0cm9rZVJlY3QoNTAsIDIgKiAoc2NyZWVuSGVpZ2h0IC8gMykgLSAxMDAsIDUwLCAxMDApO1xuXG4gICAgICAgIC8vIGJsYWNrIHRleHQgaW4gdGhlIG1pZGRsZSBzYXlpbmcgzrxQXG4gICAgICAgIGN0eC5mb250ID0gXCIxNXB4IFJvYm90b1wiO1xuICAgICAgICBjdHgudGV4dEFsaWduID0gXCJjZW50ZXJcIjtcbiAgICAgICAgY3R4LmZpbGxUZXh0KFwizrxQXCIsIDUwICsgMjUsIDIgKiAoc2NyZWVuSGVpZ2h0IC8gMykgLSA1MCk7XG5cbiAgICAgICAgLy8gZHJhdyBwcm9jZXNzZXNcbiAgICAgICAgZm9yIChjb25zdCBwcm9jZXNzIG9mIHRoaXMucHJvY2Vzc19xdWV1ZSl7XG4gICAgICAgICAgICBpZiAocHJvY2Vzcy52aXN1YWwueCArIHByb2Nlc3MudmlzdWFsLndpZHRoIDwgc2NyZWVuV2lkdGggLSBzY3JlZW5XaWR0aCAvIDQpe1xuICAgICAgICAgICAgICAgIHByb2Nlc3MudmlzdWFsLmRyYXcoY3R4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGF0IHRoZSBhbmQgYWRkIFwiLi4uICsgbiBtb3JlXCIgaWYgdGhlcmUgYXJlIG1vcmUgcHJvY2Vzc2VzXG4gICAgICAgIGlmICh0aGlzLnByb2Nlc3NfcXVldWUubGVuZ3RoID4gMCl7XG4gICAgICAgICAgICBjb25zdCBsYXN0UHJvY2VzcyA9IHRoaXMucHJvY2Vzc19xdWV1ZVt0aGlzLnByb2Nlc3NfcXVldWUubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICBpZiAobGFzdFByb2Nlc3MudmlzdWFsLnggKyBsYXN0UHJvY2Vzcy52aXN1YWwud2lkdGggPiBzY3JlZW5XaWR0aCAtIHNjcmVlbldpZHRoIC8gNCl7XG4gICAgICAgICAgICAgICAgY3R4LmZvbnQgPSBcIjMwcHggUm9ib3RvXCI7XG4gICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IFwid2hpdGVcIjtcbiAgICAgICAgICAgICAgICBjdHguZmlsbFRleHQoXCIuLi4gKyBcIiArICh0aGlzLnByb2Nlc3NfcXVldWUubGVuZ3RoIC0gMSkgKyBcIiBtb3JlXCIsIHNjcmVlbldpZHRoIC0gc2NyZWVuV2lkdGggLyA4LCAyICogKHNjcmVlbkhlaWdodCAvIDMpIC0gNTAgKyAyNSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyByZWZyZXNoIGluZm9cbiAgICAgICAgY29uc3QgYWxnb3JpdGhtX2VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbmltYXRpb25faW5mb19hbGdvcml0aG1fdmFsdWVcIik7XG4gICAgICAgIGFsZ29yaXRobV9lbC5pbm5lckhUTUwgPSB0aGlzLmFsZ29yaXRobS5jb25zdHJ1Y3Rvci5uYW1lO1xuXG4gICAgICAgIGNvbnN0IHRpbWVfZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFuaW1hdGlvbl9pbmZvX3RpbWVfdmFsdWVcIik7XG4gICAgICAgIHRpbWVfZWwuaW5uZXJIVE1MID0gdGhpcy50aW1lLnRvU3RyaW5nKCk7XG5cbiAgICAgICAgY29uc3QgbGVmdCA9ICh0aGlzLnByb2Nlc3NfcG9vbC5sZW5ndGggLSAodGhpcy5wcm9jZXNzX3F1ZXVlLmxlbmd0aCArIHRoaXMuZmluaXNoZWRfcHJvY2Vzc2VzLmxlbmd0aCkpO1xuICAgICAgICBjb25zdCBwcm9jZXNzZXNfbGVmdF90b19qb2luX2VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9jZXNzZXNfaW5mb19sZWZ0X3RvX2pvaW5fdmFsdWVcIik7XG4gICAgICAgIHByb2Nlc3Nlc19sZWZ0X3RvX2pvaW5fZWwuaW5uZXJIVE1MID0gbGVmdC50b1N0cmluZygpO1xuXG4gICAgICAgIGlmIChsZWZ0ID4gMClcbiAgICAgICAgICAgIHByb2Nlc3Nlc19sZWZ0X3RvX2pvaW5fZWwuc3R5bGUuY29sb3IgPSBcInllbGxvd1wiO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICBwcm9jZXNzZXNfbGVmdF90b19qb2luX2VsLnN0eWxlLmNvbG9yID0gXCJ3aGl0ZVwiO1xuXG4gICAgICAgIGNvbnN0IGZpbmlzaGVkX3Byb2Nlc3Nlc19lbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvY2Vzc2VzX2luZm9fZmluaXNoZWRfdmFsdWVcIik7XG4gICAgICAgIGZpbmlzaGVkX3Byb2Nlc3Nlc19lbC5pbm5lckhUTUwgPSB0aGlzLmZpbmlzaGVkX3Byb2Nlc3Nlcy5sZW5ndGgudG9TdHJpbmcoKTtcbiAgICB9XG5cbiAgICBkaXNwbGF5UmVzdWx0cyhhbGdTdHI6IHN0cmluZyA9IHRoaXMuYWxnb3JpdGhtLmNvbnN0cnVjdG9yLm5hbWUsIHJlc3VsdHM6IHsgYXZnV2FpdFRpbWU6IG51bWJlciwgbWF4VGltZTogbnVtYmVyIH0gPSBudWxsKTogdm9pZCB7XG4gICAgICAgIC8vIGdldCByZXN1bHRzXG4gICAgICAgIGlmIChyZXN1bHRzID09IG51bGwpXG4gICAgICAgICAgICByZXN1bHRzID0gdGhpcy5nZXRSZXN1bHRzKCk7XG5cbiAgICAgICAgLy8gZGlzcGxheSByZXN1bHRzXG4gICAgICAgIGNvbnN0IHJlc3VsdHNfd3JhcHBlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVzdWx0c193cmFwcGVyXCIpO1xuICAgICAgICByZXN1bHRzX3dyYXBwZXIuc3R5bGUuZGlzcGxheSA9IFwiZmxleFwiO1xuXG4gICAgICAgIGNvbnN0IHJlc3VsdHNfZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJlc3VsdHNcIik7XG4gICAgICAgIHJlc3VsdHNfZWwuaW5uZXJIVE1MID0gYFxuICAgICAgICBBbGdvcml0aG06ICR7YWxnU3RyLnRvVXBwZXJDYXNlKCl9ICR7YWxnU3RyLnRvTG93ZXJDYXNlKCkgPT09IFwicnJcIiA/IGAoJHsoPEhUTUxJbnB1dEVsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYV90aW1lX3F1YW50YVwiKSkudmFsdWV9KWAgOiBcIlwifVxuXG4gICAgICAgIEF2ZXJhZ2Ugd2FpdGluZyB0aW1lOiAke3Jlc3VsdHMuYXZnV2FpdFRpbWUudG9GaXhlZCgyKX1cblxuICAgICAgICBNYXhpbXVtIHdhaXRpbmcgdGltZTogJHtyZXN1bHRzLm1heFRpbWUudG9GaXhlZCgyKX1cbiAgICAgICAgYC5yZXBsYWNlKFJlZ0V4cChcIlxcblwiLCBcImdcIiksIFwiPGJyIC8+XCIpO1xufVxuXG4gICAgcmVzdW1lQW5pbWF0aW9uKCk6IHZvaWQge1xuICAgICAgICB0aGlzLl9wYXVzZWQgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBwYXVzZUFuaW1hdGlvbigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fcGF1c2VkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBzZXRBbmltYXRpb25TcGVlZChzcGVlZDogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuX3NwZWVkID0gc3BlZWQ7XG5cbiAgICAgICAgdGhpcy5pbml0QXV0b1BsYXkodGhpcy5fZGlzcGxheSk7XG4gICAgfVxuXG4gICAgYWZ0ZXJEb25lKCk6IHZvaWQge1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFuaW1hdGlvbl9pc19kb25lXCIpLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG5cbiAgICAgICAgKDxIVE1MQnV0dG9uRWxlbWVudD4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhbmltYXRpb25fcGxheV9wYXVzZVwiKSkuZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAoPEhUTUxCdXR0b25FbGVtZW50PiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFuaW1hdGlvbl9zdGVwXCIpKS5kaXNhYmxlZCA9IHRydWU7XG4gICAgfVxufVxuIiwiaW1wb3J0IFByb2Nlc3MgZnJvbSBcIi4vUHJvY2Vzc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBWaXN1YWxQcm9jZXNzIHtcbiAgICBwcm9jZXNzOiBQcm9jZXNzXG5cbiAgICB4OiBudW1iZXJcbiAgICB5OiBudW1iZXJcbiAgICB3aWR0aDogbnVtYmVyXG4gICAgaGVpZ2h0OiBudW1iZXJcblxuICAgIGNvbG9yOiBzdHJpbmdcblxuICAgIGNvbnN0cnVjdG9yKHByb2Nlc3M6IFByb2Nlc3Mpe1xuICAgICAgICB0aGlzLnByb2Nlc3MgPSBwcm9jZXNzO1xuXG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gNTA7XG4gICAgICAgIHRoaXMuY29sb3IgPSB0aGlzLnByb2Nlc3Muc3RhcnRfdGltZSA+IDAgPyBcIiNmZjAwMDBcIiA6IFwiIzAwZmYwMFwiO1xuICAgIH1cblxuICAgIHNldFBvcyh4OiBudW1iZXIsIHk6IG51bWJlciwgd2lkdGg6IG51bWJlciA9IDUwKTogdm9pZCB7XG4gICAgICAgIHRoaXMueCA9IHg7XG4gICAgICAgIHRoaXMueSA9IHk7XG5cbiAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgIH1cblxuICAgIGRyYXcoY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQpOiB2b2lkIHtcbiAgICAgICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMuY29sb3I7XG4gICAgICAgIGN0eC5maWxsUmVjdCh0aGlzLngsIHRoaXMueSwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xuICAgIH1cbn0iLCJpbXBvcnQgQWNjZXNzQWxnb3JpdGhtIGZyb20gXCIuLi9BY2Nlc3NBbGdvcml0aG1cIjtcbmltcG9ydCBQcm9jZXNzIGZyb20gXCIuLi9Qcm9jZXNzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZDRlMgaW1wbGVtZW50cyBBY2Nlc3NBbGdvcml0aG0ge1xuICAgIHByZXByb2Nlc3MocHJvY2Vzc19xdWV1ZTogQXJyYXk8UHJvY2Vzcz4pOiBBcnJheTxQcm9jZXNzPiB7XG4gICAgICAgIHJldHVybiBwcm9jZXNzX3F1ZXVlOyAvLyBkbyBub3RoaW5nXG4gICAgfVxuXG4gICAgcGlja05leHQocHJvY2Vzc19xdWV1ZTogQXJyYXk8UHJvY2Vzcz4sIHByZXZpb3VzQWN0aXZlUHJvY2VzczogUHJvY2Vzcyk6IFByb2Nlc3Mge1xuICAgICAgICByZXR1cm4gcHJvY2Vzc19xdWV1ZVswXTsgLy8gcmV0dXJucyB0aGUgZmlyc3QgZWxlbWVudCAoZmlyc3QgY29tZSlcbiAgICB9XG59XG4iLCJpbXBvcnQgQWNjZXNzQWxnb3JpdGhtIGZyb20gXCIuLi9BY2Nlc3NBbGdvcml0aG1cIjtcbmltcG9ydCBQcm9jZXNzIGZyb20gXCIuLi9Qcm9jZXNzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJSIGltcGxlbWVudHMgQWNjZXNzQWxnb3JpdGhtIHtcbiAgICBxdWFudHVtOiBudW1iZXJcblxuICAgIGN1cnJlbnRfcXVhbnR1bTogbnVtYmVyXG4gICAgY3VycmVudF9wcm9jZXNzSW5kZXg6IG51bWJlclxuXG4gICAgY29uc3RydWN0b3IocXVhbnR1bTogbnVtYmVyKXtcbiAgICAgICAgdGhpcy5xdWFudHVtID0gcXVhbnR1bTtcbiAgICB9XG5cbiAgICBwcmVwcm9jZXNzKHByb2Nlc3NfcXVldWU6IEFycmF5PFByb2Nlc3M+KTogQXJyYXk8UHJvY2Vzcz4ge1xuICAgICAgICByZXR1cm4gcHJvY2Vzc19xdWV1ZTsgLy8gZG8gbm90aGluZ1xuICAgIH1cblxuICAgIHBpY2tOZXh0KHByb2Nlc3NfcXVldWU6IEFycmF5PFByb2Nlc3M+LCBwcmV2aW91c0FjdGl2ZVByb2Nlc3M6IFByb2Nlc3MpOiBQcm9jZXNzIHtcbiAgICAgICAgLy8gaWYgaXQncyB0aGUgZmlyc3QgcHJvY2Vzc1xuICAgICAgICBpZiAocHJldmlvdXNBY3RpdmVQcm9jZXNzID09IG51bGwpe1xuICAgICAgICAgICAgY29uc3QgbmV4dFByb2Nlc3MgPSBwcm9jZXNzX3F1ZXVlWzBdO1xuXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRfcHJvY2Vzc0luZGV4ID0gMDtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9xdWFudHVtID0gdGhpcy5xdWFudHVtO1xuXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRfcXVhbnR1bS0tO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gbmV4dFByb2Nlc3M7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIGlmIHRoZSBwcmV2aW91cyBwcm9jZXNzIGhhcyB0aW1lIGxlZnQgYW5kIHF1YW50dW0gbGVmdFxuICAgICAgICBpZiAocHJldmlvdXNBY3RpdmVQcm9jZXNzLnRpbWVfbGVmdCA+IDAgJiYgdGhpcy5jdXJyZW50X3F1YW50dW0gPiAwKXtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9xdWFudHVtLS07XG4gICAgICAgICAgICByZXR1cm4gcHJldmlvdXNBY3RpdmVQcm9jZXNzO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaWYgdGhlIHByZXZpb3VzIHByb2Nlc3MgaGFzIHRpbWUgbGVmdCBhbmQgcXVhbnR1bSBpcyBvdmVyXG4gICAgICAgIGlmIChwcmV2aW91c0FjdGl2ZVByb2Nlc3MudGltZV9sZWZ0ID4gMCAmJiB0aGlzLmN1cnJlbnRfcXVhbnR1bSA8PSAwKXtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9wcm9jZXNzSW5kZXggPSAodGhpcy5jdXJyZW50X3Byb2Nlc3NJbmRleCArIDEpICUgcHJvY2Vzc19xdWV1ZS5sZW5ndGg7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRfcXVhbnR1bSA9IHRoaXMucXVhbnR1bTtcblxuICAgICAgICAgICAgdGhpcy5jdXJyZW50X3F1YW50dW0tLTtcblxuICAgICAgICAgICAgcmV0dXJuIHByb2Nlc3NfcXVldWVbdGhpcy5jdXJyZW50X3Byb2Nlc3NJbmRleF07XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIHRoZSBwcmV2aW91cyBwcm9jZXNzIGVuZGVkXG4gICAgICAgIGlmIChwcmV2aW91c0FjdGl2ZVByb2Nlc3MudGltZV9sZWZ0ID09IDApe1xuICAgICAgICAgICAgLy8gdGhlIHByb2Nlc3MgZ290IHJlbW92ZWQgZnJvbSBxdWV1ZSBzbyByZXR1cm4gdGhlIHNhbWUgaW5kZXhcbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9xdWFudHVtID0gdGhpcy5xdWFudHVtO1xuICAgICAgICAgICAgdGhpcy5jdXJyZW50X3F1YW50dW0tLTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudF9wcm9jZXNzSW5kZXggPj0gcHJvY2Vzc19xdWV1ZS5sZW5ndGgpIHRoaXMuY3VycmVudF9wcm9jZXNzSW5kZXggPSAwO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gcHJvY2Vzc19xdWV1ZVt0aGlzLmN1cnJlbnRfcHJvY2Vzc0luZGV4XTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCJpbXBvcnQgQWNjZXNzQWxnb3JpdGhtIGZyb20gXCIuLi9BY2Nlc3NBbGdvcml0aG1cIjtcbmltcG9ydCBQcm9jZXNzIGZyb20gXCIuLi9Qcm9jZXNzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNKRiBpbXBsZW1lbnRzIEFjY2Vzc0FsZ29yaXRobSB7XG4gICAgcHJlcHJvY2Vzcyhwcm9jZXNzX3F1ZXVlOiBBcnJheTxQcm9jZXNzPik6IEFycmF5PFByb2Nlc3M+IHtcbiAgICAgICAgcmV0dXJuIHByb2Nlc3NfcXVldWUuc29ydCgoYSwgYikgPT4gYS5ydW5fdGltZSAtIGIucnVuX3RpbWUpO1xuICAgIH1cblxuICAgIHBpY2tOZXh0KHByb2Nlc3NfcXVldWU6IEFycmF5PFByb2Nlc3M+LCBwcmV2aW91c0FjdGl2ZVByb2Nlc3M6IFByb2Nlc3MpOiBQcm9jZXNzIHtcbiAgICAgICAgaWYgKHByZXZpb3VzQWN0aXZlUHJvY2VzcyAhPSBudWxsICYmIHByZXZpb3VzQWN0aXZlUHJvY2Vzcy50aW1lX2xlZnQgPiAwKVxuICAgICAgICAgICAgcmV0dXJuIHByZXZpb3VzQWN0aXZlUHJvY2VzcztcblxuICAgICAgICByZXR1cm4gcHJvY2Vzc19xdWV1ZVswXTtcbiAgICB9XG59IiwiaW1wb3J0IEFjY2Vzc0FsZ29yaXRobSBmcm9tIFwiLi4vQWNjZXNzQWxnb3JpdGhtXCI7XG5pbXBvcnQgUHJvY2VzcyBmcm9tIFwiLi4vUHJvY2Vzc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTUlRGIGltcGxlbWVudHMgQWNjZXNzQWxnb3JpdGhtIHtcbiAgICBwcmVwcm9jZXNzKHByb2Nlc3NfcXVldWU6IEFycmF5PFByb2Nlc3M+KTogQXJyYXk8UHJvY2Vzcz4ge1xuICAgICAgICByZXR1cm4gcHJvY2Vzc19xdWV1ZS5zb3J0KChhLCBiKSA9PiBhLnRpbWVfbGVmdCAtIGIudGltZV9sZWZ0KTtcbiAgICB9XG5cbiAgICBwaWNrTmV4dChwcm9jZXNzX3F1ZXVlOiBBcnJheTxQcm9jZXNzPiwgcHJldmlvdXNBY3RpdmVQcm9jZXNzOiBQcm9jZXNzKTogUHJvY2VzcyB7XG4gICAgICAgIHJldHVybiBwcm9jZXNzX3F1ZXVlWzBdO1xuICAgIH1cbn0iLCJpbXBvcnQgTWVudSBmcm9tICcuL2NsYXNzZXMvTWVudSc7XG5pbXBvcnQgUHJvY2VzcyBmcm9tICcuL2NsYXNzZXMvUHJvY2Vzcyc7XG5cbmltcG9ydCBTY2hlZHVsZXIgZnJvbSAnLi9jbGFzc2VzL1NjaGVkdWxlcic7XG5pbXBvcnQgRkNGUyBmcm9tICcuL2NsYXNzZXMvYWxnb3JpdGhtcy9GQ0ZTJztcbmltcG9ydCBSUiBmcm9tICcuL2NsYXNzZXMvYWxnb3JpdGhtcy9SUic7XG5cbmZ1bmN0aW9uIG1haW4oKXtcbiAgICBpZiAodHlwZW9mIGRvY3VtZW50ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgIGNvbnN0IG1lbnUgPSBuZXcgTWVudSgpO1xuICAgICAgICBtZW51LmluaXQoKTtcblxuICAgICAgICBtZW51LnNjaGVkdWxlci5hZGRQcm9jZXNzVG9Qb29sKG5ldyBQcm9jZXNzKDAsIDIpKTtcbiAgICAgICAgbWVudS5zY2hlZHVsZXIuYWRkUHJvY2Vzc1RvUG9vbChuZXcgUHJvY2VzcygwLCA1KSk7XG4gICAgICAgIG1lbnUuc2NoZWR1bGVyLmFkZFByb2Nlc3NUb1Bvb2wobmV3IFByb2Nlc3MoMCwgMykpO1xuICAgICAgICBtZW51LnJlZnJlc2hQcm9jZXNzZXMoKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGNvbnN0IHNjaGVkdWxlciA9IG5ldyBTY2hlZHVsZXIoKTtcblxuICAgICAgICAvLyBjb25zdCBwcm9jX3J1bnRpbWUgPSAxMDA7XG4gICAgICAgIC8vIGNvbnN0IHByb2Nfc3RhcnQgPSA1MDtcbiAgICAgICAgLy8gY29uc3QgcHJvY19jb3VudCA9IDEwMDAwO1xuXG4gICAgICAgIC8vIGZvciAobGV0IGkgPSAwOyBpIDwgcHJvY19jb3VudDsgaSsrKXtcbiAgICAgICAgLy8gICAgIHNjaGVkdWxlci5hZGRQcm9jZXNzVG9Qb29sKG5ldyBQcm9jZXNzKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHByb2Nfc3RhcnQpLCBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBwcm9jX3J1bnRpbWUpKSk7XG4gICAgICAgIC8vIH1cblxuICAgICAgICAvLyBzY2hlZHVsZXIuc2V0QWxnb3JpdGhtKG5ldyBGQ0ZTKCkpO1xuXG4gICAgICAgIHNjaGVkdWxlci5hZGRQcm9jZXNzVG9Qb29sKG5ldyBQcm9jZXNzKDAsIDIpKTtcbiAgICAgICAgc2NoZWR1bGVyLmFkZFByb2Nlc3NUb1Bvb2wobmV3IFByb2Nlc3MoMCwgMSkpO1xuICAgICAgICBzY2hlZHVsZXIuYWRkUHJvY2Vzc1RvUG9vbChuZXcgUHJvY2VzcygwLCAzKSk7XG5cbiAgICAgICAgc2NoZWR1bGVyLnNldEFsZ29yaXRobShuZXcgUlIoMSkpO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKHNjaGVkdWxlci5zaW11bGF0ZSgpKTtcbiAgICB9XG59XG5cbm1haW4oKTtcbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8vIFRoaXMgZW50cnkgbW9kdWxlIGlzIHJlZmVyZW5jZWQgYnkgb3RoZXIgbW9kdWxlcyBzbyBpdCBjYW4ndCBiZSBpbmxpbmVkXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oOTY1KTtcbiJdLCJuYW1lcyI6WyJjb25zdHJ1Y3RvciIsInRoaXMiLCJyZXNpemVDYWxsYmFjayIsImluaXQiLCJlbGVtX2lkIiwiY2FudmFzIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImN0eCIsImdldENvbnRleHQiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwicmVzaXplVG9GaXQiLCJiaW5kIiwid2lkdGgiLCJpbm5lcldpZHRoIiwiaGVpZ2h0IiwiaW5uZXJIZWlnaHQiLCJzZXRSZXNpemVDYWxsYmFjayIsImNhbGxiYWNrIiwic2NoZWR1bGVyIiwiZGlzcGxheSIsImluaXRBdXRvUGxheSIsInJ1biIsImFkZFByb2Nlc3NlcyIsImNsZWFyUHJvY2Vzc2VzIiwiZSIsInRhcmdldCIsInZhbHVlIiwidG9Mb3dlckNhc2UiLCJzdHlsZSIsImRpc2FibGVkIiwicmVmcmVzaFByb2Nlc3NlcyIsInBsYXlfcGF1c2VfYnV0dG9uIiwic3RvcF9idXR0b24iLCJuZXh0VGljayIsInJlZnJlc2hBbmltYXRpb24iLCJpc0ZpbmlzaGVkIiwiZGlzcGxheVJlc3VsdHMiLCJhZnRlckRvbmUiLCJfcGF1c2VkIiwicmVzdW1lQW5pbWF0aW9uIiwiaW5uZXJIVE1MIiwicGF1c2VBbmltYXRpb24iLCJjbGVhclJlY3QiLCJyZXNldCIsInNldEFuaW1hdGlvblNwZWVkIiwicGFyc2VJbnQiLCJwcm9jZXNzX2NvdW50IiwibWF4X3Byb2Nlc3NfcnVuX3RpbWUiLCJtYXhfcHJvY2Vzc19hcnJpdmFsX3RpbWUiLCJpc05hTiIsImFsZXJ0IiwiaSIsImFycml2YWxfdGltZSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInJ1bl90aW1lIiwiYWRkUHJvY2Vzc1RvUG9vbCIsInByb2Nlc3NfcG9vbCIsImxlbmd0aCIsInRvU3RyaW5nIiwic3RhcnRfeCIsInByZXZpb3VzV2lkdGgiLCJwcmV2aW91c0hlaWdodCIsIndpZHRoU2NhbGUiLCJzdW1PZlJ1blRpbWVzIiwicmVkdWNlIiwiYSIsImIiLCJwcm9jZXNzIiwiZmlsbFN0eWxlIiwic3Ryb2tlU3R5bGUiLCJmaWxsUmVjdCIsInN0cm9rZVJlY3QiLCJmb250IiwidGV4dEFsaWduIiwiZmlsbFRleHQiLCJhbmltYXRpb24iLCJhbGdTdHIiLCJjb21wYXJlX2FsbCIsInNldEFsZ29yaXRobSIsInF1YW50dW0iLCJjb25zb2xlIiwibG9nIiwiY29tcGFyZUFsbEFuZERpc3BsYXlSZXN1bHRzIiwicmVzdWx0cyIsInNpbXVsYXRlIiwiUHJvY2VzcyIsInN0YXJ0X3RpbWUiLCJpZCIsImluY3JlbWVudGVkX2lkIiwidGltZV9sZWZ0Iiwid2FpdF90aW1lIiwidmlzdWFsIiwiZ2V0Q29weSIsImNvcHkiLCJwcm9jZXNzX3F1ZXVlIiwiZmluaXNoZWRfcHJvY2Vzc2VzIiwidGltZSIsInByZXZpb3VzQWN0aXZlUHJvY2VzcyIsIl9zcGVlZCIsIl9pbnRlcnZhbCIsIl9kaXNwbGF5IiwiYWxnb3JpdGhtIiwicHVzaCIsInByZXByb2Nlc3MiLCJjdXJyZW50X3Byb2Nlc3MiLCJwaWNrTmV4dCIsInNwbGljZSIsImluZGV4T2YiLCJnZXRSZXN1bHRzIiwiYXZnV2FpdFRpbWUiLCJtYXhUaW1lIiwibWF4IiwibWFwIiwibyIsImZjZnNfcmVzdWx0cyIsInNqZl9yZXN1bHRzIiwic3J0Zl9yZXN1bHRzIiwicnIxX3Jlc3VsdHMiLCJycjNfcmVzdWx0cyIsInJlc1RleHQiLCJ0b0ZpeGVkIiwicmVwbGFjZSIsIlJlZ0V4cCIsImNsZWFySW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsIm5hbWUiLCJzY3JlZW5XaWR0aCIsInNjcmVlbkhlaWdodCIsIngiLCJXSURUSCIsInNldFBvcyIsImNvbG9yIiwiZHJhdyIsImxhc3RQcm9jZXNzIiwibGVmdCIsInByb2Nlc3Nlc19sZWZ0X3RvX2pvaW5fZWwiLCJ0b1VwcGVyQ2FzZSIsInNwZWVkIiwieSIsIm5leHRQcm9jZXNzIiwiY3VycmVudF9wcm9jZXNzSW5kZXgiLCJjdXJyZW50X3F1YW50dW0iLCJzb3J0IiwibWVudSIsIm1haW4iLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyIsImNhbGwiXSwic291cmNlUm9vdCI6IiJ9